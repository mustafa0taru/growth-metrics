[0m17:36:34.053632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F6A2D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F88D5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F88D51B0>]}


============================== 17:36:34.073910 | 83f35132-2cbd-437a-b197-834998de64a7 ==============================
[0m17:36:34.073910 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:36:34.073910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:01.386565 [debug] [MainThread]: Starter project path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\include\starter_project
[0m17:37:01.424132 [info ] [MainThread]: 
Your new dbt project "growth" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m17:37:01.429742 [info ] [MainThread]: Setting up your profile.
[0m17:37:52.249615 [info ] [MainThread]: Profile growth written to C:\Users\musta\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m17:37:52.251688 [debug] [MainThread]: Command `dbt init` succeeded at 17:37:52.251688 after 78.49 seconds
[0m17:37:52.252688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F6A2D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F890FD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235F5CF80D0>]}
[0m17:37:52.252688 [debug] [MainThread]: Flushing usage events
[0m17:37:53.570873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:07.322785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9426D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D96119510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D961192A0>]}


============================== 17:38:07.330148 | c3d8a2e9-cc90-41e1-bdd0-8fc6b46caf07 ==============================
[0m17:38:07.330148 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:38:07.333817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:38:07.399697 [info ] [MainThread]: dbt version: 1.9.1
[0m17:38:07.403725 [info ] [MainThread]: python version: 3.10.11
[0m17:38:07.406730 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m17:38:07.411175 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:38:07.625667 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m17:38:07.628780 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m17:38:07.631020 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m17:38:07.638006 [info ] [MainThread]: adapter type: postgres
[0m17:38:07.639152 [info ] [MainThread]: adapter version: 1.9.0
[0m17:38:07.641769 [info ] [MainThread]: Configuration:
[0m17:38:07.642329 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:38:07.648154 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m17:38:07.652176 [info ] [MainThread]: Required dependencies:
[0m17:38:07.653807 [debug] [MainThread]: Executing "git --help"
[0m17:38:07.811357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:38:07.812359 [debug] [MainThread]: STDERR: "b''"
[0m17:38:07.812359 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:38:07.815051 [info ] [MainThread]: Connection:
[0m17:38:07.816048 [info ] [MainThread]:   host: 127.0.0.1
[0m17:38:07.817135 [info ] [MainThread]:   port: 5432
[0m17:38:07.819358 [info ] [MainThread]:   user: postgres
[0m17:38:07.821192 [info ] [MainThread]:   database: nca
[0m17:38:07.822753 [info ] [MainThread]:   schema: staging
[0m17:38:07.823480 [info ] [MainThread]:   connect_timeout: 10
[0m17:38:07.826229 [info ] [MainThread]:   role: None
[0m17:38:07.827748 [info ] [MainThread]:   search_path: None
[0m17:38:07.830204 [info ] [MainThread]:   keepalives_idle: 0
[0m17:38:07.832851 [info ] [MainThread]:   sslmode: None
[0m17:38:07.833824 [info ] [MainThread]:   sslcert: None
[0m17:38:07.836062 [info ] [MainThread]:   sslkey: None
[0m17:38:07.839956 [info ] [MainThread]:   sslrootcert: None
[0m17:38:07.842138 [info ] [MainThread]:   application_name: dbt
[0m17:38:07.843158 [info ] [MainThread]:   retries: 1
[0m17:38:07.846008 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:08.446379 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:38:08.774145 [debug] [MainThread]: Using postgres connection "debug"
[0m17:38:08.774145 [debug] [MainThread]: On debug: select 1 as id
[0m17:38:08.776590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:08.856044 [debug] [MainThread]: SQL status: SELECT 1 in 0.080 seconds
[0m17:38:08.856044 [debug] [MainThread]: On debug: Close
[0m17:38:08.856044 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:38:08.860706 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:38:08.861544 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml> not found

[0m17:38:08.863547 [debug] [MainThread]: Command `dbt debug` failed at 17:38:08.863547 after 1.71 seconds
[0m17:38:08.865644 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:38:08.866684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9426D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93588AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93589B10>]}
[0m17:38:08.866684 [debug] [MainThread]: Flushing usage events
[0m17:38:09.953268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:12.728204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15C7FD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15E6A9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15E6A9240>]}


============================== 17:39:12.736724 | 6074da3b-cbe5-4c10-a38f-c4c80b319167 ==============================
[0m17:39:12.736724 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:39:12.738839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:39:12.773121 [info ] [MainThread]: dbt version: 1.9.1
[0m17:39:12.774759 [info ] [MainThread]: python version: 3.10.11
[0m17:39:12.776751 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m17:39:12.777749 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:39:12.885833 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m17:39:12.902926 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m17:39:12.903927 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m17:39:12.905454 [info ] [MainThread]: adapter type: postgres
[0m17:39:12.906622 [info ] [MainThread]: adapter version: 1.9.0
[0m17:39:12.907618 [info ] [MainThread]: Configuration:
[0m17:39:12.907618 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:39:12.909157 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m17:39:12.911639 [info ] [MainThread]: Required dependencies:
[0m17:39:12.915194 [debug] [MainThread]: Executing "git --help"
[0m17:39:13.026530 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:39:13.027568 [debug] [MainThread]: STDERR: "b''"
[0m17:39:13.028012 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:39:13.030464 [info ] [MainThread]: Connection:
[0m17:39:13.031461 [info ] [MainThread]:   host: 127.0.0.1
[0m17:39:13.033772 [info ] [MainThread]:   port: 5432
[0m17:39:13.036296 [info ] [MainThread]:   user: postgres
[0m17:39:13.037409 [info ] [MainThread]:   database: nca
[0m17:39:13.039451 [info ] [MainThread]:   schema: staging
[0m17:39:13.040493 [info ] [MainThread]:   connect_timeout: 10
[0m17:39:13.041906 [info ] [MainThread]:   role: None
[0m17:39:13.044259 [info ] [MainThread]:   search_path: None
[0m17:39:13.046335 [info ] [MainThread]:   keepalives_idle: 0
[0m17:39:13.047486 [info ] [MainThread]:   sslmode: None
[0m17:39:13.048774 [info ] [MainThread]:   sslcert: None
[0m17:39:13.051834 [info ] [MainThread]:   sslkey: None
[0m17:39:13.051834 [info ] [MainThread]:   sslrootcert: None
[0m17:39:13.057468 [info ] [MainThread]:   application_name: dbt
[0m17:39:13.060125 [info ] [MainThread]:   retries: 1
[0m17:39:13.063635 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:39:13.791564 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:39:14.052807 [debug] [MainThread]: Using postgres connection "debug"
[0m17:39:14.053874 [debug] [MainThread]: On debug: select 1 as id
[0m17:39:14.055452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:14.188375 [debug] [MainThread]: SQL status: SELECT 1 in 0.133 seconds
[0m17:39:14.192605 [debug] [MainThread]: On debug: Close
[0m17:39:14.196467 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:39:14.203159 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:39:14.206897 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml> not found

[0m17:39:14.211909 [debug] [MainThread]: Command `dbt debug` failed at 17:39:14.211446 after 1.65 seconds
[0m17:39:14.214156 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:39:14.216648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15C7FD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15BB10E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15BB11A20>]}
[0m17:39:14.219131 [debug] [MainThread]: Flushing usage events
[0m17:39:15.691865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:52.370766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAE081180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAFF294B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAFF292D0>]}


============================== 17:45:52.379974 | 90c2f262-1bf2-42af-b65f-0fdc043ab826 ==============================
[0m17:45:52.379974 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:45:52.382255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:52.429486 [info ] [MainThread]: dbt version: 1.9.1
[0m17:45:52.430645 [info ] [MainThread]: python version: 3.10.11
[0m17:45:52.432803 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m17:45:52.433802 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:45:52.593970 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m17:45:52.595266 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m17:45:52.597258 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m17:45:52.599291 [info ] [MainThread]: adapter type: postgres
[0m17:45:52.602137 [info ] [MainThread]: adapter version: 1.9.0
[0m17:45:52.603471 [info ] [MainThread]: Configuration:
[0m17:45:52.604837 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:45:52.606725 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m17:45:52.609339 [info ] [MainThread]: Required dependencies:
[0m17:45:52.610694 [debug] [MainThread]: Executing "git --help"
[0m17:45:52.710147 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:45:52.711184 [debug] [MainThread]: STDERR: "b''"
[0m17:45:52.712791 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:45:52.714868 [info ] [MainThread]: Connection:
[0m17:45:52.715868 [info ] [MainThread]:   host: 127.0.0.1
[0m17:45:52.717201 [info ] [MainThread]:   port: 5432
[0m17:45:52.718736 [info ] [MainThread]:   user: postgres
[0m17:45:52.721347 [info ] [MainThread]:   database: nca
[0m17:45:52.722834 [info ] [MainThread]:   schema: staging
[0m17:45:52.724116 [info ] [MainThread]:   connect_timeout: 10
[0m17:45:52.726881 [info ] [MainThread]:   role: None
[0m17:45:52.729525 [info ] [MainThread]:   search_path: None
[0m17:45:52.732370 [info ] [MainThread]:   keepalives_idle: 0
[0m17:45:52.735433 [info ] [MainThread]:   sslmode: None
[0m17:45:52.736804 [info ] [MainThread]:   sslcert: None
[0m17:45:52.741276 [info ] [MainThread]:   sslkey: None
[0m17:45:52.742653 [info ] [MainThread]:   sslrootcert: None
[0m17:45:52.743983 [info ] [MainThread]:   application_name: dbt
[0m17:45:52.746332 [info ] [MainThread]:   retries: 1
[0m17:45:52.749777 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:45:53.245137 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:45:53.424617 [debug] [MainThread]: Using postgres connection "debug"
[0m17:45:53.424617 [debug] [MainThread]: On debug: select 1 as id
[0m17:45:53.429589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:53.531221 [debug] [MainThread]: SQL status: SELECT 1 in 0.101 seconds
[0m17:45:53.533411 [debug] [MainThread]: On debug: Close
[0m17:45:53.535950 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:45:53.543438 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:45:53.552254 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml> not found

[0m17:45:53.559670 [debug] [MainThread]: Command `dbt debug` failed at 17:45:53.558518 after 1.35 seconds
[0m17:45:53.561278 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:45:53.562777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAE081180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAD394850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BAD395B10>]}
[0m17:45:53.566260 [debug] [MainThread]: Flushing usage events
[0m17:45:54.940865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:08.612715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB4532D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB471D93C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB471D91E0>]}


============================== 17:48:08.623590 | 932906c8-ea37-4072-9fb9-6e474699c374 ==============================
[0m17:48:08.623590 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:48:08.628202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:08.686038 [info ] [MainThread]: dbt version: 1.9.1
[0m17:48:08.692332 [info ] [MainThread]: python version: 3.10.11
[0m17:48:08.695210 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m17:48:08.696677 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:48:08.915661 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m17:48:08.923053 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m17:48:08.931121 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m17:48:08.934194 [info ] [MainThread]: adapter type: postgres
[0m17:48:08.941561 [info ] [MainThread]: adapter version: 1.9.0
[0m17:48:08.949819 [info ] [MainThread]: Configuration:
[0m17:48:08.966464 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:48:08.976514 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m17:48:08.979929 [info ] [MainThread]: Required dependencies:
[0m17:48:08.983124 [debug] [MainThread]: Executing "git --help"
[0m17:48:09.111754 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:48:09.112739 [debug] [MainThread]: STDERR: "b''"
[0m17:48:09.115603 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:48:09.117599 [info ] [MainThread]: Connection:
[0m17:48:09.122238 [info ] [MainThread]:   host: 127.0.0.1
[0m17:48:09.125233 [info ] [MainThread]:   port: 5432
[0m17:48:09.129714 [info ] [MainThread]:   user: postgres
[0m17:48:09.131890 [info ] [MainThread]:   database: nca
[0m17:48:09.134338 [info ] [MainThread]:   schema: staging
[0m17:48:09.136824 [info ] [MainThread]:   connect_timeout: 10
[0m17:48:09.140754 [info ] [MainThread]:   role: None
[0m17:48:09.143036 [info ] [MainThread]:   search_path: None
[0m17:48:09.146634 [info ] [MainThread]:   keepalives_idle: 0
[0m17:48:09.150739 [info ] [MainThread]:   sslmode: None
[0m17:48:09.152472 [info ] [MainThread]:   sslcert: None
[0m17:48:09.154990 [info ] [MainThread]:   sslkey: None
[0m17:48:09.158358 [info ] [MainThread]:   sslrootcert: None
[0m17:48:09.160405 [info ] [MainThread]:   application_name: dbt
[0m17:48:09.163162 [info ] [MainThread]:   retries: 1
[0m17:48:09.167503 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:48:09.829153 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:48:10.044414 [debug] [MainThread]: Using postgres connection "debug"
[0m17:48:10.045694 [debug] [MainThread]: On debug: select 1 as id
[0m17:48:10.047034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:10.113937 [debug] [MainThread]: SQL status: SELECT 1 in 0.067 seconds
[0m17:48:10.114968 [debug] [MainThread]: On debug: Close
[0m17:48:10.116994 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:48:10.119529 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:48:10.121871 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml> not found

[0m17:48:10.126320 [debug] [MainThread]: Command `dbt debug` failed at 17:48:10.125773 after 1.80 seconds
[0m17:48:10.127898 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:48:10.128082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB4532D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB44635360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB44635990>]}
[0m17:48:10.129551 [debug] [MainThread]: Flushing usage events
[0m17:48:11.534568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:53.258439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CDAA5D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CDC909450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CDC909270>]}


============================== 20:50:53.267442 | c72c8101-a4b7-4145-a3e7-4adc843fcaf4 ==============================
[0m20:50:53.267442 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:50:53.269442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:50:53.321442 [info ] [MainThread]: dbt version: 1.9.1
[0m20:50:53.322440 [info ] [MainThread]: python version: 3.10.11
[0m20:50:53.325441 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m20:50:53.326440 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m20:50:53.515441 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m20:50:53.518446 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m20:50:53.521440 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m20:50:53.526443 [info ] [MainThread]: adapter type: postgres
[0m20:50:53.528441 [info ] [MainThread]: adapter version: 1.9.0
[0m20:50:53.875436 [info ] [MainThread]: Configuration:
[0m20:50:53.877442 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:50:53.878441 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:50:53.879441 [info ] [MainThread]: Required dependencies:
[0m20:50:53.881441 [debug] [MainThread]: Executing "git --help"
[0m20:50:53.984441 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:50:53.985444 [debug] [MainThread]: STDERR: "b''"
[0m20:50:53.986442 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:50:53.988443 [info ] [MainThread]: Connection:
[0m20:50:53.989440 [info ] [MainThread]:   host: 127.0.0.1
[0m20:50:53.990443 [info ] [MainThread]:   port: 5432
[0m20:50:53.992441 [info ] [MainThread]:   user: postgres
[0m20:50:53.994443 [info ] [MainThread]:   database: nca
[0m20:50:53.996443 [info ] [MainThread]:   schema: staging
[0m20:50:53.997443 [info ] [MainThread]:   connect_timeout: 10
[0m20:50:53.999448 [info ] [MainThread]:   role: None
[0m20:50:54.001443 [info ] [MainThread]:   search_path: None
[0m20:50:54.005444 [info ] [MainThread]:   keepalives_idle: 0
[0m20:50:54.006445 [info ] [MainThread]:   sslmode: None
[0m20:50:54.007443 [info ] [MainThread]:   sslcert: None
[0m20:50:54.011442 [info ] [MainThread]:   sslkey: None
[0m20:50:54.013443 [info ] [MainThread]:   sslrootcert: None
[0m20:50:54.014444 [info ] [MainThread]:   application_name: dbt
[0m20:50:54.018443 [info ] [MainThread]:   retries: 1
[0m20:50:54.023446 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:54.733441 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:50:55.124440 [debug] [MainThread]: Using postgres connection "debug"
[0m20:50:55.126442 [debug] [MainThread]: On debug: select 1 as id
[0m20:50:55.127458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:55.273852 [debug] [MainThread]: SQL status: SELECT 1 in 0.146 seconds
[0m20:50:55.275854 [debug] [MainThread]: On debug: Close
[0m20:50:55.277853 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:50:55.280851 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:50:55.283850 [debug] [MainThread]: Command `dbt debug` succeeded at 20:50:55.283850 after 2.24 seconds
[0m20:50:55.285854 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:50:55.286852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CDAA5D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CDC916230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD9D75A80>]}
[0m20:50:55.293853 [debug] [MainThread]: Flushing usage events
[0m20:50:56.286739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:43.293028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077863D1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A4E9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A4E9330>]}


============================== 20:56:43.302044 | 70d5ecb0-d94e-4a7a-b328-b2a2e1648a77 ==============================
[0m20:56:43.302044 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:56:43.303033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:56:43.344033 [info ] [MainThread]: dbt version: 1.9.1
[0m20:56:43.345029 [info ] [MainThread]: python version: 3.10.11
[0m20:56:43.346031 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m20:56:43.347032 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m20:56:43.450030 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m20:56:43.451031 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m20:56:43.452028 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m20:56:43.624028 [info ] [MainThread]: Configuration:
[0m20:56:43.625028 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m20:56:43.627028 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:56:43.628030 [info ] [MainThread]: Required dependencies:
[0m20:56:43.629031 [debug] [MainThread]: Executing "git --help"
[0m20:56:43.684032 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:56:43.686047 [debug] [MainThread]: STDERR: "b''"
[0m20:56:43.688029 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:56:43.689039 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:56:43.690030 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:56:43.691028 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "growth", target "dev" invalid: 1020 is not of type 'string'


[0m20:56:43.693028 [debug] [MainThread]: Command `dbt debug` failed at 20:56:43.693028 after 0.53 seconds
[0m20:56:43.694032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077863D1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077760F730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A477670>]}
[0m20:56:43.695028 [debug] [MainThread]: Flushing usage events
[0m20:56:45.222046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:59.754825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255565ED120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025558499600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025558499420>]}


============================== 20:58:59.762175 | 74241e64-91e3-485d-9f5f-7c3ea9ec0284 ==============================
[0m20:58:59.762175 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:58:59.763833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:58:59.800832 [info ] [MainThread]: dbt version: 1.9.1
[0m20:58:59.802827 [info ] [MainThread]: python version: 3.10.11
[0m20:58:59.804826 [info ] [MainThread]: python path: C:\Users\musta\Documents\GrowthMetrics\dbt_env\Scripts\python.exe
[0m20:58:59.805828 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m20:58:59.951331 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m20:58:59.953193 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m20:58:59.954204 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\Documents\GrowthMetrics\dbt_project.yml
[0m20:58:59.956205 [info ] [MainThread]: adapter type: postgres
[0m20:58:59.958616 [info ] [MainThread]: adapter version: 1.9.0
[0m20:59:00.168007 [info ] [MainThread]: Configuration:
[0m20:59:00.169005 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:59:00.170005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:59:00.171007 [info ] [MainThread]: Required dependencies:
[0m20:59:00.172003 [debug] [MainThread]: Executing "git --help"
[0m20:59:00.236002 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:59:00.237006 [debug] [MainThread]: STDERR: "b''"
[0m20:59:00.239006 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:59:00.241004 [info ] [MainThread]: Connection:
[0m20:59:00.242003 [info ] [MainThread]:   host: 127.0.0.1
[0m20:59:00.243003 [info ] [MainThread]:   port: 5432
[0m20:59:00.244004 [info ] [MainThread]:   user: postgres
[0m20:59:00.245003 [info ] [MainThread]:   database: nca
[0m20:59:00.246005 [info ] [MainThread]:   schema: public
[0m20:59:00.247004 [info ] [MainThread]:   connect_timeout: 10
[0m20:59:00.249005 [info ] [MainThread]:   role: None
[0m20:59:00.250005 [info ] [MainThread]:   search_path: None
[0m20:59:00.252004 [info ] [MainThread]:   keepalives_idle: 0
[0m20:59:00.253006 [info ] [MainThread]:   sslmode: None
[0m20:59:00.256012 [info ] [MainThread]:   sslcert: None
[0m20:59:00.257005 [info ] [MainThread]:   sslkey: None
[0m20:59:00.258010 [info ] [MainThread]:   sslrootcert: None
[0m20:59:00.259003 [info ] [MainThread]:   application_name: dbt
[0m20:59:00.260003 [info ] [MainThread]:   retries: 1
[0m20:59:00.262003 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:59:00.688467 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:59:00.884449 [debug] [MainThread]: Using postgres connection "debug"
[0m20:59:00.885446 [debug] [MainThread]: On debug: select 1 as id
[0m20:59:00.886406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:00.949407 [debug] [MainThread]: SQL status: SELECT 1 in 0.063 seconds
[0m20:59:00.951448 [debug] [MainThread]: On debug: Close
[0m20:59:00.952409 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:59:00.953411 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:59:00.956408 [debug] [MainThread]: Command `dbt debug` succeeded at 20:59:00.956408 after 1.33 seconds
[0m20:59:00.957408 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:59:00.959406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255565ED120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255584A74C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255568C5390>]}
[0m20:59:00.960406 [debug] [MainThread]: Flushing usage events
[0m20:59:03.326711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:35.562732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF9D0D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFBBBD6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFBBBD4E0>]}


============================== 20:59:35.566734 | 6a8ae7c7-d7f2-4dc0-a4da-ef23c35396be ==============================
[0m20:59:35.566734 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:59:35.568735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:59:35.900646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8ae7c7-d7f2-4dc0-a4da-ef23c35396be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFBCE8A60>]}
[0m20:59:35.976647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8ae7c7-d7f2-4dc0-a4da-ef23c35396be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFBBC88B0>]}
[0m20:59:35.977649 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:59:36.372527 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:59:36.438471 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:59:36.439472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a8ae7c7-d7f2-4dc0-a4da-ef23c35396be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFB6B0910>]}
[0m20:59:38.172089 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.growth.stg_market' (models\staging\stg_market.sql) depends on a source named 'raw.market_data' which was not found
[0m20:59:38.174341 [debug] [MainThread]: Command `dbt run` failed at 20:59:38.174341 after 2.77 seconds
[0m20:59:38.175340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF9D0D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BF9D0DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BFC35EDD0>]}
[0m20:59:38.176340 [debug] [MainThread]: Flushing usage events
[0m20:59:39.084525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:21.073864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F524BD0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F54371570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F54371390>]}


============================== 21:00:21.077866 | 3840f751-87a1-48fb-b38d-36b552c3888e ==============================
[0m21:00:21.077866 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:00:21.078863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:21.323866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3840f751-87a1-48fb-b38d-36b552c3888e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5447B3D0>]}
[0m21:00:21.394866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3840f751-87a1-48fb-b38d-36b552c3888e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F52763CA0>]}
[0m21:00:21.396866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:21.784866 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:00:21.864278 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:00:21.865336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3840f751-87a1-48fb-b38d-36b552c3888e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F53E60C40>]}
[0m21:00:23.524936 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.growth.stg_referrals' (models\staging\stg_referrals.sql) depends on a source named 'raw.referrals' which was not found
[0m21:00:23.526938 [debug] [MainThread]: Command `dbt run` failed at 21:00:23.526938 after 2.57 seconds
[0m21:00:23.527897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F54BAFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F54498E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F53E62B30>]}
[0m21:00:23.527897 [debug] [MainThread]: Flushing usage events
[0m21:00:25.849092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:19.447046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE327D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE51316C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE51314E0>]}


============================== 21:01:19.451047 | 1dbf2f5a-ad53-4d4f-a835-28815d44fa3a ==============================
[0m21:01:19.451047 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:01:19.452048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:19.704044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbf2f5a-ad53-4d4f-a835-28815d44fa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE5258A60>]}
[0m21:01:19.782042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbf2f5a-ad53-4d4f-a835-28815d44fa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE51388B0>]}
[0m21:01:19.784044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:01:20.184084 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:01:20.243047 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:01:20.243767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1dbf2f5a-ad53-4d4f-a835-28815d44fa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4C1C340>]}
[0m21:01:21.845755 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.growth.int_enriched_transactions' (models\intermediate\int_enriched_transactions.sql) depends on a node named 'int_cleaned_transactions' which was not found
[0m21:01:21.848801 [debug] [MainThread]: Command `dbt run` failed at 21:01:21.847758 after 2.52 seconds
[0m21:01:21.848801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE327D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE327DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE58CADD0>]}
[0m21:01:21.849754 [debug] [MainThread]: Flushing usage events
[0m21:01:22.832295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:21.723434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA19D6D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BC21750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BC21570>]}


============================== 21:04:21.727468 | 212f9a67-7966-448a-9111-1933ab3af6ef ==============================
[0m21:04:21.727468 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:04:21.728433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:21.972473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BD33EB0>]}
[0m21:04:22.047439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1B6DBDC0>]}
[0m21:04:22.049440 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:04:22.461476 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:04:22.520435 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:04:22.521377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1B718F40>]}
[0m21:04:24.234052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.marts
- models.growth_metrics.staging
- models.growth_metrics.intermediate
[0m21:04:24.265052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BD32020>]}
[0m21:04:24.423045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m21:04:24.428050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m21:04:24.596741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1D6671C0>]}
[0m21:04:24.596741 [info ] [MainThread]: Found 16 models, 20 data tests, 4 sources, 431 macros
[0m21:04:24.598742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1D666EC0>]}
[0m21:04:24.601737 [info ] [MainThread]: 
[0m21:04:24.603056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:24.604633 [info ] [MainThread]: 
[0m21:04:24.605644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:04:24.616650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m21:04:24.782645 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m21:04:24.783644 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m21:04:24.784644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:24.851647 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.067 seconds
[0m21:04:24.854647 [debug] [ThreadPool]: On list_nca: Close
[0m21:04:24.856646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nca, now create_nca_public)
[0m21:04:24.858645 [debug] [ThreadPool]: Creating schema "database: "nca"
schema: "public"
"
[0m21:04:24.865657 [debug] [ThreadPool]: Using postgres connection "create_nca_public"
[0m21:04:24.866644 [debug] [ThreadPool]: On create_nca_public: BEGIN
[0m21:04:24.866644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:24.915646 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m21:04:24.915646 [debug] [ThreadPool]: Using postgres connection "create_nca_public"
[0m21:04:24.916667 [debug] [ThreadPool]: On create_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "create_nca_public"} */
create schema if not exists "public"
[0m21:04:24.926642 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.009 seconds
[0m21:04:24.928647 [debug] [ThreadPool]: On create_nca_public: COMMIT
[0m21:04:24.930645 [debug] [ThreadPool]: Using postgres connection "create_nca_public"
[0m21:04:24.931649 [debug] [ThreadPool]: On create_nca_public: COMMIT
[0m21:04:24.936647 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m21:04:24.937646 [debug] [ThreadPool]: On create_nca_public: Close
[0m21:04:24.942646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m21:04:24.954645 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m21:04:24.954645 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m21:04:24.955644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:25.002644 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m21:04:25.002644 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m21:04:25.003646 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:04:25.026643 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m21:04:25.029645 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m21:04:25.030645 [debug] [ThreadPool]: On list_nca_public: Close
[0m21:04:25.046722 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:25.047644 [debug] [MainThread]: On master: BEGIN
[0m21:04:25.049647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:25.104160 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m21:04:25.105241 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:25.106414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:04:25.123097 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:04:25.125099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1D638820>]}
[0m21:04:25.127097 [debug] [MainThread]: On master: ROLLBACK
[0m21:04:25.128096 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:25.129098 [debug] [MainThread]: On master: BEGIN
[0m21:04:25.130097 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:04:25.131098 [debug] [MainThread]: On master: COMMIT
[0m21:04:25.131098 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:25.133102 [debug] [MainThread]: On master: COMMIT
[0m21:04:25.134099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:04:25.135100 [debug] [MainThread]: On master: Close
[0m21:04:25.142189 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m21:04:25.143304 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m21:04:25.143875 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m21:04:25.144424 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m21:04:25.145480 [info ] [Thread-1 (]: 1 of 16 START sql view model public.stg_market ................................. [RUN]
[0m21:04:25.146860 [info ] [Thread-2 (]: 2 of 16 START sql view model public.stg_referrals .............................. [RUN]
[0m21:04:25.148382 [info ] [Thread-3 (]: 3 of 16 START sql view model public.stg_transactions ........................... [RUN]
[0m21:04:25.152882 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m21:04:25.150660 [info ] [Thread-4 (]: 4 of 16 START sql view model public.stg_users .................................. [RUN]
[0m21:04:25.154797 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m21:04:25.156234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m21:04:25.157578 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m21:04:25.159485 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m21:04:25.179037 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m21:04:25.163691 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m21:04:25.161125 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m21:04:25.188329 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m21:04:25.190110 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m21:04:25.197015 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m21:04:25.201414 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m21:04:25.206323 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m21:04:25.207513 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m21:04:25.208555 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m21:04:25.240672 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m21:04:25.255669 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m21:04:25.310669 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m21:04:25.314673 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m21:04:25.319716 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m21:04:25.324671 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m21:04:25.325671 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m21:04:25.326674 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m21:04:25.327677 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m21:04:25.328671 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m21:04:25.328671 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m21:04:25.329715 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m21:04:25.330672 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m21:04:25.331671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:04:25.331671 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:04:25.332672 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:04:25.332672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:04:25.416672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.085 seconds
[0m21:04:25.418687 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m21:04:25.419673 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."public"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m21:04:25.436670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.104 seconds
[0m21:04:25.438688 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m21:04:25.439674 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."public"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m21:04:25.442674 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m21:04:25.443679 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m21:04:25.444676 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."public"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m21:04:25.455675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m21:04:25.457676 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m21:04:25.458695 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."public"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m21:04:25.470672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:04:25.471675 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m21:04:25.472674 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m21:04:25.486670 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m21:04:25.487673 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m21:04:25.494677 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m21:04:25.501685 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m21:04:25.502673 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."public"."stg_market__dbt_tmp" rename to "stg_market"
[0m21:04:25.509668 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m21:04:25.510674 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:04:25.511673 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."public"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m21:04:25.513674 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."public"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:04:25.514674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:04:25.515672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:25.535669 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m21:04:25.535669 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m21:04:25.536671 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m21:04:25.538676 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m21:04:25.540674 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m21:04:25.542671 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m21:04:25.545674 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m21:04:25.546673 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m21:04:25.547672 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m21:04:25.548673 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m21:04:25.549671 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m21:04:25.549671 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m21:04:25.551671 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m21:04:25.552674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:25.552674 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m21:04:25.562677 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."stg_market__dbt_backup"
[0m21:04:25.563672 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m21:04:25.564677 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m21:04:25.574676 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m21:04:25.575673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m21:04:25.582674 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."stg_users__dbt_backup"
[0m21:04:25.588672 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."stg_referrals__dbt_backup"
[0m21:04:25.589680 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."public"."stg_market__dbt_backup" cascade
[0m21:04:25.595673 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."stg_transactions__dbt_backup"
[0m21:04:25.598671 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m21:04:25.601672 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m21:04:25.603673 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m21:04:25.604688 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:04:25.605673 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."public"."stg_users__dbt_backup" cascade
[0m21:04:25.605673 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."public"."stg_referrals__dbt_backup" cascade
[0m21:04:25.606673 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."public"."stg_transactions__dbt_backup" cascade
[0m21:04:25.611677 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m21:04:25.613672 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:04:25.613672 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:04:25.615673 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:04:25.620674 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m21:04:25.623674 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m21:04:25.625673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C543610>]}
[0m21:04:25.627671 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m21:04:25.629673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C57FC40>]}
[0m21:04:25.631674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1DBF8700>]}
[0m21:04:25.635672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C516F50>]}
[0m21:04:25.633672 [info ] [Thread-1 (]: 1 of 16 OK created sql view model public.stg_market ............................ [[32mCREATE VIEW[0m in 0.47s]
[0m21:04:25.637674 [info ] [Thread-4 (]: 4 of 16 OK created sql view model public.stg_users ............................. [[32mCREATE VIEW[0m in 0.47s]
[0m21:04:25.639675 [info ] [Thread-2 (]: 2 of 16 OK created sql view model public.stg_referrals ......................... [[32mCREATE VIEW[0m in 0.48s]
[0m21:04:25.643673 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m21:04:25.641672 [info ] [Thread-3 (]: 3 of 16 OK created sql view model public.stg_transactions ...................... [[32mCREATE VIEW[0m in 0.48s]
[0m21:04:25.645676 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m21:04:25.647677 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m21:04:25.649674 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m21:04:25.651676 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m21:04:25.653676 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m21:04:25.655673 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m21:04:25.656674 [info ] [Thread-1 (]: 5 of 16 START sql view model public.dim_market ................................. [RUN]
[0m21:04:25.658673 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m21:04:25.659673 [info ] [Thread-4 (]: 6 of 16 START sql view model public.dim_users .................................. [RUN]
[0m21:04:25.662675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_market)
[0m21:04:25.660683 [info ] [Thread-2 (]: 7 of 16 START sql view model public.dim_referrals .............................. [RUN]
[0m21:04:25.664673 [info ] [Thread-3 (]: 8 of 16 START sql view model public.dim_transactions ........................... [RUN]
[0m21:04:25.666674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.dim_users)
[0m21:04:25.668681 [debug] [Thread-1 (]: Began compiling node model.growth.dim_market
[0m21:04:25.670673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m21:04:25.671672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m21:04:25.672676 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m21:04:25.677682 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_market"
[0m21:04:25.678674 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m21:04:25.680677 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m21:04:25.688671 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m21:04:25.693675 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m21:04:25.702674 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m21:04:25.704671 [debug] [Thread-1 (]: Began executing node model.growth.dim_market
[0m21:04:25.705679 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m21:04:25.706673 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m21:04:25.712677 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_market"
[0m21:04:25.722671 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m21:04:25.722671 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m21:04:25.730685 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m21:04:25.739672 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m21:04:25.741675 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m21:04:25.742675 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m21:04:25.744676 [debug] [Thread-1 (]: On model.growth.dim_market: BEGIN
[0m21:04:25.745674 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m21:04:25.746677 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m21:04:25.746677 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m21:04:25.747673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:25.748671 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m21:04:25.749674 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m21:04:25.750680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:04:25.752670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:04:25.753674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:04:25.846673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m21:04:25.848673 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m21:04:25.849673 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."public"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."public"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m21:04:25.859670 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:04:25.869674 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m21:04:25.871673 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m21:04:25.872672 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m21:04:25.873673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.121 seconds
[0m21:04:25.874672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.126 seconds
[0m21:04:25.875673 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m21:04:25.876671 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:25.877672 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m21:04:25.878672 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m21:04:25.879674 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."public"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."public"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m21:04:25.881682 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m21:04:25.883671 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."public"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."public"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m21:04:25.884673 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."public"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."public"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m21:04:25.886678 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m21:04:25.888681 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m21:04:25.890672 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:25.895674 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."dim_users__dbt_backup"
[0m21:04:25.896677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:04:25.896677 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:04:25.897671 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:04:25.898672 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m21:04:25.902669 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m21:04:25.905670 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m21:04:25.910668 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m21:04:25.911671 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."public"."dim_users__dbt_backup" cascade
[0m21:04:25.911671 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."public"."dim_market__dbt_tmp" rename to "dim_market"
[0m21:04:25.913674 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."public"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m21:04:25.914670 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."public"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m21:04:25.915673 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:04:25.915673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:25.917671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:04:25.917671 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:25.919672 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m21:04:25.921672 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m21:04:25.922670 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m21:04:25.924670 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m21:04:25.926675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BD4B7C0>]}
[0m21:04:25.927672 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m21:04:25.929674 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m21:04:25.931672 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m21:04:25.933671 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m21:04:25.932674 [info ] [Thread-4 (]: 6 of 16 OK created sql view model public.dim_users ............................. [[32mCREATE VIEW[0m in 0.26s]
[0m21:04:25.934671 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m21:04:25.935671 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m21:04:25.936672 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m21:04:25.937670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:25.938673 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:25.938673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:25.939671 [debug] [Thread-4 (]: Began running node model.growth.mart_daily_transactions
[0m21:04:25.942668 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."dim_market__dbt_backup"
[0m21:04:25.947675 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."dim_referrals__dbt_backup"
[0m21:04:25.953672 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."dim_transactions__dbt_backup"
[0m21:04:25.956673 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m21:04:25.954671 [info ] [Thread-4 (]: 9 of 16 START sql table model public.mart_daily_transactions ................... [RUN]
[0m21:04:25.957670 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m21:04:25.958670 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m21:04:25.959670 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."public"."dim_market__dbt_backup" cascade
[0m21:04:25.959670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.mart_daily_transactions)
[0m21:04:25.961676 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."public"."dim_referrals__dbt_backup" cascade
[0m21:04:25.962675 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."public"."dim_transactions__dbt_backup" cascade
[0m21:04:25.964676 [debug] [Thread-4 (]: Began compiling node model.growth.mart_daily_transactions
[0m21:04:25.965674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:04:25.967674 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:04:25.968674 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:04:25.972672 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m21:04:25.974671 [debug] [Thread-1 (]: On model.growth.dim_market: Close
[0m21:04:25.976674 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m21:04:25.978670 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m21:04:25.981673 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA15563D60>]}
[0m21:04:25.983674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C2E5ED0>]}
[0m21:04:25.985673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C41D8D0>]}
[0m21:04:25.988673 [debug] [Thread-4 (]: Began executing node model.growth.mart_daily_transactions
[0m21:04:25.987673 [info ] [Thread-2 (]: 7 of 16 OK created sql view model public.dim_referrals ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m21:04:25.990673 [info ] [Thread-1 (]: 5 of 16 OK created sql view model public.dim_market ............................ [[32mCREATE VIEW[0m in 0.32s]
[0m21:04:25.992673 [info ] [Thread-3 (]: 8 of 16 OK created sql view model public.dim_transactions ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m21:04:26.037677 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m21:04:26.048670 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m21:04:26.050673 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m21:04:26.051678 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m21:04:26.053672 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m21:04:26.054670 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m21:04:26.055671 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_transactions
[0m21:04:26.057673 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m21:04:26.056672 [info ] [Thread-2 (]: 10 of 16 START sql table model public.mart_transaction_summary ................. [RUN]
[0m21:04:26.058670 [info ] [Thread-1 (]: 11 of 16 START sql view model public.int_enriched_users ........................ [RUN]
[0m21:04:26.059671 [info ] [Thread-3 (]: 12 of 16 START sql view model public.int_enriched_transactions ................. [RUN]
[0m21:04:26.060672 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: BEGIN
[0m21:04:26.061671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.mart_transaction_summary)
[0m21:04:26.062674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.int_enriched_users)
[0m21:04:26.064701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.int_enriched_transactions)
[0m21:04:26.066677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:04:26.067687 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m21:04:26.069674 [debug] [Thread-1 (]: Began compiling node model.growth.int_enriched_users
[0m21:04:26.070673 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_transactions
[0m21:04:26.079678 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m21:04:26.090672 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m21:04:26.101674 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m21:04:26.104673 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m21:04:26.105672 [debug] [Thread-1 (]: Began executing node model.growth.int_enriched_users
[0m21:04:26.119672 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m21:04:26.125670 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m21:04:26.125670 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_transactions
[0m21:04:26.127674 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m21:04:26.136671 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m21:04:26.137671 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m21:04:26.138671 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m21:04:26.139670 [debug] [Thread-1 (]: On model.growth.int_enriched_users: BEGIN
[0m21:04:26.141671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:04:26.142670 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m21:04:26.143671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:26.144672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.078 seconds
[0m21:04:26.147677 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: BEGIN
[0m21:04:26.150676 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m21:04:26.151673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:04:26.153673 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."public"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_date,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."public"."stg_transactions"
GROUP BY 
    transaction_date,
    token,
    transaction_type
  );
  
[0m21:04:26.158673 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "transaction_date" does not exist
LINE 15:     transaction_date,
             ^
HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".

[0m21:04:26.161673 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: ROLLBACK
[0m21:04:26.164673 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: Close
[0m21:04:26.226671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m21:04:26.227672 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m21:04:26.228671 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."public"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."public"."dim_users" u
    LEFT JOIN "nca"."public"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m21:04:26.236673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.085 seconds
[0m21:04:26.237674 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:04:26.239673 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m21:04:26.240672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.099 seconds
[0m21:04:26.245668 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m21:04:26.246671 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."public"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."public"."dim_transactions" t
    LEFT JOIN "nca"."public"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m21:04:26.247670 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m21:04:26.248674 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."public"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m21:04:26.249671 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."public"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."public"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m21:04:26.251672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:26.255678 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m21:04:26.256677 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:04:26.257674 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m21:04:26.265674 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m21:04:26.266673 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m21:04:26.268674 [debug] [Thread-4 (]: Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 15:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql
[0m21:04:26.268674 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."public"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m21:04:26.270671 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1BD4B7C0>]}
[0m21:04:26.271673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:26.273675 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:26.272671 [error] [Thread-4 (]: 9 of 16 ERROR creating sql table model public.mart_daily_transactions .......... [[31mERROR[0m in 0.31s]
[0m21:04:26.277669 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."int_enriched_users__dbt_backup"
[0m21:04:26.277669 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.026 seconds
[0m21:04:26.279671 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m21:04:26.280671 [debug] [Thread-4 (]: Finished running node model.growth.mart_daily_transactions
[0m21:04:26.282670 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m21:04:26.286673 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m21:04:26.288675 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m21:04:26.289676 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'error'.  Reason: Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 15:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql.
[0m21:04:26.291674 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."public"."int_enriched_users__dbt_backup" cascade
[0m21:04:26.292674 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."public"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m21:04:26.293723 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m21:04:26.296673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:04:26.297672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:26.299673 [debug] [Thread-1 (]: On model.growth.int_enriched_users: Close
[0m21:04:26.301682 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m21:04:26.311670 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m21:04:26.316674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C2E5ED0>]}
[0m21:04:26.322670 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."int_enriched_transactions__dbt_backup"
[0m21:04:26.323672 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m21:04:26.324671 [info ] [Thread-1 (]: 11 of 16 OK created sql view model public.int_enriched_users ................... [[32mCREATE VIEW[0m in 0.25s]
[0m21:04:26.326672 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m21:04:26.327676 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m21:04:26.329672 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m21:04:26.330672 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."public"."int_enriched_transactions__dbt_backup" cascade
[0m21:04:26.333672 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:26.338676 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."mart_transaction_summary__dbt_backup"
[0m21:04:26.339673 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m21:04:26.343680 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m21:04:26.346676 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: Close
[0m21:04:26.349673 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."public"."mart_transaction_summary__dbt_backup" cascade
[0m21:04:26.351675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1D6B2350>]}
[0m21:04:26.354679 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:04:26.354679 [info ] [Thread-3 (]: 12 of 16 OK created sql view model public.int_enriched_transactions ............ [[32mCREATE VIEW[0m in 0.29s]
[0m21:04:26.358673 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m21:04:26.359670 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_transactions
[0m21:04:26.361674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA15563D60>]}
[0m21:04:26.365677 [debug] [Thread-4 (]: Began running node model.growth.fct_referral_metrics
[0m21:04:26.364675 [info ] [Thread-2 (]: 10 of 16 OK created sql table model public.mart_transaction_summary ............ [[32mSELECT 8[0m in 0.30s]
[0m21:04:26.368676 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m21:04:26.370674 [debug] [Thread-3 (]: Began running node model.growth.fct_user_metrics
[0m21:04:26.367676 [info ] [Thread-4 (]: 13 of 16 START sql table model public.fct_referral_metrics ..................... [RUN]
[0m21:04:26.371672 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m21:04:26.372671 [info ] [Thread-1 (]: 14 of 16 START sql table model public.fct_token_metrics ........................ [RUN]
[0m21:04:26.374675 [info ] [Thread-3 (]: 15 of 16 START sql table model public.fct_user_metrics ......................... [RUN]
[0m21:04:26.375676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_referral_metrics)
[0m21:04:26.376675 [debug] [Thread-2 (]: Began running node model.growth.fct_users_acquisition
[0m21:04:26.377673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_users, now model.growth.fct_token_metrics)
[0m21:04:26.379675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_user_metrics)
[0m21:04:26.381675 [debug] [Thread-4 (]: Began compiling node model.growth.fct_referral_metrics
[0m21:04:26.383677 [info ] [Thread-2 (]: 16 of 16 START sql table model public.fct_users_acquisition .................... [RUN]
[0m21:04:26.385678 [debug] [Thread-1 (]: Began compiling node model.growth.fct_token_metrics
[0m21:04:26.386677 [debug] [Thread-3 (]: Began compiling node model.growth.fct_user_metrics
[0m21:04:26.393674 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m21:04:26.394671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.fct_users_acquisition)
[0m21:04:26.400685 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m21:04:26.408671 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m21:04:26.410675 [debug] [Thread-2 (]: Began compiling node model.growth.fct_users_acquisition
[0m21:04:26.412672 [debug] [Thread-4 (]: Began executing node model.growth.fct_referral_metrics
[0m21:04:26.421671 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m21:04:26.427676 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m21:04:26.428676 [debug] [Thread-1 (]: Began executing node model.growth.fct_token_metrics
[0m21:04:26.431674 [debug] [Thread-2 (]: Began executing node model.growth.fct_users_acquisition
[0m21:04:26.439684 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m21:04:26.440675 [debug] [Thread-3 (]: Began executing node model.growth.fct_user_metrics
[0m21:04:26.448674 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m21:04:26.449671 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m21:04:26.457670 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m21:04:26.459690 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: BEGIN
[0m21:04:26.460671 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m21:04:26.461673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:04:26.463674 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m21:04:26.464670 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: BEGIN
[0m21:04:26.465674 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m21:04:26.466672 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: BEGIN
[0m21:04:26.468673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:26.469673 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: BEGIN
[0m21:04:26.470673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:04:26.472673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:04:26.548673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m21:04:26.549672 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m21:04:26.551673 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."public"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."public"."dim_referrals" r
    JOIN "nca"."public"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m21:04:26.560672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m21:04:26.561675 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m21:04:26.563678 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."public"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."public"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m21:04:26.565685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m21:04:26.567674 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m21:04:26.569672 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."public"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    


WITH user_base AS (
    SELECT
        eu.user_id,
        eu.country,
        eu.signup_date,
        eu.signup_week,
        eu.is_referred_user,
        -- Get first transaction details
        MIN(et.timestamp) as first_transaction_date,
        MIN(et.usd_value) as first_transaction_amount
    FROM "nca"."public"."int_enriched_users" eu
    LEFT JOIN "nca"."public"."int_enriched_transactions" et 
        ON eu.user_id = et.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN DATE_DIFF('hour', signup_date, first_transaction_date)
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY signup_week DESC, total_signups DESC
  );
  
[0m21:04:26.575674 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_diff(unknown, date, timestamp without time zone) does not exist
LINE 48:             THEN DATE_DIFF('hour', signup_date, first_transa...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:04:26.576675 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: ROLLBACK
[0m21:04:26.578675 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: Close
[0m21:04:26.582674 [debug] [Thread-2 (]: Database Error in model fct_users_acquisition (models\marts\fct_users_acquisition.sql)
  function date_diff(unknown, date, timestamp without time zone) does not exist
  LINE 48:             THEN DATE_DIFF('hour', signup_date, first_transa...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_users_acquisition.sql
[0m21:04:26.583676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA15563D60>]}
[0m21:04:26.585686 [error] [Thread-2 (]: 16 of 16 ERROR creating sql table model public.fct_users_acquisition ........... [[31mERROR[0m in 0.19s]
[0m21:04:26.587674 [debug] [Thread-2 (]: Finished running node model.growth.fct_users_acquisition
[0m21:04:26.590673 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'error'.  Reason: Database Error in model fct_users_acquisition (models\marts\fct_users_acquisition.sql)
  function date_diff(unknown, date, timestamp without time zone) does not exist
  LINE 48:             THEN DATE_DIFF('hour', signup_date, first_transa...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_users_acquisition.sql.
[0m21:04:26.612671 [debug] [Thread-3 (]: SQL status: BEGIN in 0.140 seconds
[0m21:04:26.614678 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m21:04:26.616673 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."public"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."public"."int_enriched_users" u
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m21:04:26.649670 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.085 seconds
[0m21:04:26.657670 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m21:04:26.658669 [debug] [Thread-4 (]: SQL status: SELECT 77 in 0.106 seconds
[0m21:04:26.659671 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."public"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m21:04:26.667672 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m21:04:26.669675 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."public"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m21:04:26.670673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:04:26.675671 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m21:04:26.676672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:04:26.677673 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m21:04:26.681671 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: COMMIT
[0m21:04:26.683672 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m21:04:26.684673 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m21:04:26.686672 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: COMMIT
[0m21:04:26.687673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:26.694674 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."fct_token_metrics__dbt_backup"
[0m21:04:26.695676 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m21:04:26.698671 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m21:04:26.705670 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."fct_referral_metrics__dbt_backup"
[0m21:04:26.707672 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."public"."fct_token_metrics__dbt_backup" cascade
[0m21:04:26.709675 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m21:04:26.710672 [debug] [Thread-3 (]: SQL status: SELECT 200 in 0.092 seconds
[0m21:04:26.711675 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."public"."fct_referral_metrics__dbt_backup" cascade
[0m21:04:26.712677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:04:26.717675 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m21:04:26.721670 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: Close
[0m21:04:26.721670 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:04:26.722674 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."public"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m21:04:26.724673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1DCB3220>]}
[0m21:04:26.728674 [debug] [Thread-4 (]: On model.growth.fct_referral_metrics: Close
[0m21:04:26.731686 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:04:26.730675 [info ] [Thread-1 (]: 14 of 16 OK created sql table model public.fct_token_metrics ................... [[32mSELECT 4[0m in 0.35s]
[0m21:04:26.733674 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1DCFE860>]}
[0m21:04:26.737673 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: COMMIT
[0m21:04:26.739675 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m21:04:26.741678 [info ] [Thread-4 (]: 13 of 16 OK created sql table model public.fct_referral_metrics ................ [[32mSELECT 77[0m in 0.36s]
[0m21:04:26.742673 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m21:04:26.746674 [debug] [Thread-4 (]: Finished running node model.growth.fct_referral_metrics
[0m21:04:26.747675 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: COMMIT
[0m21:04:26.750673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:04:26.756688 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."fct_user_metrics__dbt_backup"
[0m21:04:26.758674 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m21:04:26.759676 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."public"."fct_user_metrics__dbt_backup" cascade
[0m21:04:26.760673 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:04:26.764677 [debug] [Thread-3 (]: On model.growth.fct_user_metrics: Close
[0m21:04:26.767682 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212f9a67-7966-448a-9111-1933ab3af6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C47B760>]}
[0m21:04:26.770674 [info ] [Thread-3 (]: 15 of 16 OK created sql table model public.fct_user_metrics .................... [[32mSELECT 200[0m in 0.39s]
[0m21:04:26.772672 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_metrics
[0m21:04:26.775674 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:26.775674 [debug] [MainThread]: On master: BEGIN
[0m21:04:26.776684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:26.840672 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m21:04:26.841673 [debug] [MainThread]: On master: COMMIT
[0m21:04:26.842674 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:26.843673 [debug] [MainThread]: On master: COMMIT
[0m21:04:26.844672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:04:26.845673 [debug] [MainThread]: On master: Close
[0m21:04:26.846672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:26.847672 [debug] [MainThread]: Connection 'create_nca_public' was properly closed.
[0m21:04:26.848678 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m21:04:26.849676 [debug] [MainThread]: Connection 'model.growth.fct_token_metrics' was properly closed.
[0m21:04:26.850677 [debug] [MainThread]: Connection 'model.growth.fct_users_acquisition' was properly closed.
[0m21:04:26.851676 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m21:04:26.852676 [debug] [MainThread]: Connection 'model.growth.fct_referral_metrics' was properly closed.
[0m21:04:26.853672 [info ] [MainThread]: 
[0m21:04:26.855672 [info ] [MainThread]: Finished running 6 table models, 10 view models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m21:04:26.860672 [debug] [MainThread]: Command end result
[0m21:04:26.905670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m21:04:26.909672 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m21:04:26.923671 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m21:04:26.925674 [info ] [MainThread]: 
[0m21:04:26.926672 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:04:26.927673 [info ] [MainThread]: 
[0m21:04:26.928672 [error] [MainThread]:   Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 15:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql
[0m21:04:26.930671 [info ] [MainThread]: 
[0m21:04:26.932672 [error] [MainThread]:   Database Error in model fct_users_acquisition (models\marts\fct_users_acquisition.sql)
  function date_diff(unknown, date, timestamp without time zone) does not exist
  LINE 48:             THEN DATE_DIFF('hour', signup_date, first_transa...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_users_acquisition.sql
[0m21:04:26.934674 [info ] [MainThread]: 
[0m21:04:26.936671 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 TOTAL=16
[0m21:04:26.942690 [debug] [MainThread]: Command `dbt run` failed at 21:04:26.941677 after 5.34 seconds
[0m21:04:26.943673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA19D6D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C4B16C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1C4B35E0>]}
[0m21:04:26.944675 [debug] [MainThread]: Flushing usage events
[0m21:04:28.526051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:04.243289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274139CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741587D6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741587D510>]}


============================== 22:11:04.256282 | c44a232b-aee7-4233-aa84-08eb1c463b88 ==============================
[0m22:11:04.256282 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:11:04.257287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:04.782630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741585B7C0>]}
[0m22:11:04.870628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027415339E70>]}
[0m22:11:04.874629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:11:05.481640 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:11:05.880642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:11:05.881639 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\mart_daily_transactions.sql
[0m22:11:05.882640 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_users_acquisition.sql
[0m22:11:06.348640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.intermediate
- models.growth_metrics.marts
- models.growth_metrics.staging
[0m22:11:06.384637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274160D5A20>]}
[0m22:11:06.581637 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:11:06.588638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:11:06.767640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274160102E0>]}
[0m22:11:06.769638 [info ] [MainThread]: Found 16 models, 20 data tests, 4 sources, 431 macros
[0m22:11:06.771642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274160108B0>]}
[0m22:11:06.776641 [info ] [MainThread]: 
[0m22:11:06.780646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:06.782641 [info ] [MainThread]: 
[0m22:11:06.784641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:06.803643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m22:11:07.142637 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m22:11:07.142637 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m22:11:07.143638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:07.244641 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.101 seconds
[0m22:11:07.248660 [debug] [ThreadPool]: On list_nca: Close
[0m22:11:07.255639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m22:11:07.270188 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:11:07.271255 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m22:11:07.272330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:07.347075 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m22:11:07.348705 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:11:07.349719 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:11:07.369992 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.019 seconds
[0m22:11:07.374165 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m22:11:07.376294 [debug] [ThreadPool]: On list_nca_public: Close
[0m22:11:07.398536 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:07.399804 [debug] [MainThread]: On master: BEGIN
[0m22:11:07.400987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:07.469907 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m22:11:07.470909 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:07.471908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:11:07.502906 [debug] [MainThread]: SQL status: SELECT 12 in 0.029 seconds
[0m22:11:07.508903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027415E3EE30>]}
[0m22:11:07.509904 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:07.510908 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:07.510908 [debug] [MainThread]: On master: BEGIN
[0m22:11:07.512907 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:11:07.514911 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.515911 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:07.516909 [debug] [MainThread]: On master: COMMIT
[0m22:11:07.517909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:11:07.518907 [debug] [MainThread]: On master: Close
[0m22:11:07.526908 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m22:11:07.527907 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m22:11:07.530910 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m22:11:07.531908 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m22:11:07.532906 [info ] [Thread-1 (]: 1 of 16 START sql view model public.stg_market ................................. [RUN]
[0m22:11:07.534908 [info ] [Thread-2 (]: 2 of 16 START sql view model public.stg_referrals .............................. [RUN]
[0m22:11:07.535906 [info ] [Thread-3 (]: 3 of 16 START sql view model public.stg_transactions ........................... [RUN]
[0m22:11:07.536907 [info ] [Thread-4 (]: 4 of 16 START sql view model public.stg_users .................................. [RUN]
[0m22:11:07.537908 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m22:11:07.540910 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m22:11:07.541907 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m22:11:07.543910 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m22:11:07.544907 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m22:11:07.550910 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m22:11:07.551908 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m22:11:07.552908 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m22:11:07.571910 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m22:11:07.577909 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m22:11:07.587909 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m22:11:07.591903 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m22:11:07.594906 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m22:11:07.617906 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m22:11:07.618908 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m22:11:07.669907 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m22:11:07.683911 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m22:11:07.693903 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m22:11:07.694905 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m22:11:07.704925 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m22:11:07.705908 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:07.707907 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m22:11:07.708908 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:07.709909 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:07.711909 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:07.713914 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:07.715910 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m22:11:07.716911 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m22:11:07.718912 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m22:11:07.719910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:07.721907 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:07.723908 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:11:07.842906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m22:11:07.843916 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:07.844907 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."public"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m22:11:07.854908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.134 seconds
[0m22:11:07.855915 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:07.857909 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."public"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m22:11:07.858909 [debug] [Thread-4 (]: SQL status: BEGIN in 0.136 seconds
[0m22:11:07.866910 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:07.867909 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."public"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m22:11:07.873908 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:11:07.885907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m22:11:07.886908 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m22:11:07.890910 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:07.891908 [debug] [Thread-2 (]: SQL status: BEGIN in 0.169 seconds
[0m22:11:07.898909 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:07.905907 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:07.906907 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."public"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:11:07.908909 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:07.909908 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m22:11:07.910908 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."public"."stg_market" rename to "stg_market__dbt_backup"
[0m22:11:07.911908 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."public"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m22:11:07.914909 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:11:07.917910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:07.918908 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:11:07.925907 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:07.926908 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:11:07.934909 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:07.940906 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:07.941906 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."public"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:11:07.950908 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:07.951909 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."public"."stg_market__dbt_tmp" rename to "stg_market"
[0m22:11:07.952908 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:11:07.954906 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."public"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m22:11:07.955908 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:07.957911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:07.958910 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:07.978910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m22:11:07.993905 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:11:07.998909 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:11:08.001903 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:11:08.006906 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:08.007905 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:08.008905 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:08.009907 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:08.010908 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."public"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m22:11:08.011906 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:11:08.014912 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:11:08.015907 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:11:08.017908 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:08.018910 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:11:08.019908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:11:08.020907 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:08.022907 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:11:08.046908 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:08.040903 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."stg_market__dbt_backup"
[0m22:11:08.045909 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."stg_users__dbt_backup"
[0m22:11:08.036907 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."stg_transactions__dbt_backup"
[0m22:11:08.048911 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:11:08.057908 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:11:08.058906 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:11:08.060905 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:11:08.062909 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."public"."stg_market__dbt_backup" cascade
[0m22:11:08.063912 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:11:08.065910 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."public"."stg_users__dbt_backup" cascade
[0m22:11:08.066908 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."public"."stg_transactions__dbt_backup" cascade
[0m22:11:08.071906 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."stg_referrals__dbt_backup"
[0m22:11:08.074908 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:11:08.075906 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."public"."stg_referrals__dbt_backup" cascade
[0m22:11:08.079907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m22:11:08.085906 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m22:11:08.086907 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.014 seconds
[0m22:11:08.087906 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:11:08.087906 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m22:11:08.093907 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m22:11:08.097915 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m22:11:08.101905 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m22:11:08.102907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274161F0580>]}
[0m22:11:08.103908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274176D1420>]}
[0m22:11:08.105909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274160802B0>]}
[0m22:11:08.107909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027416012140>]}
[0m22:11:08.109909 [info ] [Thread-1 (]: 1 of 16 OK created sql view model public.stg_market ............................ [[32mCREATE VIEW[0m in 0.55s]
[0m22:11:08.112911 [info ] [Thread-4 (]: 4 of 16 OK created sql view model public.stg_users ............................. [[32mCREATE VIEW[0m in 0.56s]
[0m22:11:08.116909 [info ] [Thread-2 (]: 2 of 16 OK created sql view model public.stg_referrals ......................... [[32mCREATE VIEW[0m in 0.57s]
[0m22:11:08.118910 [info ] [Thread-3 (]: 3 of 16 OK created sql view model public.stg_transactions ...................... [[32mCREATE VIEW[0m in 0.57s]
[0m22:11:08.121912 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m22:11:08.125911 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m22:11:08.126909 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m22:11:08.127907 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m22:11:08.132910 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m22:11:08.135911 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m22:11:08.137910 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m22:11:08.138906 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m22:11:08.139905 [info ] [Thread-1 (]: 5 of 16 START sql view model public.dim_market ................................. [RUN]
[0m22:11:08.140908 [info ] [Thread-4 (]: 6 of 16 START sql view model public.dim_users .................................. [RUN]
[0m22:11:08.151909 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.dim_users)
[0m22:11:08.143908 [info ] [Thread-3 (]: 8 of 16 START sql view model public.dim_transactions ........................... [RUN]
[0m22:11:08.145907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_market)
[0m22:11:08.142914 [info ] [Thread-2 (]: 7 of 16 START sql view model public.dim_referrals .............................. [RUN]
[0m22:11:08.153920 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m22:11:08.155906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m22:11:08.156907 [debug] [Thread-1 (]: Began compiling node model.growth.dim_market
[0m22:11:08.157905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m22:11:08.169908 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m22:11:08.172910 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m22:11:08.188910 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_market"
[0m22:11:08.189909 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m22:11:08.194906 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m22:11:08.206907 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m22:11:08.207909 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m22:11:08.208908 [debug] [Thread-1 (]: Began executing node model.growth.dim_market
[0m22:11:08.210908 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m22:11:08.212910 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m22:11:08.221907 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m22:11:08.233906 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_market"
[0m22:11:08.241905 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m22:11:08.252906 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m22:11:08.259908 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:11:08.261907 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:11:08.263910 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:11:08.265909 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:11:08.266908 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m22:11:08.267908 [debug] [Thread-1 (]: On model.growth.dim_market: BEGIN
[0m22:11:08.268906 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m22:11:08.269906 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m22:11:08.269906 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:11:08.270908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.271906 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:08.272906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:08.395908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.124 seconds
[0m22:11:08.397910 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:11:08.399915 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."public"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."public"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m22:11:08.402909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m22:11:08.403909 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:11:08.405907 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."public"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."public"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m22:11:08.412907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:11:08.422908 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:11:08.424910 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m22:11:08.425909 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m22:11:08.426908 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m22:11:08.426908 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."public"."dim_market__dbt_tmp" rename to "dim_market"
[0m22:11:08.435909 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:11:08.436908 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:11:08.437905 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:11:08.438907 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."public"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m22:11:08.439908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:08.440908 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."public"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."public"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m22:11:08.441905 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."public"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."public"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m22:11:08.444907 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:11:08.448914 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:11:08.444907 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:11:08.450911 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:11:08.454909 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:11:08.455908 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m22:11:08.455908 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:11:08.457911 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:11:08.457911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:08.464912 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:11:08.469906 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:11:08.470906 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:11:08.475906 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."dim_market__dbt_backup"
[0m22:11:08.477906 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m22:11:08.478907 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."public"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m22:11:08.481910 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:11:08.482908 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m22:11:08.484910 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:08.485906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:08.485906 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."public"."dim_market__dbt_backup" cascade
[0m22:11:08.489903 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."dim_transactions__dbt_backup"
[0m22:11:08.492908 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m22:11:08.495907 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:11:08.499913 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:11:08.500906 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:11:08.501909 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:11:08.501909 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:11:08.502906 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."public"."dim_transactions__dbt_backup" cascade
[0m22:11:08.504906 [debug] [Thread-1 (]: On model.growth.dim_market: Close
[0m22:11:08.505904 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m22:11:08.506907 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:11:08.508910 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:11:08.509908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274177D5990>]}
[0m22:11:08.512909 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:08.514928 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:11:08.518905 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m22:11:08.525910 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."dim_users__dbt_backup"
[0m22:11:08.519905 [info ] [Thread-1 (]: 5 of 16 OK created sql view model public.dim_market ............................ [[32mCREATE VIEW[0m in 0.37s]
[0m22:11:08.532910 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."dim_referrals__dbt_backup"
[0m22:11:08.534919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027415E3ED70>]}
[0m22:11:08.536906 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:11:08.539917 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m22:11:08.542907 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:11:08.546908 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."public"."dim_users__dbt_backup" cascade
[0m22:11:08.544907 [info ] [Thread-3 (]: 8 of 16 OK created sql view model public.dim_transactions ...................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:11:08.550913 [debug] [Thread-1 (]: Began running node model.growth.fct_users_acquisition
[0m22:11:08.551909 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."public"."dim_referrals__dbt_backup" cascade
[0m22:11:08.556907 [info ] [Thread-1 (]: 9 of 16 START sql table model public.fct_users_acquisition ..................... [RUN]
[0m22:11:08.555908 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:11:08.553908 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m22:11:08.557906 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:11:08.558908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.fct_users_acquisition)
[0m22:11:08.562907 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m22:11:08.565912 [debug] [Thread-3 (]: Began running node model.growth.mart_daily_transactions
[0m22:11:08.569914 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m22:11:08.577911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274160AF6D0>]}
[0m22:11:08.574910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741380EB90>]}
[0m22:11:08.572910 [debug] [Thread-1 (]: Began compiling node model.growth.fct_users_acquisition
[0m22:11:08.575908 [info ] [Thread-3 (]: 10 of 16 START sql table model public.mart_daily_transactions .................. [RUN]
[0m22:11:08.580910 [info ] [Thread-2 (]: 7 of 16 OK created sql view model public.dim_referrals ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m22:11:08.583910 [info ] [Thread-4 (]: 6 of 16 OK created sql view model public.dim_users ............................. [[32mCREATE VIEW[0m in 0.42s]
[0m22:11:08.604914 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m22:11:08.606911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.mart_daily_transactions)
[0m22:11:08.608908 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m22:11:08.610910 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m22:11:08.612907 [debug] [Thread-3 (]: Began compiling node model.growth.mart_daily_transactions
[0m22:11:08.618911 [debug] [Thread-1 (]: Began executing node model.growth.fct_users_acquisition
[0m22:11:08.620908 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m22:11:08.621906 [debug] [Thread-4 (]: Began running node model.growth.int_enriched_transactions
[0m22:11:08.635912 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m22:11:08.700920 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m22:11:08.702909 [info ] [Thread-2 (]: 11 of 16 START sql table model public.mart_transaction_summary ................. [RUN]
[0m22:11:08.704910 [info ] [Thread-4 (]: 12 of 16 START sql view model public.int_enriched_transactions ................. [RUN]
[0m22:11:08.707908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.mart_transaction_summary)
[0m22:11:08.709908 [debug] [Thread-3 (]: Began executing node model.growth.mart_daily_transactions
[0m22:11:08.712911 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:11:08.716910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.int_enriched_transactions)
[0m22:11:08.718908 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m22:11:08.735911 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m22:11:08.736909 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: BEGIN
[0m22:11:08.737905 [debug] [Thread-4 (]: Began compiling node model.growth.int_enriched_transactions
[0m22:11:08.752907 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m22:11:08.754919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.761907 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m22:11:08.766909 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:11:08.769909 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m22:11:08.771909 [debug] [Thread-3 (]: On model.growth.mart_daily_transactions: BEGIN
[0m22:11:08.774912 [debug] [Thread-4 (]: Began executing node model.growth.int_enriched_transactions
[0m22:11:08.793906 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m22:11:08.795909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:08.809908 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m22:11:08.815908 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:08.818912 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m22:11:08.820912 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:11:08.822915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:08.824911 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: BEGIN
[0m22:11:08.826910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:11:08.875911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m22:11:08.877911 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:11:08.879908 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."public"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."public"."stg_users" u
    LEFT JOIN "nca"."public"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."public"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m22:11:08.927904 [debug] [Thread-1 (]: SQL status: SELECT 97 in 0.045 seconds
[0m22:11:08.936911 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:11:08.937912 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."public"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m22:11:08.941909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:08.953906 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:11:08.954904 [debug] [Thread-3 (]: SQL status: BEGIN in 0.159 seconds
[0m22:11:08.955906 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:11:08.956906 [debug] [Thread-2 (]: SQL status: BEGIN in 0.134 seconds
[0m22:11:08.957907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.131 seconds
[0m22:11:08.957907 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:11:08.958906 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:11:08.959907 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:08.960907 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:11:08.961906 [debug] [Thread-3 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."public"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."public"."stg_transactions"
GROUP BY 
    transaction_date,
    token,
    transaction_type
  );
  
[0m22:11:08.963913 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."public"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."public"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m22:11:08.966916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:11:08.967909 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."public"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."public"."dim_transactions" t
    LEFT JOIN "nca"."public"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m22:11:08.974908 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."fct_users_acquisition__dbt_backup"
[0m22:11:08.975907 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "transaction_date" does not exist
LINE 23:     transaction_date,
             ^
HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".

[0m22:11:08.983909 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:11:08.985909 [debug] [Thread-3 (]: On model.growth.mart_daily_transactions: ROLLBACK
[0m22:11:08.986907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m22:11:08.987909 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."public"."fct_users_acquisition__dbt_backup" cascade
[0m22:11:08.988907 [debug] [Thread-3 (]: On model.growth.mart_daily_transactions: Close
[0m22:11:08.993907 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:11:08.995908 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:11:08.999911 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.031 seconds
[0m22:11:09.000909 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."public"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m22:11:09.005908 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: Close
[0m22:11:09.012905 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:09.016912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:09.018910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027417855AB0>]}
[0m22:11:09.019907 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."public"."mart_transaction_summary" rename to "mart_transaction_summary__dbt_backup"
[0m22:11:09.027912 [info ] [Thread-1 (]: 9 of 16 OK created sql table model public.fct_users_acquisition ................ [[32mSELECT 97[0m in 0.46s]
[0m22:11:09.032910 [debug] [Thread-1 (]: Finished running node model.growth.fct_users_acquisition
[0m22:11:09.033913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:11:09.024907 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:11:09.035907 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m22:11:09.047907 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:09.050918 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:11:09.052907 [info ] [Thread-1 (]: 13 of 16 START sql view model public.int_enriched_users ........................ [RUN]
[0m22:11:09.054908 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."public"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m22:11:09.057925 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:11:09.059909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.int_enriched_users)
[0m22:11:09.064910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:09.068912 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:09.070910 [debug] [Thread-1 (]: Began compiling node model.growth.int_enriched_users
[0m22:11:09.076910 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:11:09.083931 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."int_enriched_transactions__dbt_backup"
[0m22:11:09.091907 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m22:11:09.092907 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:09.095905 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:11:09.103916 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:11:09.105917 [debug] [Thread-1 (]: Began executing node model.growth.int_enriched_users
[0m22:11:09.107908 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."public"."int_enriched_transactions__dbt_backup" cascade
[0m22:11:09.110906 [debug] [Thread-3 (]: Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 23:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql
[0m22:11:09.111904 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:11:09.125909 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m22:11:09.127909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274177D5960>]}
[0m22:11:09.128909 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:11:09.137906 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."mart_transaction_summary__dbt_backup"
[0m22:11:09.142909 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: Close
[0m22:11:09.148914 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027417833F40>]}
[0m22:11:09.143910 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:11:09.145908 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:11:09.140910 [error] [Thread-3 (]: 10 of 16 ERROR creating sql table model public.mart_daily_transactions ......... [[31mERROR[0m in 0.52s]
[0m22:11:09.153909 [debug] [Thread-1 (]: On model.growth.int_enriched_users: BEGIN
[0m22:11:09.151911 [info ] [Thread-4 (]: 12 of 16 OK created sql view model public.int_enriched_transactions ............ [[32mCREATE VIEW[0m in 0.43s]
[0m22:11:09.155909 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."public"."mart_transaction_summary__dbt_backup" cascade
[0m22:11:09.168913 [debug] [Thread-4 (]: Finished running node model.growth.int_enriched_transactions
[0m22:11:09.158910 [debug] [Thread-3 (]: Finished running node model.growth.mart_daily_transactions
[0m22:11:09.160908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:09.174909 [debug] [Thread-4 (]: Began running node model.growth.fct_token_metrics
[0m22:11:09.178907 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'error'.  Reason: Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 23:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql.
[0m22:11:09.185912 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m22:11:09.193907 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m22:11:09.195908 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027417953FA0>]}
[0m22:11:09.187912 [info ] [Thread-4 (]: 14 of 16 START sql table model public.fct_token_metrics ........................ [RUN]
[0m22:11:09.211908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_token_metrics)
[0m22:11:09.216911 [debug] [Thread-4 (]: Began compiling node model.growth.fct_token_metrics
[0m22:11:09.234913 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m22:11:09.239916 [debug] [Thread-4 (]: Began executing node model.growth.fct_token_metrics
[0m22:11:09.198910 [info ] [Thread-2 (]: 11 of 16 OK created sql table model public.mart_transaction_summary ............ [[32mSELECT 8[0m in 0.49s]
[0m22:11:09.274913 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m22:11:09.283939 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m22:11:09.288908 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.289907 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: BEGIN
[0m22:11:09.291908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:11:09.333909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.173 seconds
[0m22:11:09.334913 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:11:09.336909 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."public"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."public"."dim_users" u
    LEFT JOIN "nca"."public"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m22:11:09.344905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:11:09.356908 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:11:09.357907 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."public"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m22:11:09.359908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:09.362907 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m22:11:09.363907 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:11:09.367918 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m22:11:09.369911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:09.374910 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."int_enriched_users__dbt_backup"
[0m22:11:09.376907 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:11:09.376907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.085 seconds
[0m22:11:09.377907 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."public"."int_enriched_users__dbt_backup" cascade
[0m22:11:09.378907 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.380909 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."public"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."public"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m22:11:09.382913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:11:09.386908 [debug] [Thread-1 (]: On model.growth.int_enriched_users: Close
[0m22:11:09.387909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274153BBF40>]}
[0m22:11:09.390911 [info ] [Thread-1 (]: 13 of 16 OK created sql view model public.int_enriched_users ................... [[32mCREATE VIEW[0m in 0.33s]
[0m22:11:09.393910 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m22:11:09.395908 [debug] [Thread-3 (]: Began running node model.growth.fct_referral_metrics
[0m22:11:09.395908 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m22:11:09.397907 [info ] [Thread-3 (]: 15 of 16 START sql table model public.fct_referral_metrics ..................... [RUN]
[0m22:11:09.405912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_referral_metrics)
[0m22:11:09.402908 [info ] [Thread-2 (]: 16 of 16 START sql table model public.fct_user_metrics ......................... [RUN]
[0m22:11:09.407917 [debug] [Thread-3 (]: Began compiling node model.growth.fct_referral_metrics
[0m22:11:09.409911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.fct_user_metrics)
[0m22:11:09.420932 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m22:11:09.422910 [debug] [Thread-2 (]: Began compiling node model.growth.fct_user_metrics
[0m22:11:09.428906 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m22:11:09.433910 [debug] [Thread-2 (]: Began executing node model.growth.fct_user_metrics
[0m22:11:09.444907 [debug] [Thread-3 (]: Began executing node model.growth.fct_referral_metrics
[0m22:11:09.445908 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m22:11:09.459906 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m22:11:09.462908 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.465914 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: BEGIN
[0m22:11:09.467911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:09.470909 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.471911 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: BEGIN
[0m22:11:09.476908 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.094 seconds
[0m22:11:09.477907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:09.489911 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.492910 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."public"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m22:11:09.495910 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:09.506908 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.508909 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."public"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m22:11:09.511910 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:09.522909 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:11:09.524912 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.526912 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:11:09.529908 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:09.540916 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."fct_token_metrics__dbt_backup"
[0m22:11:09.543913 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:11:09.545909 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."public"."fct_token_metrics__dbt_backup" cascade
[0m22:11:09.559909 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m22:11:09.565912 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: Close
[0m22:11:09.567910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274179119F0>]}
[0m22:11:09.570910 [info ] [Thread-4 (]: 14 of 16 OK created sql table model public.fct_token_metrics ................... [[32mSELECT 4[0m in 0.36s]
[0m22:11:09.573910 [debug] [Thread-4 (]: Finished running node model.growth.fct_token_metrics
[0m22:11:09.602910 [debug] [Thread-2 (]: SQL status: BEGIN in 0.135 seconds
[0m22:11:09.604927 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.606910 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."public"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."public"."int_enriched_users" u
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m22:11:09.642055 [debug] [Thread-3 (]: SQL status: BEGIN in 0.164 seconds
[0m22:11:09.643993 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.645567 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."public"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."public"."dim_referrals" r
    JOIN "nca"."public"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m22:11:09.741583 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.133 seconds
[0m22:11:09.752372 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.753785 [debug] [Thread-3 (]: SQL status: SELECT 77 in 0.107 seconds
[0m22:11:09.755463 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."public"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m22:11:09.764012 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.767107 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."public"."fct_referral_metrics" rename to "fct_referral_metrics__dbt_backup"
[0m22:11:09.768109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:11:09.779481 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.780550 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:11:09.782643 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."public"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m22:11:09.886257 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.888257 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."public"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m22:11:09.889254 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:11:09.894259 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:11:09.894259 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:11:09.896256 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.902256 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:11:09.903257 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:11:09.904259 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.906254 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:11:09.907257 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:11:09.913258 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."fct_user_metrics__dbt_backup"
[0m22:11:09.914256 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m22:11:09.917259 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:11:09.921254 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."fct_referral_metrics__dbt_backup"
[0m22:11:09.922253 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."public"."fct_user_metrics__dbt_backup" cascade
[0m22:11:09.924254 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:11:09.925253 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."public"."fct_referral_metrics__dbt_backup" cascade
[0m22:11:09.929255 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:11:09.934256 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: Close
[0m22:11:09.936255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741795C700>]}
[0m22:11:09.939258 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m22:11:09.938257 [info ] [Thread-2 (]: 16 of 16 OK created sql table model public.fct_user_metrics .................... [[32mSELECT 200[0m in 0.53s]
[0m22:11:09.943254 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: Close
[0m22:11:09.945254 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m22:11:09.947256 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44a232b-aee7-4233-aa84-08eb1c463b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027417907BE0>]}
[0m22:11:09.950256 [info ] [Thread-3 (]: 15 of 16 OK created sql table model public.fct_referral_metrics ................ [[32mSELECT 77[0m in 0.54s]
[0m22:11:09.953257 [debug] [Thread-3 (]: Finished running node model.growth.fct_referral_metrics
[0m22:11:09.958257 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:09.960258 [debug] [MainThread]: On master: BEGIN
[0m22:11:09.961260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:10.040254 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m22:11:10.041253 [debug] [MainThread]: On master: COMMIT
[0m22:11:10.041253 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:10.042254 [debug] [MainThread]: On master: COMMIT
[0m22:11:10.043256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:11:10.044253 [debug] [MainThread]: On master: Close
[0m22:11:10.045252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:10.046254 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m22:11:10.047255 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m22:11:10.050266 [debug] [MainThread]: Connection 'model.growth.int_enriched_users' was properly closed.
[0m22:11:10.051256 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m22:11:10.053256 [debug] [MainThread]: Connection 'model.growth.fct_referral_metrics' was properly closed.
[0m22:11:10.054255 [debug] [MainThread]: Connection 'model.growth.fct_token_metrics' was properly closed.
[0m22:11:10.055254 [info ] [MainThread]: 
[0m22:11:10.057258 [info ] [MainThread]: Finished running 6 table models, 10 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m22:11:10.062252 [debug] [MainThread]: Command end result
[0m22:11:10.123255 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:11:10.126254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:11:10.142252 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:11:10.143254 [info ] [MainThread]: 
[0m22:11:10.145256 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:11:10.146255 [info ] [MainThread]: 
[0m22:11:10.147254 [error] [MainThread]:   Database Error in model mart_daily_transactions (models\marts\mart_daily_transactions.sql)
  column "transaction_date" does not exist
  LINE 23:     transaction_date,
               ^
  HINT:  Perhaps you meant to reference the column "stg_transactions.transaction_type".
  compiled code at target\run\growth\models\marts\mart_daily_transactions.sql
[0m22:11:10.153257 [info ] [MainThread]: 
[0m22:11:10.155257 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m22:11:10.161259 [debug] [MainThread]: Command `dbt run` failed at 22:11:10.161259 after 6.08 seconds
[0m22:11:10.163256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274139CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027416005ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274177AA980>]}
[0m22:11:10.164257 [debug] [MainThread]: Flushing usage events
[0m22:11:12.404664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:12:18.311282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022474B4D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476A016C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476A014E0>]}


============================== 22:12:18.315280 | 26395d97-2ff9-4b07-9cd4-db14f01e9b9c ==============================
[0m22:12:18.315280 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:12:18.318288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:12:18.606283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476B28A60>]}
[0m22:12:18.688280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476A088B0>]}
[0m22:12:18.689281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:12:19.145282 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:12:19.448280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:12:19.449282 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\mart_daily_transactions.sql
[0m22:12:19.913414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.marts
- models.growth_metrics.staging
- models.growth_metrics.intermediate
[0m22:12:19.956413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247739C0A0>]}
[0m22:12:20.122414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:12:20.127414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:12:20.159413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022477326CE0>]}
[0m22:12:20.160413 [info ] [MainThread]: Found 16 models, 20 data tests, 4 sources, 431 macros
[0m22:12:20.161414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224773279D0>]}
[0m22:12:20.164413 [info ] [MainThread]: 
[0m22:12:20.165412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:12:20.167419 [info ] [MainThread]: 
[0m22:12:20.172417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:12:20.181413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m22:12:20.394415 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m22:12:20.395415 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m22:12:20.395415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:20.455413 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.060 seconds
[0m22:12:20.457411 [debug] [ThreadPool]: On list_nca: Close
[0m22:12:20.461417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m22:12:20.470421 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:12:20.471415 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m22:12:20.471415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:20.520419 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m22:12:20.521419 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:12:20.522415 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:12:20.527414 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.005 seconds
[0m22:12:20.530416 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m22:12:20.531414 [debug] [ThreadPool]: On list_nca_public: Close
[0m22:12:20.543411 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:20.544414 [debug] [MainThread]: On master: BEGIN
[0m22:12:20.545413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:20.592412 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m22:12:20.593414 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:20.594416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:12:20.605413 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m22:12:20.609411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224771F6E00>]}
[0m22:12:20.610413 [debug] [MainThread]: On master: ROLLBACK
[0m22:12:20.610413 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:20.611415 [debug] [MainThread]: On master: BEGIN
[0m22:12:20.612414 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:12:20.613415 [debug] [MainThread]: On master: COMMIT
[0m22:12:20.613415 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:20.614416 [debug] [MainThread]: On master: COMMIT
[0m22:12:20.615413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:12:20.615413 [debug] [MainThread]: On master: Close
[0m22:12:20.623416 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m22:12:20.624416 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m22:12:20.624416 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m22:12:20.625414 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m22:12:20.627414 [info ] [Thread-1 (]: 1 of 16 START sql view model public.stg_market ................................. [RUN]
[0m22:12:20.628416 [info ] [Thread-2 (]: 2 of 16 START sql view model public.stg_referrals .............................. [RUN]
[0m22:12:20.629419 [info ] [Thread-3 (]: 3 of 16 START sql view model public.stg_transactions ........................... [RUN]
[0m22:12:20.632414 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m22:12:20.631416 [info ] [Thread-4 (]: 4 of 16 START sql view model public.stg_users .................................. [RUN]
[0m22:12:20.633414 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m22:12:20.634416 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m22:12:20.638416 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m22:12:20.640419 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m22:12:20.642417 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m22:12:20.643417 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m22:12:20.662414 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m22:12:20.663415 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m22:12:20.667413 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m22:12:20.674414 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m22:12:20.678413 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m22:12:20.679413 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m22:12:20.680413 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m22:12:20.682414 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m22:12:20.700414 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m22:12:20.728412 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m22:12:20.733413 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m22:12:20.741413 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m22:12:20.746411 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m22:12:20.748415 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:20.749414 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.750416 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m22:12:20.751413 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:20.753418 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:20.754416 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m22:12:20.755427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:12:20.756413 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m22:12:20.756413 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m22:12:20.757414 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:12:20.758413 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:12:20.759414 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:12:20.849413 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m22:12:20.850414 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.851412 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."public"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m22:12:20.858414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:12:20.867411 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.869416 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."public"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m22:12:20.871422 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m22:12:20.872429 [debug] [Thread-4 (]: SQL status: BEGIN in 0.113 seconds
[0m22:12:20.873414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:20.874412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m22:12:20.874412 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:20.875413 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:20.879412 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.879412 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:20.880412 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."public"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m22:12:20.881412 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."public"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m22:12:20.882413 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."public"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m22:12:20.882413 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."public"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m22:12:20.888420 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:20.890418 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:12:20.891414 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:12:20.891414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:12:20.912412 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:12:20.916411 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:20.925418 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:20.938416 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:20.939416 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.940414 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m22:12:20.941430 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."public"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:12:20.942412 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."public"."stg_market" rename to "stg_market__dbt_backup"
[0m22:12:20.943416 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:12:20.945416 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:20.946422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:20.947414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:20.955417 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:20.956420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:12:20.961420 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:20.967415 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:20.968414 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:12:20.980421 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."stg_referrals__dbt_backup"
[0m22:12:20.981413 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."public"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:12:20.982413 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."public"."stg_market__dbt_tmp" rename to "stg_market"
[0m22:12:20.991421 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:12:20.991421 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m22:12:20.993417 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:20.993417 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."public"."stg_referrals__dbt_backup" cascade
[0m22:12:20.994414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:20.998413 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:12:21.001415 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:12:21.006415 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:12:21.007417 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:21.008418 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:12:21.009417 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:21.011416 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:21.019414 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:12:21.016414 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m22:12:21.017418 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:12:21.012413 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:12:21.025417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:12:21.026416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224766148B0>]}
[0m22:12:21.027423 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:12:21.034414 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."stg_market__dbt_backup"
[0m22:12:21.035413 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:12:21.038418 [info ] [Thread-2 (]: 2 of 16 OK created sql view model public.stg_referrals ......................... [[32mCREATE VIEW[0m in 0.39s]
[0m22:12:21.042416 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."stg_transactions__dbt_backup"
[0m22:12:21.044415 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:12:21.050414 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."stg_users__dbt_backup"
[0m22:12:21.051415 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m22:12:21.054420 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:12:21.056417 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."public"."stg_market__dbt_backup" cascade
[0m22:12:21.058420 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:12:21.060419 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m22:12:21.061414 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."public"."stg_transactions__dbt_backup" cascade
[0m22:12:21.063416 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."public"."stg_users__dbt_backup" cascade
[0m22:12:21.065413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:12:21.064415 [info ] [Thread-2 (]: 5 of 16 START sql view model public.dim_referrals .............................. [RUN]
[0m22:12:21.070416 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m22:12:21.072416 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:12:21.073419 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:12:21.075418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m22:12:21.077417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247656F460>]}
[0m22:12:21.080416 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m22:12:21.083417 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m22:12:21.084414 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m22:12:21.089417 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476B54D60>]}
[0m22:12:21.085413 [info ] [Thread-1 (]: 1 of 16 OK created sql view model public.stg_market ............................ [[32mCREATE VIEW[0m in 0.45s]
[0m22:12:21.092428 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247890BEE0>]}
[0m22:12:21.100411 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m22:12:21.103419 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m22:12:21.101415 [info ] [Thread-3 (]: 3 of 16 OK created sql view model public.stg_transactions ...................... [[32mCREATE VIEW[0m in 0.46s]
[0m22:12:21.106417 [info ] [Thread-4 (]: 4 of 16 OK created sql view model public.stg_users ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m22:12:21.110428 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m22:12:21.111415 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m22:12:21.112413 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m22:12:21.112413 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m22:12:21.113415 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m22:12:21.124416 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m22:12:21.125421 [info ] [Thread-1 (]: 6 of 16 START sql view model public.dim_market ................................. [RUN]
[0m22:12:21.127421 [debug] [Thread-4 (]: Began running node model.growth.mart_daily_transactions
[0m22:12:21.128421 [info ] [Thread-3 (]: 7 of 16 START sql view model public.dim_transactions ........................... [RUN]
[0m22:12:21.130413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_market)
[0m22:12:21.132428 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:12:21.131415 [info ] [Thread-4 (]: 8 of 16 START sql table model public.mart_daily_transactions ................... [RUN]
[0m22:12:21.138419 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m22:12:21.140417 [debug] [Thread-1 (]: Began compiling node model.growth.dim_market
[0m22:12:21.141416 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m22:12:21.142416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.mart_daily_transactions)
[0m22:12:21.143413 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m22:12:21.147412 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_market"
[0m22:12:21.147412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:21.148414 [debug] [Thread-4 (]: Began compiling node model.growth.mart_daily_transactions
[0m22:12:21.154418 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m22:12:21.157422 [debug] [Thread-1 (]: Began executing node model.growth.dim_market
[0m22:12:21.165416 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m22:12:21.180417 [debug] [Thread-4 (]: Began executing node model.growth.mart_daily_transactions
[0m22:12:21.177415 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_market"
[0m22:12:21.181418 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m22:12:21.224416 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m22:12:21.225414 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m22:12:21.230411 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m22:12:21.231411 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:12:21.232414 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:12:21.233416 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:12:21.234413 [debug] [Thread-1 (]: On model.growth.dim_market: BEGIN
[0m22:12:21.235413 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."public"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."public"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m22:12:21.237416 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:12:21.238426 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: BEGIN
[0m22:12:21.239414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:21.240414 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m22:12:21.241414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:21.243415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:21.245417 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:12:21.253415 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:12:21.255420 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."public"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m22:12:21.257416 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.261416 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:12:21.263418 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:12:21.264416 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:12:21.266415 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:21.275416 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."dim_referrals__dbt_backup"
[0m22:12:21.277414 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:12:21.279415 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."public"."dim_referrals__dbt_backup" cascade
[0m22:12:21.280415 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:12:21.284416 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m22:12:21.286414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476B57D90>]}
[0m22:12:21.289418 [info ] [Thread-2 (]: 5 of 16 OK created sql view model public.dim_referrals ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:12:21.292419 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m22:12:21.294418 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m22:12:21.295415 [info ] [Thread-2 (]: 9 of 16 START sql table model public.mart_transaction_summary .................. [RUN]
[0m22:12:21.297416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.mart_transaction_summary)
[0m22:12:21.299417 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m22:12:21.312414 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m22:12:21.316416 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m22:12:21.332413 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m22:12:21.334415 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.338420 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m22:12:21.341417 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:21.350416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.109 seconds
[0m22:12:21.351418 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:12:21.354419 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."public"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."public"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m22:12:21.363416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m22:12:21.364418 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:12:21.366418 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."public"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."public"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m22:12:21.374418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:12:21.381415 [debug] [Thread-3 (]: SQL status: BEGIN in 0.138 seconds
[0m22:12:21.385415 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:12:21.388419 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:12:21.390417 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."public"."dim_market__dbt_tmp" rename to "dim_market"
[0m22:12:21.391418 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.036 seconds
[0m22:12:21.393416 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."public"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."public"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m22:12:21.402417 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:12:21.404429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m22:12:21.406418 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."public"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m22:12:21.410416 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:12:21.412415 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:12:21.412415 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.413416 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:12:21.421421 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:12:21.433415 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m22:12:21.434414 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:12:21.436412 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."public"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m22:12:21.439416 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:12:21.441415 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m22:12:21.442416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.443414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:12:21.447427 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:12:21.448417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.108 seconds
[0m22:12:21.449419 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m22:12:21.454417 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."dim_market__dbt_backup"
[0m22:12:21.456415 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:12:21.457415 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.463412 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."mart_daily_transactions__dbt_backup"
[0m22:12:21.465415 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:12:21.466416 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:12:21.467415 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."public"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."public"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."public"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m22:12:21.475413 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:12:21.476417 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."public"."dim_market__dbt_backup" cascade
[0m22:12:21.478415 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:21.479415 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."public"."mart_daily_transactions__dbt_backup" cascade
[0m22:12:21.487419 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."dim_transactions__dbt_backup"
[0m22:12:21.488417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:12:21.491413 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:12:21.492412 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:12:21.495416 [debug] [Thread-1 (]: On model.growth.dim_market: Close
[0m22:12:21.496412 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."public"."dim_transactions__dbt_backup" cascade
[0m22:12:21.498413 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: Close
[0m22:12:21.499415 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.021 seconds
[0m22:12:21.500414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224788D85B0>]}
[0m22:12:21.502416 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:12:21.511416 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.512415 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247892F6A0>]}
[0m22:12:21.515415 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m22:12:21.513413 [info ] [Thread-1 (]: 6 of 16 OK created sql view model public.dim_market ............................ [[32mCREATE VIEW[0m in 0.37s]
[0m22:12:21.516412 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."public"."mart_transaction_summary" rename to "mart_transaction_summary__dbt_backup"
[0m22:12:21.523421 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.518418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022476B564A0>]}
[0m22:12:21.521419 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m22:12:21.538422 [debug] [Thread-1 (]: Began running node model.growth.dim_users
[0m22:12:21.517413 [info ] [Thread-4 (]: 8 of 16 OK created sql table model public.mart_daily_transactions .............. [[32mSELECT 1000[0m in 0.37s]
[0m22:12:21.535413 [info ] [Thread-3 (]: 7 of 16 OK created sql view model public.dim_transactions ...................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:12:21.534410 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.541415 [info ] [Thread-1 (]: 10 of 16 START sql view model public.dim_users ................................. [RUN]
[0m22:12:21.543417 [debug] [Thread-4 (]: Finished running node model.growth.mart_daily_transactions
[0m22:12:21.544414 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m22:12:21.545413 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."public"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m22:12:21.545413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.dim_users)
[0m22:12:21.546413 [debug] [Thread-4 (]: Began running node model.growth.fct_users_acquisition
[0m22:12:21.547413 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_transactions
[0m22:12:21.548413 [debug] [Thread-1 (]: Began compiling node model.growth.dim_users
[0m22:12:21.549413 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.549413 [info ] [Thread-4 (]: 11 of 16 START sql table model public.fct_users_acquisition .................... [RUN]
[0m22:12:21.550415 [info ] [Thread-3 (]: 12 of 16 START sql view model public.int_enriched_transactions ................. [RUN]
[0m22:12:21.561421 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_users"
[0m22:12:21.563413 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:12:21.564410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_users_acquisition)
[0m22:12:21.565416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.int_enriched_transactions)
[0m22:12:21.566412 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.570425 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:12:21.567412 [debug] [Thread-1 (]: Began executing node model.growth.dim_users
[0m22:12:21.568412 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_transactions
[0m22:12:21.568412 [debug] [Thread-4 (]: Began compiling node model.growth.fct_users_acquisition
[0m22:12:21.573417 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:21.579411 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_users"
[0m22:12:21.583413 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m22:12:21.593414 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m22:12:21.596410 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."mart_transaction_summary__dbt_backup"
[0m22:12:21.598413 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m22:12:21.599413 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:12:21.600414 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_transactions
[0m22:12:21.601416 [debug] [Thread-1 (]: On model.growth.dim_users: BEGIN
[0m22:12:21.602414 [debug] [Thread-4 (]: Began executing node model.growth.fct_users_acquisition
[0m22:12:21.603415 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."public"."mart_transaction_summary__dbt_backup" cascade
[0m22:12:21.611414 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m22:12:21.612414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:21.617414 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m22:12:21.622418 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:12:21.624416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m22:12:21.626414 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: BEGIN
[0m22:12:21.627414 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.630430 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m22:12:21.631414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:21.633416 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: BEGIN
[0m22:12:21.634414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224789941F0>]}
[0m22:12:21.638420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:21.640418 [info ] [Thread-2 (]: 9 of 16 OK created sql table model public.mart_transaction_summary ............. [[32mSELECT 8[0m in 0.34s]
[0m22:12:21.643417 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m22:12:21.701417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m22:12:21.703415 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m22:12:21.705421 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."public"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."public"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m22:12:21.711416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:12:21.717414 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m22:12:21.718413 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m22:12:21.721415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:12:21.725415 [debug] [Thread-1 (]: On model.growth.dim_users: COMMIT
[0m22:12:21.726416 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m22:12:21.727417 [debug] [Thread-1 (]: On model.growth.dim_users: COMMIT
[0m22:12:21.729415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:21.729415 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m22:12:21.732411 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."dim_users__dbt_backup"
[0m22:12:21.733411 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:12:21.734417 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m22:12:21.735414 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m22:12:21.736412 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."public"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."public"."dim_transactions" t
    LEFT JOIN "nca"."public"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m22:12:21.738423 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.739417 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."public"."dim_users__dbt_backup" cascade
[0m22:12:21.741415 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."public"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."public"."stg_users" u
    LEFT JOIN "nca"."public"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."public"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m22:12:21.742416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:12:21.745415 [debug] [Thread-1 (]: On model.growth.dim_users: Close
[0m22:12:21.745415 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:12:21.747417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224788DD090>]}
[0m22:12:21.754417 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:12:21.757417 [info ] [Thread-1 (]: 10 of 16 OK created sql view model public.dim_users ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m22:12:21.758415 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."public"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m22:12:21.760415 [debug] [Thread-1 (]: Finished running node model.growth.dim_users
[0m22:12:21.762414 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_users
[0m22:12:21.763415 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:21.765417 [debug] [Thread-4 (]: SQL status: SELECT 97 in 0.023 seconds
[0m22:12:21.764418 [info ] [Thread-2 (]: 13 of 16 START sql view model public.int_enriched_users ........................ [RUN]
[0m22:12:21.769417 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:12:21.779415 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.780416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.int_enriched_users)
[0m22:12:21.781416 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:12:21.782414 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."public"."fct_users_acquisition" rename to "fct_users_acquisition__dbt_backup"
[0m22:12:21.783414 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_users
[0m22:12:21.784415 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:12:21.793414 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m22:12:21.794414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m22:12:21.799415 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.800417 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m22:12:21.801420 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_users
[0m22:12:21.802416 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."public"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m22:12:21.813418 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."int_enriched_transactions__dbt_backup"
[0m22:12:21.819416 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m22:12:21.825417 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:12:21.826413 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:12:21.827415 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."public"."int_enriched_transactions__dbt_backup" cascade
[0m22:12:21.830412 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:12:21.831415 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:12:21.833416 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.834415 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:12:21.835416 [debug] [Thread-2 (]: On model.growth.int_enriched_users: BEGIN
[0m22:12:21.837417 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:12:21.840418 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: Close
[0m22:12:21.841414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:21.843416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224788ECB20>]}
[0m22:12:21.844417 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:12:21.854420 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."fct_users_acquisition__dbt_backup"
[0m22:12:21.846415 [info ] [Thread-3 (]: 12 of 16 OK created sql view model public.int_enriched_transactions ............ [[32mCREATE VIEW[0m in 0.28s]
[0m22:12:21.857418 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:12:21.859415 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_transactions
[0m22:12:21.860414 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."public"."fct_users_acquisition__dbt_backup" cascade
[0m22:12:21.862414 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m22:12:21.864414 [info ] [Thread-1 (]: 14 of 16 START sql table model public.fct_token_metrics ........................ [RUN]
[0m22:12:21.867416 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:12:21.868417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.fct_token_metrics)
[0m22:12:21.872420 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: Close
[0m22:12:21.874416 [debug] [Thread-1 (]: Began compiling node model.growth.fct_token_metrics
[0m22:12:21.877416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224789C9FF0>]}
[0m22:12:21.886419 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m22:12:21.894420 [debug] [Thread-1 (]: Began executing node model.growth.fct_token_metrics
[0m22:12:21.909422 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m22:12:21.891417 [info ] [Thread-4 (]: 11 of 16 OK created sql table model public.fct_users_acquisition ............... [[32mSELECT 97[0m in 0.31s]
[0m22:12:21.913416 [debug] [Thread-4 (]: Finished running node model.growth.fct_users_acquisition
[0m22:12:21.915417 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:21.916418 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: BEGIN
[0m22:12:21.918416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:21.948416 [debug] [Thread-2 (]: SQL status: BEGIN in 0.107 seconds
[0m22:12:21.950415 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:12:21.951415 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."public"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."public"."dim_users" u
    LEFT JOIN "nca"."public"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m22:12:21.960418 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:12:21.968565 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:12:21.970709 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."public"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m22:12:21.973735 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:21.978179 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m22:12:21.979814 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:12:21.981156 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m22:12:21.983013 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:21.993071 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."int_enriched_users__dbt_backup"
[0m22:12:21.995358 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:12:21.996750 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."public"."int_enriched_users__dbt_backup" cascade
[0m22:12:21.997810 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:12:22.001624 [debug] [Thread-2 (]: On model.growth.int_enriched_users: Close
[0m22:12:22.002695 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022478A6CD60>]}
[0m22:12:22.006708 [info ] [Thread-2 (]: 13 of 16 OK created sql view model public.int_enriched_users ................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:12:22.009268 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_users
[0m22:12:22.011267 [debug] [Thread-3 (]: Began running node model.growth.fct_referral_metrics
[0m22:12:22.012267 [debug] [Thread-4 (]: Began running node model.growth.fct_user_metrics
[0m22:12:22.013131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m22:12:22.014772 [info ] [Thread-3 (]: 15 of 16 START sql table model public.fct_referral_metrics ..................... [RUN]
[0m22:12:22.016312 [info ] [Thread-4 (]: 16 of 16 START sql table model public.fct_user_metrics ......................... [RUN]
[0m22:12:22.017820 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:22.018833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_referral_metrics)
[0m22:12:22.026833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_user_metrics)
[0m22:12:22.027833 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."public"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."public"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m22:12:22.029069 [debug] [Thread-3 (]: Began compiling node model.growth.fct_referral_metrics
[0m22:12:22.029831 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_metrics
[0m22:12:22.042832 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m22:12:22.051832 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m22:12:22.056833 [debug] [Thread-3 (]: Began executing node model.growth.fct_referral_metrics
[0m22:12:22.067833 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m22:12:22.069831 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_metrics
[0m22:12:22.081953 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m22:12:22.083561 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.085573 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.090173 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: BEGIN
[0m22:12:22.091182 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: BEGIN
[0m22:12:22.092704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:22.094014 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:22.149739 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.118 seconds
[0m22:12:22.159257 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:22.160261 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."public"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m22:12:22.162258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.171258 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:22.173264 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."public"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m22:12:22.175261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.179263 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:12:22.180329 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m22:12:22.181397 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:22.182376 [debug] [Thread-4 (]: SQL status: BEGIN in 0.088 seconds
[0m22:12:22.183985 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.185042 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:12:22.186054 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.189058 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."public"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."public"."dim_referrals" r
    JOIN "nca"."public"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m22:12:22.190739 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."public"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."public"."int_enriched_users" u
    LEFT JOIN "nca"."public"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m22:12:22.191750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:12:22.202069 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."fct_token_metrics__dbt_backup"
[0m22:12:22.206065 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:12:22.207063 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."public"."fct_token_metrics__dbt_backup" cascade
[0m22:12:22.213167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:12:22.216166 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: Close
[0m22:12:22.218167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224789C9C00>]}
[0m22:12:22.220169 [info ] [Thread-1 (]: 14 of 16 OK created sql table model public.fct_token_metrics ................... [[32mSELECT 4[0m in 0.35s]
[0m22:12:22.224168 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m22:12:22.275166 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.081 seconds
[0m22:12:22.276166 [debug] [Thread-3 (]: SQL status: SELECT 77 in 0.083 seconds
[0m22:12:22.344162 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.348164 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.349162 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."public"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m22:12:22.350165 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."public"."fct_referral_metrics" rename to "fct_referral_metrics__dbt_backup"
[0m22:12:22.351166 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.352165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.357165 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.361163 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.362162 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."public"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m22:12:22.363166 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."public"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m22:12:22.364165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.365165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:12:22.367163 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:12:22.370163 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:12:22.371176 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.373168 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.374165 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:12:22.374165 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:12:22.376167 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:22.377167 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:12:22.380166 [debug] [Thread-4 (]: Applying DROP to: "nca"."public"."fct_user_metrics__dbt_backup"
[0m22:12:22.385163 [debug] [Thread-3 (]: Applying DROP to: "nca"."public"."fct_referral_metrics__dbt_backup"
[0m22:12:22.386168 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:12:22.390171 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:12:22.391167 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."public"."fct_user_metrics__dbt_backup" cascade
[0m22:12:22.392164 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."public"."fct_referral_metrics__dbt_backup" cascade
[0m22:12:22.396165 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:12:22.397166 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:12:22.398165 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: Close
[0m22:12:22.400166 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: Close
[0m22:12:22.401166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224789321A0>]}
[0m22:12:22.403168 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26395d97-2ff9-4b07-9cd4-db14f01e9b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022478930160>]}
[0m22:12:22.406168 [info ] [Thread-3 (]: 15 of 16 OK created sql table model public.fct_referral_metrics ................ [[32mSELECT 77[0m in 0.38s]
[0m22:12:22.410167 [debug] [Thread-3 (]: Finished running node model.growth.fct_referral_metrics
[0m22:12:22.408178 [info ] [Thread-4 (]: 16 of 16 OK created sql table model public.fct_user_metrics .................... [[32mSELECT 200[0m in 0.38s]
[0m22:12:22.414166 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_metrics
[0m22:12:22.416168 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:22.418170 [debug] [MainThread]: On master: BEGIN
[0m22:12:22.419167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:12:22.480164 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m22:12:22.481165 [debug] [MainThread]: On master: COMMIT
[0m22:12:22.481165 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:22.482165 [debug] [MainThread]: On master: COMMIT
[0m22:12:22.483165 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:12:22.484165 [debug] [MainThread]: On master: Close
[0m22:12:22.485168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:22.486167 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m22:12:22.487166 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m22:12:22.489171 [debug] [MainThread]: Connection 'model.growth.fct_token_metrics' was properly closed.
[0m22:12:22.490172 [debug] [MainThread]: Connection 'model.growth.int_enriched_users' was properly closed.
[0m22:12:22.492167 [debug] [MainThread]: Connection 'model.growth.fct_referral_metrics' was properly closed.
[0m22:12:22.493169 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m22:12:22.494168 [info ] [MainThread]: 
[0m22:12:22.495165 [info ] [MainThread]: Finished running 6 table models, 10 view models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m22:12:22.500165 [debug] [MainThread]: Command end result
[0m22:12:22.558169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:12:22.561168 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:12:22.580165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:12:22.581169 [info ] [MainThread]: 
[0m22:12:22.583167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:12:22.585168 [info ] [MainThread]: 
[0m22:12:22.586165 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m22:12:22.590174 [debug] [MainThread]: Command `dbt run` succeeded at 22:12:22.589171 after 4.42 seconds
[0m22:12:22.591170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022474B4D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022474DF92A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022478971F60>]}
[0m22:12:22.592170 [debug] [MainThread]: Flushing usage events
[0m22:12:23.833560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:49.449081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD563D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD74F1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD74F1570>]}


============================== 22:15:49.453084 | 6fe482a4-5564-42b5-9e9d-c1b7d53368c3 ==============================
[0m22:15:49.453084 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:15:49.454085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:15:49.741084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7645390>]}
[0m22:15:49.823084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD6FA9E70>]}
[0m22:15:49.825085 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:15:50.287478 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:15:50.620482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:50.621479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:50.632522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.marts
- models.growth_metrics.staging
- models.growth_metrics.intermediate
[0m22:15:50.717518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7645780>]}
[0m22:15:50.877725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:15:50.883727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:15:50.992187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7CFBDC0>]}
[0m22:15:50.992187 [info ] [MainThread]: Found 16 models, 20 data tests, 4 sources, 431 macros
[0m22:15:51.001181 [info ] [MainThread]: 
[0m22:15:51.003183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:51.004185 [info ] [MainThread]: 
[0m22:15:51.005183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:51.017184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m22:15:51.191654 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m22:15:51.192998 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m22:15:51.193824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:51.253757 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.060 seconds
[0m22:15:51.256032 [debug] [ThreadPool]: On list_nca: Close
[0m22:15:51.263889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m22:15:51.275972 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:15:51.276915 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m22:15:51.277964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:51.334752 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m22:15:51.334752 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:15:51.335752 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:15:51.343512 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.008 seconds
[0m22:15:51.347517 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m22:15:51.349519 [debug] [ThreadPool]: On list_nca_public: Close
[0m22:15:51.361511 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.361511 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.363516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:51.411510 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m22:15:51.411510 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.412511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:51.423508 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m22:15:51.426509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7D6D3C0>]}
[0m22:15:51.427511 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:51.428511 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.428511 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.431512 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:51.432515 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.433513 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.434513 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.434513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:51.435511 [debug] [MainThread]: On master: Close
[0m22:15:51.440511 [debug] [Thread-1 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:15:51.441510 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:15:51.441510 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:15:51.442510 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:15:51.443510 [info ] [Thread-1 (]: 1 of 36 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m22:15:51.444512 [info ] [Thread-2 (]: 2 of 36 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m22:15:51.444512 [info ] [Thread-3 (]: 3 of 36 START test source_not_null_staging_market_date ......................... [RUN]
[0m22:15:51.447516 [info ] [Thread-4 (]: 4 of 36 START test source_not_null_staging_market_price ........................ [RUN]
[0m22:15:51.449512 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m22:15:51.451514 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m22:15:51.452514 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_date.57bd65e8f0'
[0m22:15:51.454514 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_price.7a0eea0e50'
[0m22:15:51.456528 [debug] [Thread-1 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:15:51.457513 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:15:51.458513 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:15:51.459513 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:15:51.507509 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:15:51.523515 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:15:51.537511 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:15:51.593529 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:15:51.598517 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:15:51.598517 [debug] [Thread-1 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:15:51.618514 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:15:51.619515 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:15:51.623510 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:15:51.623510 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:15:51.627510 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:15:51.633512 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:15:51.634512 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:15:51.635510 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:15:51.636510 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m22:15:51.637513 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:15:51.638512 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:15:51.639513 [debug] [Thread-1 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m22:15:51.640510 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:51.640510 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m22:15:51.641510 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m22:15:51.642510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:51.643510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:51.644513 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:15:51.722512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m22:15:51.723510 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:15:51.724509 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m22:15:51.727513 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:51.736510 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m22:15:51.738513 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m22:15:51.738513 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m22:15:51.741511 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:15:51.743515 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m22:15:51.740514 [info ] [Thread-2 (]: 2 of 36 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.29s]
[0m22:15:51.746511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:51.749515 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:15:51.750515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m22:15:51.753511 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m22:15:51.754510 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m22:15:51.755510 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:15:51.756510 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:15:51.757511 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m22:15:51.757511 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:15:51.760514 [debug] [Thread-1 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m22:15:51.759526 [info ] [Thread-2 (]: 5 of 36 START test source_not_null_staging_market_token ........................ [RUN]
[0m22:15:51.765528 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m22:15:51.762513 [error] [Thread-4 (]: 4 of 36 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.31s]
[0m22:15:51.769514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m22:15:51.771513 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:15:51.773513 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:15:51.774512 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:51.775510 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:15:51.777510 [debug] [Thread-1 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m22:15:51.777510 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:15:51.778511 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_market_price.7a0eea0e50' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m22:15:51.783520 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m22:15:51.790513 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:15:51.792514 [debug] [Thread-1 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m22:15:51.793513 [info ] [Thread-4 (]: 6 of 36 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m22:15:51.795511 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m22:15:51.800515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m22:15:51.797513 [info ] [Thread-1 (]: 1 of 36 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.35s]
[0m22:15:51.803515 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:15:51.802514 [info ] [Thread-3 (]: 3 of 36 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.35s]
[0m22:15:51.806513 [debug] [Thread-1 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:15:51.807512 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:15:51.822512 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:15:51.824512 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:15:51.825510 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:15:51.833516 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:15:51.835512 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:15:51.836514 [info ] [Thread-1 (]: 7 of 36 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m22:15:51.838514 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:15:51.839510 [info ] [Thread-3 (]: 8 of 36 START test source_not_null_staging_referrals_referrer_user_id .......... [RUN]
[0m22:15:51.840511 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:15:51.841511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m22:15:51.844511 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:15:51.845509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m22:15:51.845509 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m22:15:51.851513 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:15:51.852513 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:15:51.853515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:51.854515 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:15:51.860514 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:15:51.871514 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:15:51.873512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m22:15:51.876513 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:15:51.878515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:51.884514 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:15:51.891510 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:15:51.903513 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:15:51.906513 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:15:51.910524 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m22:15:51.909512 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:15:51.912512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:51.917514 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m22:15:51.919512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:51.984515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.131 seconds
[0m22:15:51.986514 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:15:51.987513 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m22:15:51.990512 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:51.992510 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m22:15:51.994511 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m22:15:51.995510 [info ] [Thread-2 (]: 5 of 36 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.23s]
[0m22:15:52.001517 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:15:52.002513 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:15:52.003512 [debug] [Thread-4 (]: SQL status: BEGIN in 0.125 seconds
[0m22:15:52.004513 [debug] [Thread-3 (]: SQL status: BEGIN in 0.086 seconds
[0m22:15:52.006513 [info ] [Thread-2 (]: 9 of 36 START test source_not_null_staging_transactions_amount ................. [RUN]
[0m22:15:52.007513 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:15:52.009515 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:15:52.010512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m22:15:52.013515 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m22:15:52.015514 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m22:15:52.017514 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:15:52.036514 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:15:52.038514 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m22:15:52.039515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.127 seconds
[0m22:15:52.040516 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m22:15:52.045513 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m22:15:52.046512 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:15:52.049518 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:15:52.054516 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m22:15:52.055513 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m22:15:52.056512 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m22:15:52.060514 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:15:52.062512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m22:15:52.063512 [error] [Thread-3 (]: 8 of 36 FAIL 5 source_not_null_staging_referrals_referrer_user_id .............. [[31mFAIL 5[0m in 0.22s]
[0m22:15:52.068514 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:52.072512 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:15:52.070515 [info ] [Thread-4 (]: 6 of 36 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.27s]
[0m22:15:52.085514 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:15:52.077513 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m22:15:52.078515 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:15:52.083521 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964' to be skipped because of status 'fail'.  Reason: Got 5 results, configured to fail if != 0.
[0m22:15:52.073513 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:15:52.086516 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:15:52.089514 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m22:15:52.088517 [info ] [Thread-3 (]: 10 of 36 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m22:15:52.092512 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m22:15:52.093510 [info ] [Thread-4 (]: 11 of 36 START test source_not_null_staging_transactions_token ................. [RUN]
[0m22:15:52.096511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m22:15:52.095513 [info ] [Thread-1 (]: 7 of 36 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.25s]
[0m22:15:52.102515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:52.104511 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m22:15:52.105512 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:15:52.106510 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:15:52.107511 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:15:52.122513 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:15:52.123514 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:15:52.139512 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:15:52.141514 [info ] [Thread-1 (]: 12 of 36 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m22:15:52.142513 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:15:52.144513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m22:15:52.153513 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:15:52.154513 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:15:52.155512 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:15:52.165519 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:15:52.168514 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:15:52.177512 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:15:52.178513 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m22:15:52.183530 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:15:52.185514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:52.186517 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m22:15:52.187512 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:15:52.189511 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:52.191514 [debug] [Thread-2 (]: SQL status: BEGIN in 0.088 seconds
[0m22:15:52.202511 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:15:52.203512 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:15:52.205515 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m22:15:52.208513 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:15:52.209513 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:52.210512 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m22:15:52.215514 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m22:15:52.217528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.219514 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m22:15:52.221513 [error] [Thread-2 (]: 9 of 36 FAIL 15 source_not_null_staging_transactions_amount .................... [[31mFAIL 15[0m in 0.21s]
[0m22:15:52.223513 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:15:52.225512 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:15:52.226512 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_transactions_amount.a378a55704' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m22:15:52.227512 [info ] [Thread-2 (]: 13 of 36 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m22:15:52.230513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m22:15:52.234515 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:15:52.246513 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:15:52.253515 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:15:52.261514 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:15:52.266512 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:15:52.268513 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m22:15:52.269512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:52.303513 [debug] [Thread-3 (]: SQL status: BEGIN in 0.118 seconds
[0m22:15:52.305515 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:15:52.306513 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m22:15:52.307514 [debug] [Thread-4 (]: SQL status: BEGIN in 0.118 seconds
[0m22:15:52.309512 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:15:52.311513 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m22:15:52.312512 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:52.316517 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m22:15:52.317514 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:15:52.319514 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m22:15:52.322518 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m22:15:52.325512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m22:15:52.324512 [info ] [Thread-3 (]: 10 of 36 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.23s]
[0m22:15:52.329514 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:15:52.327511 [info ] [Thread-4 (]: 11 of 36 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.22s]
[0m22:15:52.332513 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:15:52.334514 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:15:52.337513 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:15:52.336513 [info ] [Thread-3 (]: 14 of 36 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m22:15:52.339512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m22:15:52.340517 [info ] [Thread-4 (]: 15 of 36 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m22:15:52.342526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m22:15:52.344513 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:15:52.345513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m22:15:52.350524 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:15:52.352515 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:15:52.362514 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:15:52.354512 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:15:52.370518 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:52.371512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m22:15:52.377512 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:15:52.380509 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m22:15:52.383573 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:15:52.385513 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:15:52.389511 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:15:52.389511 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m22:15:52.390510 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m22:15:52.390510 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:15:52.392512 [info ] [Thread-1 (]: 12 of 36 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.25s]
[0m22:15:52.394516 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:15:52.395514 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:52.405512 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:15:52.407511 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:15:52.408510 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m22:15:52.410511 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m22:15:52.411510 [debug] [Thread-1 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:15:52.413510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:52.418514 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m22:15:52.419511 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:15:52.419511 [info ] [Thread-1 (]: 16 of 36 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m22:15:52.421512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m22:15:52.424517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m22:15:52.422515 [info ] [Thread-2 (]: 13 of 36 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.19s]
[0m22:15:52.426515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:52.427516 [debug] [Thread-1 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:15:52.429514 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:15:52.445519 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:15:52.453526 [info ] [Thread-2 (]: 17 of 36 START test source_positive_value_staging_market_price ................. [RUN]
[0m22:15:52.455514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m22:15:52.457514 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:15:52.502511 [debug] [Thread-2 (]: Compilation Error in test source_positive_value_staging_market_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:52.503511 [debug] [Thread-1 (]: Compilation Error in test source_positive_value_staging_market_daily_volume (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:52.504513 [error] [Thread-2 (]: 17 of 36 ERROR source_positive_value_staging_market_price ...................... [[31mERROR[0m in 0.05s]
[0m22:15:52.507514 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:15:52.505511 [error] [Thread-1 (]: 16 of 36 ERROR source_positive_value_staging_market_daily_volume ............... [[31mERROR[0m in 0.08s]
[0m22:15:52.509510 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:15:52.510509 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_price.1ee4a4b889' to be skipped because of status 'error'.  Reason: Compilation Error in test source_positive_value_staging_market_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:15:52.512510 [info ] [Thread-2 (]: 18 of 36 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m22:15:52.511511 [debug] [Thread-1 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:15:52.518515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m22:15:52.519514 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:15:52.520511 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd' to be skipped because of status 'error'.  Reason: Compilation Error in test source_positive_value_staging_market_daily_volume (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:15:52.521511 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:15:52.523512 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m22:15:52.524515 [info ] [Thread-1 (]: 19 of 36 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m22:15:52.539514 [debug] [Thread-4 (]: SQL status: BEGIN in 0.113 seconds
[0m22:15:52.539514 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:15:52.541510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m22:15:52.542511 [debug] [Thread-2 (]: Compilation Error in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:52.542511 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:15:52.543509 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m22:15:52.543509 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:15:52.545513 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m22:15:52.544510 [error] [Thread-2 (]: 18 of 36 ERROR source_positive_value_staging_transactions_amount ............... [[31mERROR[0m in 0.03s]
[0m22:15:52.552531 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:15:52.559508 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:15:52.561513 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:15:52.562512 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:52.564514 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m22:15:52.570516 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:15:52.571512 [debug] [Thread-1 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:15:52.571512 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8' to be skipped because of status 'error'.  Reason: Compilation Error in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:15:52.574512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m22:15:52.576514 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m22:15:52.577512 [info ] [Thread-2 (]: 20 of 36 START test source_unique_staging_users_user_id ........................ [RUN]
[0m22:15:52.587523 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:15:52.589518 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m22:15:52.592516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m22:15:52.590515 [info ] [Thread-3 (]: 14 of 36 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.25s]
[0m22:15:52.594527 [info ] [Thread-4 (]: 15 of 36 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.25s]
[0m22:15:52.598519 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:15:52.602512 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:15:52.604514 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:15:52.606513 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:15:52.617514 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:15:52.618521 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m22:15:52.619512 [debug] [Thread-3 (]: Began running node model.growth.stg_referrals
[0m22:15:52.620513 [debug] [Thread-4 (]: Began running node model.growth.stg_market
[0m22:15:52.622512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.624518 [debug] [Thread-2 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:15:52.623515 [info ] [Thread-3 (]: 21 of 36 SKIP relation public.stg_referrals .................................... [[33mSKIP[0m]
[0m22:15:52.626511 [info ] [Thread-4 (]: 22 of 36 SKIP relation public.stg_market ....................................... [[33mSKIP[0m]
[0m22:15:52.638522 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:15:52.639513 [debug] [Thread-3 (]: Finished running node model.growth.stg_referrals
[0m22:15:52.641513 [debug] [Thread-4 (]: Finished running node model.growth.stg_market
[0m22:15:52.643516 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_referrals' to be skipped because of status 'skipped'. 
[0m22:15:52.645511 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_market' to be skipped because of status 'skipped'. 
[0m22:15:52.646511 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:15:52.656514 [debug] [Thread-3 (]: Began running node model.growth.dim_referrals
[0m22:15:52.658518 [debug] [Thread-4 (]: Began running node model.growth.dim_market
[0m22:15:52.659512 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m22:15:52.661515 [info ] [Thread-3 (]: 23 of 36 SKIP relation public.dim_referrals .................................... [[33mSKIP[0m]
[0m22:15:52.662514 [info ] [Thread-4 (]: 24 of 36 SKIP relation public.dim_market ....................................... [[33mSKIP[0m]
[0m22:15:52.668512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:52.671515 [debug] [Thread-3 (]: Finished running node model.growth.dim_referrals
[0m22:15:52.672514 [debug] [Thread-4 (]: Finished running node model.growth.dim_market
[0m22:15:52.674513 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_referrals' to be skipped because of status 'skipped'. 
[0m22:15:52.675513 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_market' to be skipped because of status 'skipped'. 
[0m22:15:52.722513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m22:15:52.724510 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:15:52.725516 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:52.729512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:52.734512 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m22:15:52.735514 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m22:15:52.737515 [error] [Thread-1 (]: 19 of 36 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.20s]
[0m22:15:52.740521 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:15:52.742516 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' to be skipped because of status 'fail'.  Reason: Got 10 results, configured to fail if != 0.
[0m22:15:52.743512 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m22:15:52.744512 [info ] [Thread-3 (]: 25 of 36 SKIP relation public.stg_transactions ................................. [[33mSKIP[0m]
[0m22:15:52.746511 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m22:15:52.751517 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_transactions' to be skipped because of status 'skipped'. 
[0m22:15:52.754514 [debug] [Thread-1 (]: Began running node model.growth.dim_transactions
[0m22:15:52.754514 [debug] [Thread-4 (]: Began running node model.growth.mart_daily_transactions
[0m22:15:52.755512 [debug] [Thread-3 (]: Began running node model.growth.mart_transaction_summary
[0m22:15:52.756512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.088 seconds
[0m22:15:52.757515 [info ] [Thread-1 (]: 26 of 36 SKIP relation public.dim_transactions ................................. [[33mSKIP[0m]
[0m22:15:52.758510 [info ] [Thread-4 (]: 27 of 36 SKIP relation public.mart_daily_transactions .......................... [[33mSKIP[0m]
[0m22:15:52.759511 [info ] [Thread-3 (]: 28 of 36 SKIP relation public.mart_transaction_summary ......................... [[33mSKIP[0m]
[0m22:15:52.760515 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:15:52.762510 [debug] [Thread-1 (]: Finished running node model.growth.dim_transactions
[0m22:15:52.763513 [debug] [Thread-4 (]: Finished running node model.growth.mart_daily_transactions
[0m22:15:52.766515 [debug] [Thread-3 (]: Finished running node model.growth.mart_transaction_summary
[0m22:15:52.768513 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:52.769513 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_transactions' to be skipped because of status 'skipped'. 
[0m22:15:52.771511 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'skipped'. 
[0m22:15:52.773512 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_transactions
[0m22:15:52.774511 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:52.774511 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_transaction_summary' to be skipped because of status 'skipped'. 
[0m22:15:52.775510 [info ] [Thread-1 (]: 29 of 36 SKIP relation public.int_enriched_transactions ........................ [[33mSKIP[0m]
[0m22:15:52.778511 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m22:15:52.779511 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_transactions
[0m22:15:52.780511 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m22:15:52.783515 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_transactions' to be skipped because of status 'skipped'. 
[0m22:15:52.786513 [info ] [Thread-2 (]: 20 of 36 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.19s]
[0m22:15:52.788513 [debug] [Thread-3 (]: Began running node model.growth.fct_token_metrics
[0m22:15:52.790513 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:15:52.791513 [info ] [Thread-3 (]: 30 of 36 SKIP relation public.fct_token_metrics ................................ [[33mSKIP[0m]
[0m22:15:52.793513 [debug] [Thread-1 (]: Began running node model.growth.stg_users
[0m22:15:52.794514 [debug] [Thread-3 (]: Finished running node model.growth.fct_token_metrics
[0m22:15:52.796512 [info ] [Thread-1 (]: 31 of 36 START sql view model public.stg_users ................................. [RUN]
[0m22:15:52.801514 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_token_metrics' to be skipped because of status 'skipped'. 
[0m22:15:52.804513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1, now model.growth.stg_users)
[0m22:15:52.805513 [debug] [Thread-1 (]: Began compiling node model.growth.stg_users
[0m22:15:52.815517 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_users"
[0m22:15:52.819517 [debug] [Thread-1 (]: Began executing node model.growth.stg_users
[0m22:15:52.889513 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_users"
[0m22:15:52.891514 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:52.892514 [debug] [Thread-1 (]: On model.growth.stg_users: BEGIN
[0m22:15:52.893515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.952512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m22:15:52.953511 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:52.954515 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."public"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m22:15:52.961512 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:15:52.974520 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:52.975516 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m22:15:52.976512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:15:52.983515 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:52.984512 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:15:52.986514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:53.013512 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m22:15:53.015515 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:53.017512 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m22:15:53.018515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:15:53.034512 [debug] [Thread-1 (]: Applying DROP to: "nca"."public"."stg_users__dbt_backup"
[0m22:15:53.042512 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:15:53.043517 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."public"."stg_users__dbt_backup" cascade
[0m22:15:53.049517 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:15:53.052523 [debug] [Thread-1 (]: On model.growth.stg_users: Close
[0m22:15:53.057513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD58E1510>]}
[0m22:15:53.058512 [info ] [Thread-1 (]: 31 of 36 OK created sql view model public.stg_users ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:15:53.060511 [debug] [Thread-1 (]: Finished running node model.growth.stg_users
[0m22:15:53.062511 [debug] [Thread-2 (]: Began running node model.growth.dim_users
[0m22:15:53.063514 [debug] [Thread-4 (]: Began running node model.growth.fct_users_acquisition
[0m22:15:53.064513 [info ] [Thread-2 (]: 32 of 36 START sql view model public.dim_users ................................. [RUN]
[0m22:15:53.069514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_users_user_id.a057d0d5ff, now model.growth.dim_users)
[0m22:15:53.068516 [info ] [Thread-4 (]: 33 of 36 SKIP relation public.fct_users_acquisition ............................ [[33mSKIP[0m]
[0m22:15:53.071513 [debug] [Thread-2 (]: Began compiling node model.growth.dim_users
[0m22:15:53.073513 [debug] [Thread-4 (]: Finished running node model.growth.fct_users_acquisition
[0m22:15:53.084554 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_users"
[0m22:15:53.086528 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'skipped'. 
[0m22:15:53.088512 [debug] [Thread-2 (]: Began executing node model.growth.dim_users
[0m22:15:53.103521 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_users"
[0m22:15:53.105514 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:15:53.106513 [debug] [Thread-2 (]: On model.growth.dim_users: BEGIN
[0m22:15:53.107512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:53.168511 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m22:15:53.169512 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:15:53.170512 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."public"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."public"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m22:15:53.176514 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:15:53.184513 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:15:53.185513 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m22:15:53.186515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:15:53.188513 [debug] [Thread-2 (]: On model.growth.dim_users: COMMIT
[0m22:15:53.189511 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:15:53.190514 [debug] [Thread-2 (]: On model.growth.dim_users: COMMIT
[0m22:15:53.192513 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:15:53.199519 [debug] [Thread-2 (]: Applying DROP to: "nca"."public"."dim_users__dbt_backup"
[0m22:15:53.201511 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:15:53.202508 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."public"."dim_users__dbt_backup" cascade
[0m22:15:53.204513 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:53.207512 [debug] [Thread-2 (]: On model.growth.dim_users: Close
[0m22:15:53.209513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe482a4-5564-42b5-9e9d-c1b7d53368c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7BA9C90>]}
[0m22:15:53.211514 [info ] [Thread-2 (]: 32 of 36 OK created sql view model public.dim_users ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:15:53.213512 [debug] [Thread-2 (]: Finished running node model.growth.dim_users
[0m22:15:53.217512 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m22:15:53.218520 [info ] [Thread-1 (]: 34 of 36 SKIP relation public.int_enriched_users ............................... [[33mSKIP[0m]
[0m22:15:53.221515 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m22:15:53.222513 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_users' to be skipped because of status 'skipped'. 
[0m22:15:53.225528 [debug] [Thread-4 (]: Began running node model.growth.fct_referral_metrics
[0m22:15:53.226517 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m22:15:53.228514 [info ] [Thread-4 (]: 35 of 36 SKIP relation public.fct_referral_metrics ............................. [[33mSKIP[0m]
[0m22:15:53.229512 [info ] [Thread-2 (]: 36 of 36 SKIP relation public.fct_user_metrics ................................. [[33mSKIP[0m]
[0m22:15:53.236514 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m22:15:53.234549 [debug] [Thread-4 (]: Finished running node model.growth.fct_referral_metrics
[0m22:15:53.239513 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_metrics' to be skipped because of status 'skipped'. 
[0m22:15:53.240514 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referral_metrics' to be skipped because of status 'skipped'. 
[0m22:15:53.243521 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:53.244510 [debug] [MainThread]: On master: BEGIN
[0m22:15:53.245513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:53.313511 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m22:15:53.314515 [debug] [MainThread]: On master: COMMIT
[0m22:15:53.316520 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:53.317513 [debug] [MainThread]: On master: COMMIT
[0m22:15:53.319512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:53.320512 [debug] [MainThread]: On master: Close
[0m22:15:53.321513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:53.322513 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m22:15:53.323513 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m22:15:53.324513 [debug] [MainThread]: Connection 'model.growth.stg_users' was properly closed.
[0m22:15:53.325513 [debug] [MainThread]: Connection 'model.growth.dim_users' was properly closed.
[0m22:15:53.326512 [debug] [MainThread]: Connection 'test.growth.source_not_null_staging_users_signup_date.99252fe0aa' was properly closed.
[0m22:15:53.327511 [debug] [MainThread]: Connection 'test.growth.source_not_null_staging_users_user_id.8a5fff93d9' was properly closed.
[0m22:15:53.328512 [info ] [MainThread]: 
[0m22:15:53.329514 [info ] [MainThread]: Finished running 6 table models, 20 data tests, 10 view models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m22:15:53.341510 [debug] [MainThread]: Command end result
[0m22:15:53.410511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:15:53.414101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:15:53.430841 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:15:53.433340 [info ] [MainThread]: 
[0m22:15:53.434949 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m22:15:53.436536 [info ] [MainThread]: 
[0m22:15:53.438357 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m22:15:53.439415 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:15:53.441427 [info ] [MainThread]: 
[0m22:15:53.443736 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m22:15:53.444750 [info ] [MainThread]: 
[0m22:15:53.446754 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m22:15:53.454159 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m22:15:53.456138 [info ] [MainThread]: 
[0m22:15:53.457189 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m22:15:53.458953 [info ] [MainThread]: 
[0m22:15:53.460408 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:15:53.461998 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:15:53.463134 [info ] [MainThread]: 
[0m22:15:53.468299 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m22:15:53.472450 [info ] [MainThread]: 
[0m22:15:53.473972 [error] [MainThread]:   Compilation Error in test source_positive_value_staging_market_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:53.474972 [info ] [MainThread]: 
[0m22:15:53.475972 [error] [MainThread]:   Compilation Error in test source_positive_value_staging_market_daily_volume (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:53.477975 [info ] [MainThread]: 
[0m22:15:53.478973 [error] [MainThread]:   Compilation Error in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:53.479971 [info ] [MainThread]: 
[0m22:15:53.487902 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m22:15:53.489742 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m22:15:53.490802 [info ] [MainThread]: 
[0m22:15:53.492583 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m22:15:53.494615 [info ] [MainThread]: 
[0m22:15:53.495650 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=7 SKIP=14 TOTAL=36
[0m22:15:53.500296 [debug] [MainThread]: Command `dbt build` failed at 22:15:53.497760 after 4.19 seconds
[0m22:15:53.505578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD563D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD7D02890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD6FFB4C0>]}
[0m22:15:53.506086 [debug] [MainThread]: Flushing usage events
[0m22:15:55.770480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:14.236127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DDE60D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE04B9600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE04B9420>]}


============================== 22:30:14.244328 | aaf935c2-959b-4e2a-a077-f4b2e2a6f4a4 ==============================
[0m22:30:14.244328 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:30:14.246355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:14.581188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaf935c2-959b-4e2a-a077-f4b2e2a6f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DDD5E36A0>]}
[0m22:30:14.772493 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-snwwdn7a'
[0m22:30:14.773495 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:30:16.005799 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:30:16.008881 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:30:16.641791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:30:16.683786 [info ] [MainThread]: Updating lock file in file path: C:\Users\musta\Documents\GrowthMetrics/package-lock.yml
[0m22:30:16.688793 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-ve8noc6k'
[0m22:30:16.693781 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:30:20.941402 [info ] [MainThread]: Installed from version 1.1.1
[0m22:30:20.943401 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:30:20.945522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aaf935c2-959b-4e2a-a077-f4b2e2a6f4a4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE04F2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DDE8AEA70>]}
[0m22:30:20.947409 [info ] [MainThread]: 
[0m22:30:20.949401 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:30:20.955503 [debug] [MainThread]: Command `dbt deps` succeeded at 22:30:20.955404 after 6.91 seconds
[0m22:30:20.957402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DDE60D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE04F2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE0610E20>]}
[0m22:30:20.958403 [debug] [MainThread]: Flushing usage events
[0m22:30:22.375845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:41.235570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88D49D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F351780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F351570>]}


============================== 22:30:41.241461 | 89372461-4962-46c1-ad1c-2c99d90e77ee ==============================
[0m22:30:41.241461 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:30:41.243464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:41.649643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F4750C0>]}
[0m22:30:41.743680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88EE0B940>]}
[0m22:30:41.747135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:42.416057 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:30:42.681492 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:30:42.683457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88EE40970>]}
[0m22:30:45.951716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.marts
- models.growth_metrics.intermediate
[0m22:30:45.995717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C890EF5AE0>]}
[0m22:30:46.313395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:30:46.322059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:30:46.414723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C890ED92A0>]}
[0m22:30:46.416722 [info ] [MainThread]: Found 16 models, 32 data tests, 4 sources, 546 macros
[0m22:30:46.419720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C890EE3C70>]}
[0m22:30:46.436733 [info ] [MainThread]: 
[0m22:30:46.440712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:46.445554 [info ] [MainThread]: 
[0m22:30:46.448682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:30:46.470988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m22:30:46.764240 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:30:46.765242 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m22:30:46.767240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:46.860247 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m22:30:46.861247 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:30:46.862242 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:30:46.879241 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.015 seconds
[0m22:30:46.881241 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m22:30:46.883529 [debug] [ThreadPool]: On list_nca_public: Close
[0m22:30:46.905240 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:46.906460 [debug] [MainThread]: On master: BEGIN
[0m22:30:46.908245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:46.982241 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:30:46.984250 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:46.986242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:30:47.007683 [debug] [MainThread]: SQL status: SELECT 10 in 0.020 seconds
[0m22:30:47.017244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89372461-4962-46c1-ad1c-2c99d90e77ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88BB03C70>]}
[0m22:30:47.019298 [debug] [MainThread]: On master: ROLLBACK
[0m22:30:47.021243 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:47.022240 [debug] [MainThread]: On master: BEGIN
[0m22:30:47.025836 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:30:47.027245 [debug] [MainThread]: On master: COMMIT
[0m22:30:47.029473 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:47.031430 [debug] [MainThread]: On master: COMMIT
[0m22:30:47.032244 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:30:47.034243 [debug] [MainThread]: On master: Close
[0m22:30:47.046243 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef
[0m22:30:47.048244 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262
[0m22:30:47.050242 [debug] [Thread-3 (]: Began running node test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090
[0m22:30:47.051241 [debug] [Thread-4 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:30:47.052639 [info ] [Thread-1 (]: 1 of 32 START test dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01  [RUN]
[0m22:30:47.054242 [info ] [Thread-2 (]: 2 of 32 START test dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01  [RUN]
[0m22:30:47.056241 [info ] [Thread-3 (]: 3 of 32 START test dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id  [RUN]
[0m22:30:47.060243 [info ] [Thread-4 (]: 4 of 32 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m22:30:47.063244 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef'
[0m22:30:47.064480 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262'
[0m22:30:47.066243 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090'
[0m22:30:47.068242 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m22:30:47.070241 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef
[0m22:30:47.071322 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262
[0m22:30:47.073244 [debug] [Thread-3 (]: Began compiling node test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090
[0m22:30:47.075247 [debug] [Thread-4 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:30:47.142243 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:30:47.149245 [debug] [Thread-4 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:30:47.196254 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:30:47.202368 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:30:47.205444 [debug] [Thread-4 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m22:30:47.208244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:30:47.214243 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:47.218371 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:47.220243 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id (models\staging\schema.yml)
  'dict object' has no attribute 'test_not_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:47.222240 [error] [Thread-1 (]: 1 of 32 ERROR dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01  [[31mERROR[0m in 0.16s]
[0m22:30:47.225242 [error] [Thread-2 (]: 2 of 32 ERROR dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01  [[31mERROR[0m in 0.16s]
[0m22:30:47.230247 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef
[0m22:30:47.228242 [error] [Thread-3 (]: 3 of 32 ERROR dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id  [[31mERROR[0m in 0.16s]
[0m22:30:47.234243 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262
[0m22:30:47.237245 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:30:47.240053 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:30:47.243513 [debug] [Thread-3 (]: Finished running node test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090
[0m22:30:47.246244 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:30:47.248242 [info ] [Thread-1 (]: 5 of 32 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m22:30:47.251242 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:30:47.254241 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:30:47.255564 [info ] [Thread-2 (]: 6 of 32 START test source_not_null_staging_market_date ......................... [RUN]
[0m22:30:47.258244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01.b7aa4e08ef, now test.growth.source_not_null_staging_market_daily_volume.4634ac9f20)
[0m22:30:47.260247 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id (models\staging\schema.yml)
  'dict object' has no attribute 'test_not_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:30:47.263247 [info ] [Thread-3 (]: 7 of 32 START test source_not_null_staging_market_price ........................ [RUN]
[0m22:30:47.266242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01.556929a262, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m22:30:47.268450 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:30:47.270553 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id.6e6df26090, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m22:30:47.272562 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:30:47.305248 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:30:47.307243 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:30:47.321238 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:30:47.325245 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:30:47.327260 [debug] [Thread-4 (]: SQL status: BEGIN in 0.119 seconds
[0m22:30:47.335243 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:30:47.344240 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:30:47.345634 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:30:47.347240 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:30:47.349241 [debug] [Thread-4 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m22:30:47.351242 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:30:47.353251 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:30:47.358240 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:30:47.364548 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:30:47.365644 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m22:30:47.366242 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:30:47.370295 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:30:47.371321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:30:47.372372 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:30:47.379241 [debug] [Thread-4 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m22:30:47.380242 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m22:30:47.383242 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m22:30:47.385242 [debug] [Thread-4 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m22:30:47.388241 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:30:47.390242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:30:47.393243 [info ] [Thread-4 (]: 4 of 32 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.33s]
[0m22:30:47.397244 [debug] [Thread-4 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:30:47.399241 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:30:47.402245 [info ] [Thread-4 (]: 8 of 32 START test source_not_null_staging_market_token ........................ [RUN]
[0m22:30:47.405242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m22:30:47.411245 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:30:47.428405 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:30:47.448244 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:30:47.461245 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:30:47.464325 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:30:47.466384 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m22:30:47.468242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:47.540242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m22:30:47.541446 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:30:47.543241 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m22:30:47.547242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:30:47.552244 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m22:30:47.553242 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m22:30:47.555244 [debug] [Thread-3 (]: SQL status: BEGIN in 0.165 seconds
[0m22:30:47.558503 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:30:47.557242 [info ] [Thread-1 (]: 5 of 32 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.30s]
[0m22:30:47.560997 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m22:30:47.563243 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:30:47.565243 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:30:47.567243 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:47.566526 [info ] [Thread-1 (]: 9 of 32 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m22:30:47.573250 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m22:30:47.576245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m22:30:47.577248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.189 seconds
[0m22:30:47.579242 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m22:30:47.580774 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:30:47.582489 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:30:47.599528 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:30:47.585241 [error] [Thread-3 (]: 7 of 32 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.31s]
[0m22:30:47.602432 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m22:30:47.605925 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:30:47.607242 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:30:47.610242 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:30:47.611507 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:30:47.636248 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:30:47.638245 [debug] [Thread-4 (]: SQL status: BEGIN in 0.170 seconds
[0m22:30:47.640242 [info ] [Thread-3 (]: 10 of 32 START test source_not_null_staging_referrals_referred_user_id ......... [RUN]
[0m22:30:47.649241 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m22:30:47.652245 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:30:47.654256 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:30:47.655241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m22:30:47.658240 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m22:30:47.660247 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m22:30:47.663239 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m22:30:47.665242 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:30:47.668703 [info ] [Thread-2 (]: 6 of 32 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.40s]
[0m22:30:47.671242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:47.672242 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:47.688244 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:30:47.689242 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:30:47.696249 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m22:30:47.699243 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:30:47.702244 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:30:47.703746 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m22:30:47.717241 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:30:47.705242 [info ] [Thread-2 (]: 11 of 32 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m22:30:47.722242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m22:30:47.724745 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:30:47.746247 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:30:47.747243 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:30:47.720241 [info ] [Thread-4 (]: 8 of 32 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.31s]
[0m22:30:47.749249 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m22:30:47.752301 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:30:47.754241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:47.756095 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:30:47.757443 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:30:47.775242 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:30:47.781346 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:30:47.783573 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m22:30:47.785242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:47.778242 [info ] [Thread-4 (]: 12 of 32 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m22:30:47.797330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m22:30:47.798244 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:30:47.817244 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:30:47.820242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m22:30:47.823244 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:30:47.826245 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m22:30:47.831244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:47.832394 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:30:47.837595 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m22:30:47.848244 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:30:47.850408 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m22:30:47.854242 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:30:47.857249 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m22:30:47.859244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:47.856242 [info ] [Thread-1 (]: 9 of 32 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.28s]
[0m22:30:47.876241 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:30:47.878243 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:30:47.962248 [debug] [Thread-3 (]: SQL status: BEGIN in 0.208 seconds
[0m22:30:47.964245 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:30:47.965245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.180 seconds
[0m22:30:47.967243 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m22:30:47.969243 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:30:47.971246 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m22:30:47.973253 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:30:47.978248 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m22:30:47.979243 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:30:47.981242 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m22:30:47.985244 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m22:30:47.989240 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m22:30:47.880240 [info ] [Thread-1 (]: 13 of 32 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m22:30:48.039241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m22:30:48.041242 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:30:47.988248 [info ] [Thread-3 (]: 10 of 32 PASS source_not_null_staging_referrals_referred_user_id ............... [[32mPASS[0m in 0.33s]
[0m22:30:48.076243 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:30:48.078241 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:30:48.083244 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:30:47.992245 [error] [Thread-2 (]: 11 of 32 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.27s]
[0m22:30:48.094258 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:30:48.096304 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:30:48.098241 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:30:48.109243 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:30:48.080242 [info ] [Thread-3 (]: 14 of 32 START test source_not_null_staging_transactions_token ................. [RUN]
[0m22:30:48.117242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m22:30:48.120243 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:30:48.122298 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:30:48.112495 [info ] [Thread-2 (]: 15 of 32 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m22:30:48.124499 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m22:30:48.141242 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:30:48.145247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m22:30:48.148244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:48.150241 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:30:48.153243 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:30:48.172242 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:30:48.198244 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:30:48.203249 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:30:48.205246 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m22:30:48.207244 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:48.209241 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:30:48.218243 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:30:48.221241 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:30:48.223035 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m22:30:48.224474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:48.232607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.373 seconds
[0m22:30:48.234585 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:30:48.236252 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m22:30:48.241243 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:30:48.246242 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m22:30:48.248241 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m22:30:48.250241 [error] [Thread-4 (]: 12 of 32 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.45s]
[0m22:30:48.254496 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:30:48.256240 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:30:48.258411 [info ] [Thread-4 (]: 16 of 32 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m22:30:48.286243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m22:30:48.288244 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:30:48.315513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.167 seconds
[0m22:30:48.333241 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:30:48.335243 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m22:30:48.331243 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:30:48.339240 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:30:48.345244 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m22:30:48.347244 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:30:48.348242 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m22:30:48.366237 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:30:48.372242 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:30:48.373241 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m22:30:48.369243 [info ] [Thread-1 (]: 13 of 32 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.33s]
[0m22:30:48.376241 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:48.378692 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:30:48.381246 [debug] [Thread-2 (]: SQL status: BEGIN in 0.157 seconds
[0m22:30:48.383245 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:30:48.385448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.178 seconds
[0m22:30:48.387241 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:30:48.391247 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:30:48.394241 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:30:48.389244 [info ] [Thread-1 (]: 17 of 32 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m22:30:48.397244 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m22:30:48.400906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m22:30:48.402241 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:48.404243 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:30:48.406242 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:48.410245 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m22:30:48.431248 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:30:48.439242 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m22:30:48.441308 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m22:30:48.447245 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m22:30:48.449243 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:30:48.451254 [info ] [Thread-2 (]: 15 of 32 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.31s]
[0m22:30:48.454922 [info ] [Thread-3 (]: 14 of 32 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.34s]
[0m22:30:48.467247 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:30:48.470247 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:30:48.473243 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:30:48.476242 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:30:48.478244 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:30:48.482246 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:30:48.480243 [info ] [Thread-2 (]: 18 of 32 START test source_not_null_staging_users_country ...................... [RUN]
[0m22:30:48.484528 [info ] [Thread-3 (]: 19 of 32 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m22:30:48.487242 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m22:30:48.489243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m22:30:48.491258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m22:30:48.494435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:48.496243 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:30:48.499268 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:30:48.516248 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:30:48.542244 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:30:48.552246 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:30:48.554244 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:30:48.558334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.182 seconds
[0m22:30:48.561243 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:30:48.562241 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:30:48.564241 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:30:48.565590 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m22:30:48.567531 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m22:30:48.577246 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:30:48.579245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:48.581243 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:48.584241 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:30:48.589200 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m22:30:48.590328 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m22:30:48.593481 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m22:30:48.595242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:48.598244 [info ] [Thread-4 (]: 16 of 32 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.31s]
[0m22:30:48.601293 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:30:48.603218 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:30:48.605255 [info ] [Thread-4 (]: 20 of 32 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m22:30:48.607526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m22:30:48.610242 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:30:48.624982 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:30:48.629285 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:30:48.654670 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:30:48.656241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m22:30:48.658242 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:30:48.660246 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m22:30:48.665246 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:48.671246 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m22:30:48.672246 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:30:48.674242 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m22:30:48.676243 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m22:30:48.681244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:48.679248 [info ] [Thread-1 (]: 17 of 32 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.28s]
[0m22:30:48.685243 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:30:48.687241 [debug] [Thread-1 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:30:48.689249 [info ] [Thread-1 (]: 21 of 32 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m22:30:48.693244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m22:30:48.696247 [debug] [Thread-1 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:30:48.712246 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:30:48.741244 [debug] [Thread-1 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:30:48.755766 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:30:48.760241 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:30:48.761246 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m22:30:48.763249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:48.772625 [debug] [Thread-2 (]: SQL status: BEGIN in 0.193 seconds
[0m22:30:48.774240 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:30:48.776241 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m22:30:48.781241 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:48.786241 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m22:30:48.788431 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m22:30:48.790747 [info ] [Thread-2 (]: 18 of 32 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.30s]
[0m22:30:48.794241 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:30:48.796242 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:30:48.804328 [debug] [Thread-3 (]: SQL status: BEGIN in 0.209 seconds
[0m22:30:48.806404 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:30:48.798241 [info ] [Thread-2 (]: 22 of 32 START test source_positive_value_staging_market_price ................. [RUN]
[0m22:30:48.808615 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m22:30:48.810206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m22:30:48.814244 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:30:48.816322 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:30:48.832247 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:30:48.838245 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m22:30:48.841243 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m22:30:48.843242 [debug] [Thread-2 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:30:48.855244 [info ] [Thread-3 (]: 19 of 32 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.36s]
[0m22:30:48.869025 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:30:48.871243 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:30:48.873516 [debug] [Thread-3 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:30:48.878244 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:30:48.876241 [info ] [Thread-3 (]: 23 of 32 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m22:30:48.880248 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m22:30:48.882398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m22:30:48.884247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:48.887184 [debug] [Thread-3 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:30:48.905325 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:30:48.907241 [debug] [Thread-4 (]: SQL status: BEGIN in 0.226 seconds
[0m22:30:48.909240 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:30:48.911242 [debug] [Thread-3 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:30:48.913243 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m22:30:49.045373 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:30:49.046747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.284 seconds
[0m22:30:49.048635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.164 seconds
[0m22:30:49.050751 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:30:49.052748 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:30:49.054258 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:30:49.056093 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:30:49.057567 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:30:49.062580 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m22:30:49.065075 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:30:49.066327 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m22:30:49.069351 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m22:30:49.071612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:49.072850 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:30:49.074390 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:30:49.076683 [info ] [Thread-4 (]: 20 of 32 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.47s]
[0m22:30:49.081681 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m22:30:49.086681 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m22:30:49.089079 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:30:49.091749 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m22:30:49.093245 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m22:30:49.095682 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:30:49.098685 [error] [Thread-2 (]: 22 of 32 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.29s]
[0m22:30:49.103126 [info ] [Thread-1 (]: 21 of 32 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.41s]
[0m22:30:49.110691 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:30:49.106959 [info ] [Thread-4 (]: 24 of 32 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m22:30:49.115695 [debug] [Thread-1 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:30:49.118691 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:30:49.120825 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m22:30:49.122548 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:30:49.127352 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:30:49.124349 [info ] [Thread-2 (]: 25 of 32 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m22:30:49.131355 [info ] [Thread-1 (]: 26 of 32 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m22:30:49.151228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m22:30:49.160987 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:30:49.154987 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:30:49.158984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m22:30:49.184989 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:30:49.186984 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:30:49.181992 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:30:49.204997 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:30:49.214021 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:30:49.217326 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m22:30:49.220464 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:30:49.222016 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:30:49.224528 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:30:49.226340 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:30:49.236575 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:30:49.249562 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:30:49.251863 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:30:49.253827 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m22:30:49.257425 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:30:49.259371 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:49.261566 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:30:49.262820 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:30:49.264244 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m22:30:49.269948 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m22:30:49.271939 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m22:30:49.274037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:49.275614 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m22:30:49.277480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:49.282480 [error] [Thread-3 (]: 23 of 32 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.40s]
[0m22:30:49.285481 [debug] [Thread-3 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:30:49.287485 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:30:49.289482 [info ] [Thread-3 (]: 27 of 32 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m22:30:49.292482 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m22:30:49.294484 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:30:49.316332 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:30:49.373085 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:30:49.383088 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:30:49.387087 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:30:49.389084 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m22:30:49.391087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:49.433084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m22:30:49.434086 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:30:49.436191 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:30:49.439085 [debug] [Thread-2 (]: SQL status: BEGIN in 0.165 seconds
[0m22:30:49.441084 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:30:49.443085 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:30:49.445084 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:30:49.450085 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m22:30:49.452083 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:30:49.454092 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m22:30:49.458086 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m22:30:49.460451 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m22:30:49.463451 [info ] [Thread-1 (]: 26 of 32 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.30s]
[0m22:30:49.467860 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:30:49.464453 [info ] [Thread-2 (]: 25 of 32 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.31s]
[0m22:30:49.469597 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_market_token__date__token.8e27692bc8
[0m22:30:49.472451 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:30:49.473672 [info ] [Thread-1 (]: 28 of 32 START test source_unique_staging_market_token__date__token ............ [RUN]
[0m22:30:49.477453 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f
[0m22:30:49.479700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be, now test.growth.source_unique_staging_market_token__date__token.8e27692bc8)
[0m22:30:49.480451 [debug] [Thread-4 (]: SQL status: BEGIN in 0.221 seconds
[0m22:30:49.485451 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_market_token__date__token.8e27692bc8
[0m22:30:49.482452 [info ] [Thread-2 (]: 29 of 32 START test source_unique_staging_referrals_referred_user_id ........... [RUN]
[0m22:30:49.487452 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:30:49.498992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e, now test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f)
[0m22:30:49.536017 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:30:49.538176 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f
[0m22:30:49.555273 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m22:30:49.556273 [debug] [Thread-3 (]: SQL status: BEGIN in 0.166 seconds
[0m22:30:49.559276 [debug] [Thread-1 (]: Compilation Error in test source_unique_staging_market_token__date__token (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'
[0m22:30:49.564279 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m22:30:49.567279 [debug] [Thread-2 (]: Compilation Error in test source_unique_staging_referrals_referred_user_id (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'
[0m22:30:49.568553 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:30:49.570274 [error] [Thread-1 (]: 28 of 32 ERROR source_unique_staging_market_token__date__token ................. [[31mERROR[0m in 0.09s]
[0m22:30:49.573276 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m22:30:49.575280 [error] [Thread-2 (]: 29 of 32 ERROR source_unique_staging_referrals_referred_user_id ................ [[31mERROR[0m in 0.08s]
[0m22:30:49.578275 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:30:49.581279 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_market_token__date__token.8e27692bc8
[0m22:30:49.587277 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f
[0m22:30:49.585285 [info ] [Thread-4 (]: 24 of 32 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.46s]
[0m22:30:49.590446 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:30:49.592276 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_market_token__date__token.8e27692bc8' to be skipped because of status 'error'.  Reason: Compilation Error in test source_unique_staging_market_token__date__token (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'.
[0m22:30:49.594278 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_users_referral_code__False.282a80bb46
[0m22:30:49.596635 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:30:49.599277 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:30:49.603277 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_unique_staging_referrals_referred_user_id (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'.
[0m22:30:49.601396 [info ] [Thread-1 (]: 30 of 32 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m22:30:49.607455 [info ] [Thread-2 (]: 31 of 32 START test source_unique_staging_users_referral_code__False ........... [RUN]
[0m22:30:49.613282 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m22:30:49.615535 [debug] [Thread-4 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:30:49.619275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_market_token__date__token.8e27692bc8, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m22:30:49.627276 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:30:49.623391 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m22:30:49.625276 [info ] [Thread-4 (]: 32 of 32 START test source_unique_staging_users_user_id ........................ [RUN]
[0m22:30:49.621276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_referrals_referred_user_id.7bda6dad3f, now test.growth.source_unique_staging_users_referral_code__False.282a80bb46)
[0m22:30:49.651276 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:30:49.653281 [info ] [Thread-3 (]: 27 of 32 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.36s]
[0m22:30:49.661277 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:30:49.655277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m22:30:49.657363 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_users_referral_code__False.282a80bb46
[0m22:30:49.665549 [debug] [Thread-1 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:30:49.668967 [debug] [Thread-4 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:30:49.698275 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:30:49.712787 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:30:49.716275 [debug] [Thread-2 (]: Compilation Error in test source_unique_staging_users_referral_code__False (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'nulls_equal'
[0m22:30:49.718275 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:30:49.722425 [debug] [Thread-4 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:30:49.720277 [error] [Thread-2 (]: 31 of 32 ERROR source_unique_staging_users_referral_code__False ................ [[31mERROR[0m in 0.10s]
[0m22:30:49.724274 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m22:30:49.734275 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:30:49.736291 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_users_referral_code__False.282a80bb46
[0m22:30:49.738225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:49.741278 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_users_referral_code__False.282a80bb46' to be skipped because of status 'error'.  Reason: Compilation Error in test source_unique_staging_users_referral_code__False (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'nulls_equal'.
[0m22:30:49.743276 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:30:49.748276 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m22:30:49.750531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:49.840381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m22:30:49.842280 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:30:49.844277 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:30:49.846535 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m22:30:49.848662 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:30:49.850278 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:30:49.851275 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:30:49.855276 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m22:30:49.858277 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m22:30:49.861974 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:30:49.860275 [error] [Thread-1 (]: 30 of 32 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.24s]
[0m22:30:49.867276 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m22:30:49.871277 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m22:30:49.869278 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:30:49.874274 [info ] [Thread-4 (]: 32 of 32 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.22s]
[0m22:30:49.877276 [debug] [Thread-4 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:30:49.882275 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:49.884281 [debug] [MainThread]: On master: BEGIN
[0m22:30:49.887312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:49.977275 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m22:30:49.979277 [debug] [MainThread]: On master: COMMIT
[0m22:30:49.980931 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:49.982419 [debug] [MainThread]: On master: COMMIT
[0m22:30:49.983274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:30:49.984930 [debug] [MainThread]: On master: Close
[0m22:30:49.986700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:49.988291 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m22:30:49.989278 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' was properly closed.
[0m22:30:49.991278 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_referral_code__False.282a80bb46' was properly closed.
[0m22:30:49.993034 [debug] [MainThread]: Connection 'test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4' was properly closed.
[0m22:30:49.994493 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m22:30:49.996276 [info ] [MainThread]: 
[0m22:30:49.998276 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m22:30:50.012607 [debug] [MainThread]: Command end result
[0m22:30:50.111274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:30:50.116279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:30:50.141274 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:30:50.142274 [info ] [MainThread]: 
[0m22:30:50.145295 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successes, and 0 warnings:[0m
[0m22:30:50.147276 [info ] [MainThread]: 
[0m22:30:50.149298 [error] [MainThread]:   Compilation Error in test dbt_utils_source_date_between_staging_referrals_referral_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:50.154279 [info ] [MainThread]: 
[0m22:30:50.157379 [error] [MainThread]:   Compilation Error in test dbt_utils_source_date_between_staging_users_signup_date__current_timestamp__2020_01_01 (models\staging\schema.yml)
  'dict object' has no attribute 'test_date_between'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:50.159277 [info ] [MainThread]: 
[0m22:30:50.162277 [error] [MainThread]:   Compilation Error in test dbt_utils_source_not_equal_to_staging_referrals_referred_user_id__referrer_user_id (models\staging\schema.yml)
  'dict object' has no attribute 'test_not_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:30:50.168277 [info ] [MainThread]: 
[0m22:30:50.171290 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m22:30:50.174281 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:30:50.176588 [info ] [MainThread]: 
[0m22:30:50.184280 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m22:30:50.186277 [info ] [MainThread]: 
[0m22:30:50.188728 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m22:30:50.192578 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m22:30:50.196278 [info ] [MainThread]: 
[0m22:30:50.202394 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m22:30:50.204275 [info ] [MainThread]: 
[0m22:30:50.206274 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:30:50.209276 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:30:50.211278 [info ] [MainThread]: 
[0m22:30:50.218494 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m22:30:50.220276 [info ] [MainThread]: 
[0m22:30:50.222279 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m22:30:50.225279 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:30:50.231275 [info ] [MainThread]: 
[0m22:30:50.233276 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m22:30:50.236709 [info ] [MainThread]: 
[0m22:30:50.241276 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:30:50.247281 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:30:50.252521 [info ] [MainThread]: 
[0m22:30:50.254278 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m22:30:50.256277 [info ] [MainThread]: 
[0m22:30:50.259280 [error] [MainThread]:   Compilation Error in test source_unique_staging_market_token__date__token (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'
[0m22:30:50.263282 [info ] [MainThread]: 
[0m22:30:50.266281 [error] [MainThread]:   Compilation Error in test source_unique_staging_referrals_referred_user_id (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of'
[0m22:30:50.269617 [info ] [MainThread]: 
[0m22:30:50.271277 [error] [MainThread]:   Compilation Error in test source_unique_staging_users_referral_code__False (models\staging\schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'nulls_equal'
[0m22:30:50.273277 [info ] [MainThread]: 
[0m22:30:50.276276 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m22:30:50.278279 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m22:30:50.282278 [info ] [MainThread]: 
[0m22:30:50.284289 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m22:30:50.286273 [info ] [MainThread]: 
[0m22:30:50.288276 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=12 SKIP=0 TOTAL=32
[0m22:30:50.292276 [debug] [MainThread]: Command `dbt test` failed at 22:30:50.292276 after 9.24 seconds
[0m22:30:50.294275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88D49D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F2D6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F2D7850>]}
[0m22:30:50.295281 [debug] [MainThread]: Flushing usage events
[0m22:30:51.306493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:33:06.649232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9E07D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9FF31750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9FF31540>]}


============================== 22:33:06.654515 | ce10cce2-f4d0-48d8-aa04-2b2a834b2a33 ==============================
[0m22:33:06.654515 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:33:06.656409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:33:07.027234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA0046FE0>]}
[0m22:33:07.136234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9F9E9E70>]}
[0m22:33:07.140238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:33:07.710231 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:33:08.310508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:08.312508 [debug] [MainThread]: Partial parsing: updated file: growth://models\staging\schema.yml
[0m22:33:09.343508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.intermediate
- models.growth_metrics.marts
[0m22:33:09.376506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA07CFD90>]}
[0m22:33:09.609511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:33:09.616024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:33:09.667515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA08C3CD0>]}
[0m22:33:09.668507 [info ] [MainThread]: Found 16 models, 29 data tests, 4 sources, 546 macros
[0m22:33:09.670507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA08C0910>]}
[0m22:33:09.676510 [info ] [MainThread]: 
[0m22:33:09.678883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:33:09.680507 [info ] [MainThread]: 
[0m22:33:09.682511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:09.698510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_public'
[0m22:33:09.891506 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:33:09.892505 [debug] [ThreadPool]: On list_nca_public: BEGIN
[0m22:33:09.893506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:09.956509 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m22:33:09.958511 [debug] [ThreadPool]: Using postgres connection "list_nca_public"
[0m22:33:09.960244 [debug] [ThreadPool]: On list_nca_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_public"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:33:09.970507 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.009 seconds
[0m22:33:09.974513 [debug] [ThreadPool]: On list_nca_public: ROLLBACK
[0m22:33:09.976510 [debug] [ThreadPool]: On list_nca_public: Close
[0m22:33:09.997508 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:09.998509 [debug] [MainThread]: On master: BEGIN
[0m22:33:09.999508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:10.074262 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m22:33:10.075214 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:10.076212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:33:10.099981 [debug] [MainThread]: SQL status: SELECT 10 in 0.022 seconds
[0m22:33:10.107252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce10cce2-f4d0-48d8-aa04-2b2a834b2a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9C6E3A30>]}
[0m22:33:10.109015 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:10.111097 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:10.112339 [debug] [MainThread]: On master: BEGIN
[0m22:33:10.114482 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:33:10.115492 [debug] [MainThread]: On master: COMMIT
[0m22:33:10.116827 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:10.118567 [debug] [MainThread]: On master: COMMIT
[0m22:33:10.119798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:10.121810 [debug] [MainThread]: On master: Close
[0m22:33:10.136374 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:33:10.137417 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:33:10.139053 [debug] [Thread-3 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:33:10.140139 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:33:10.141246 [info ] [Thread-1 (]: 1 of 29 START test dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [RUN]
[0m22:33:10.142324 [info ] [Thread-2 (]: 2 of 29 START test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [RUN]
[0m22:33:10.144049 [info ] [Thread-3 (]: 3 of 29 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m22:33:10.148995 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80'
[0m22:33:10.146615 [info ] [Thread-4 (]: 4 of 29 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m22:33:10.151268 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700'
[0m22:33:10.154263 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m22:33:10.155263 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:33:10.159111 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m22:33:10.163073 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:33:10.165604 [debug] [Thread-3 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:33:10.200264 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:33:10.202034 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:33:10.213912 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:33:10.224918 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:33:10.247910 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:33:10.249414 [debug] [Thread-1 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:33:10.251914 [debug] [Thread-2 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:33:10.269915 [debug] [Thread-3 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:33:10.277912 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:33:10.284193 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:33:10.284915 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:33:10.289913 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:33:10.292912 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:33:10.299919 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:33:10.301919 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:33:10.303048 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: BEGIN
[0m22:33:10.304917 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:33:10.306910 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: BEGIN
[0m22:33:10.308921 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:33:10.310278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:33:10.310913 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m22:33:10.311914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:33:10.313193 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m22:33:10.315912 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:33:10.317913 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:33:10.435912 [debug] [Thread-3 (]: SQL status: BEGIN in 0.121 seconds
[0m22:33:10.437910 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:33:10.439916 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m22:33:10.441196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.129 seconds
[0m22:33:10.443913 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:33:10.444914 [debug] [Thread-4 (]: SQL status: BEGIN in 0.127 seconds
[0m22:33:10.447479 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        referred_user_id
    from "nca"."staging"."referrals"
    group by referred_user_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m22:33:10.448914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m22:33:10.449911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:33:10.451912 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:33:10.453915 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:33:10.467911 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m22:33:10.469390 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m22:33:10.471132 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m22:33:10.473233 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date, token
    from "nca"."staging"."market"
    group by date, token
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m22:33:10.474914 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m22:33:10.476911 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: ROLLBACK
[0m22:33:10.480915 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: Close
[0m22:33:10.481913 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:10.485914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:33:10.484916 [info ] [Thread-3 (]: 3 of 29 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.33s]
[0m22:33:10.490913 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m22:33:10.497915 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: ROLLBACK
[0m22:33:10.492912 [error] [Thread-2 (]: 2 of 29 FAIL 15 dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [[31mFAIL 15[0m in 0.34s]
[0m22:33:10.503915 [debug] [Thread-3 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:33:10.507122 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m22:33:10.508911 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: Close
[0m22:33:10.509912 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:33:10.511915 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:33:10.514218 [info ] [Thread-4 (]: 4 of 29 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.35s]
[0m22:33:10.523920 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:33:10.519913 [error] [Thread-1 (]: 1 of 29 FAIL 156 dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [[31mFAIL 156[0m in 0.37s]
[0m22:33:10.530914 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:33:10.527916 [info ] [Thread-3 (]: 5 of 29 START test source_not_null_staging_market_date ......................... [RUN]
[0m22:33:10.536916 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:33:10.533914 [info ] [Thread-2 (]: 6 of 29 START test source_not_null_staging_market_price ........................ [RUN]
[0m22:33:10.538915 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:33:10.541917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m22:33:10.544120 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:33:10.546090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m22:33:10.546914 [info ] [Thread-4 (]: 7 of 29 START test source_not_null_staging_market_token ........................ [RUN]
[0m22:33:10.548903 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:33:10.549915 [info ] [Thread-1 (]: 8 of 29 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m22:33:10.552916 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:33:10.555919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m22:33:10.564914 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:33:10.565912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m22:33:10.586915 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:33:10.589918 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:33:10.592912 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:33:10.595674 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:33:10.606911 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:33:10.618918 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:33:10.620915 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:33:10.626918 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:33:10.632912 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:33:10.634913 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:33:10.635914 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:33:10.638911 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:33:10.645913 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:33:10.647913 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:33:10.654914 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:33:10.656053 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m22:33:10.658066 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m22:33:10.659913 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:33:10.661915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:10.663199 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:33:10.663913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:10.664914 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m22:33:10.666973 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m22:33:10.669915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:10.670915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:10.783913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.114 seconds
[0m22:33:10.784911 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:33:10.786911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.125 seconds
[0m22:33:10.788347 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m22:33:10.789909 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:33:10.792914 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m22:33:10.793914 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:10.798915 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m22:33:10.799913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.128 seconds
[0m22:33:10.800916 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:33:10.801916 [debug] [Thread-2 (]: SQL status: BEGIN in 0.138 seconds
[0m22:33:10.803926 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m22:33:10.804992 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:33:10.808909 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m22:33:10.810278 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:33:10.813916 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m22:33:10.812913 [info ] [Thread-4 (]: 7 of 29 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.26s]
[0m22:33:10.816913 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m22:33:10.818913 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m22:33:10.820914 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:33:10.822308 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:10.823964 [info ] [Thread-3 (]: 5 of 29 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.28s]
[0m22:33:10.827915 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:10.829913 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:33:10.835916 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m22:33:10.838921 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:33:10.843914 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m22:33:10.845910 [info ] [Thread-4 (]: 9 of 29 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m22:33:10.847914 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m22:33:10.849317 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:33:10.851915 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m22:33:10.853083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m22:33:10.858212 [info ] [Thread-1 (]: 8 of 29 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.29s]
[0m22:33:10.859913 [info ] [Thread-3 (]: 10 of 29 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m22:33:10.863913 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:33:10.867917 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:33:10.863527 [error] [Thread-2 (]: 6 of 29 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.32s]
[0m22:33:10.870941 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m22:33:10.881916 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:33:10.883914 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:33:10.886212 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:33:10.889916 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:33:10.893971 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:33:10.896014 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:33:10.891926 [info ] [Thread-1 (]: 11 of 29 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m22:33:10.912917 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:33:10.916913 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:33:10.919916 [info ] [Thread-2 (]: 12 of 29 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m22:33:10.924913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m22:33:10.926920 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:33:10.928912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m22:33:10.930913 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:33:10.932096 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:33:10.941915 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:33:10.943294 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:33:10.955912 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:33:10.957097 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m22:33:10.971912 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:33:10.973913 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:33:10.975135 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:10.976912 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:33:10.978914 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m22:33:10.980915 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:33:10.988964 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:33:10.991107 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:11.001913 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:33:11.005917 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:33:11.007913 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m22:33:11.015914 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:33:11.016911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:11.019593 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m22:33:11.021914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:11.091912 [debug] [Thread-4 (]: SQL status: BEGIN in 0.117 seconds
[0m22:33:11.093913 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:33:11.095917 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m22:33:11.098911 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.103995 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m22:33:11.105913 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m22:33:11.106913 [info ] [Thread-4 (]: 9 of 29 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.25s]
[0m22:33:11.113665 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:33:11.115624 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:33:11.118914 [debug] [Thread-3 (]: SQL status: BEGIN in 0.128 seconds
[0m22:33:11.121915 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:33:11.122916 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m22:33:11.118275 [info ] [Thread-4 (]: 13 of 29 START test source_not_null_staging_transactions_token ................. [RUN]
[0m22:33:11.126914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m22:33:11.127916 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:11.130917 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:33:11.138919 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m22:33:11.147914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m22:33:11.157929 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:33:11.160128 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m22:33:11.161911 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:33:11.164915 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m22:33:11.166917 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:33:11.169917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:11.183917 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:33:11.184916 [debug] [Thread-2 (]: SQL status: BEGIN in 0.163 seconds
[0m22:33:11.173372 [error] [Thread-3 (]: 10 of 29 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.30s]
[0m22:33:11.188910 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m22:33:11.190912 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:33:11.193506 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:33:11.195241 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:33:11.197017 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m22:33:11.198914 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m22:33:11.201914 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:33:11.204927 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m22:33:11.211025 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.207917 [error] [Thread-1 (]: 11 of 29 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.28s]
[0m22:33:11.213914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:11.209917 [info ] [Thread-3 (]: 14 of 29 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m22:33:11.216916 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m22:33:11.218915 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:33:11.221222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m22:33:11.223920 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m22:33:11.226194 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:33:11.227914 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:33:11.249917 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:33:11.230915 [info ] [Thread-2 (]: 12 of 29 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.30s]
[0m22:33:11.257922 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:33:11.233914 [info ] [Thread-1 (]: 15 of 29 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m22:33:11.260913 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:33:11.274914 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:33:11.276266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m22:33:11.277915 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:33:11.279918 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:33:11.283084 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:33:11.281926 [info ] [Thread-2 (]: 16 of 29 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m22:33:11.377914 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:33:11.378916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.165 seconds
[0m22:33:11.379912 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m22:33:11.381910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m22:33:11.383398 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:33:11.383912 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:33:11.385913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:11.387911 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:33:11.389389 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m22:33:11.393912 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:33:11.407914 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:33:11.412914 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:11.417911 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m22:33:11.419913 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:33:11.421914 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:33:11.423914 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m22:33:11.425383 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m22:33:11.435917 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:33:11.440113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:11.438914 [info ] [Thread-4 (]: 13 of 29 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.31s]
[0m22:33:11.445680 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:33:11.447000 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:33:11.448919 [info ] [Thread-4 (]: 17 of 29 START test source_not_null_staging_users_country ...................... [RUN]
[0m22:33:11.451890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m22:33:11.454914 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:33:11.455914 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:33:11.458916 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m22:33:11.478913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:11.476915 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:33:11.482915 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:33:11.513914 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:33:11.522914 [debug] [Thread-3 (]: SQL status: BEGIN in 0.137 seconds
[0m22:33:11.526915 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:33:11.528913 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:33:11.529912 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:33:11.532917 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m22:33:11.534913 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.537367 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:11.542231 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m22:33:11.545913 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m22:33:11.547913 [info ] [Thread-3 (]: 14 of 29 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.33s]
[0m22:33:11.552048 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:33:11.553915 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:33:11.555918 [info ] [Thread-3 (]: 18 of 29 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m22:33:11.558140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m22:33:11.560211 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:33:11.577020 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:33:11.579916 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:33:11.591920 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:33:11.595919 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:33:11.597915 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m22:33:11.599912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:11.626913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.148 seconds
[0m22:33:11.627913 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:33:11.629913 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m22:33:11.633914 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.639916 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m22:33:11.640915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.201 seconds
[0m22:33:11.642913 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m22:33:11.645075 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:33:11.647914 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m22:33:11.649914 [info ] [Thread-2 (]: 16 of 29 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.27s]
[0m22:33:11.653914 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:33:11.655665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:11.656913 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:33:11.661915 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m22:33:11.666185 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m22:33:11.663917 [info ] [Thread-2 (]: 19 of 29 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m22:33:11.675915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m22:33:11.671921 [info ] [Thread-1 (]: 15 of 29 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.40s]
[0m22:33:11.677914 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:33:11.680913 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:33:11.697914 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:33:11.699915 [debug] [Thread-1 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:33:11.706918 [debug] [Thread-4 (]: SQL status: BEGIN in 0.170 seconds
[0m22:33:11.711913 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:33:11.713914 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m22:33:11.709979 [info ] [Thread-1 (]: 20 of 29 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m22:33:11.716915 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.725059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m22:33:11.726912 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:33:11.731915 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m22:33:11.733913 [debug] [Thread-1 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:33:11.745912 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:33:11.747881 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m22:33:11.760913 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:33:11.763916 [debug] [Thread-3 (]: SQL status: BEGIN in 0.163 seconds
[0m22:33:11.765915 [info ] [Thread-4 (]: 17 of 29 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.31s]
[0m22:33:11.768636 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:33:11.771914 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:33:11.773912 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:33:11.775895 [debug] [Thread-1 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:33:11.777155 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m22:33:11.777914 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m22:33:11.779912 [debug] [Thread-4 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:33:11.787042 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:33:11.788914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:11.790173 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.791914 [info ] [Thread-4 (]: 21 of 29 START test source_positive_value_staging_market_price ................. [RUN]
[0m22:33:11.795913 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:33:11.799892 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m22:33:11.802480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m22:33:11.804579 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m22:33:11.807924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m22:33:11.809154 [debug] [Thread-4 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:33:11.811914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:11.813913 [info ] [Thread-3 (]: 18 of 29 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.26s]
[0m22:33:11.833912 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:33:11.838914 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:33:11.849914 [debug] [Thread-3 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:33:11.851901 [info ] [Thread-3 (]: 22 of 29 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m22:33:11.856917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m22:33:11.858926 [debug] [Thread-3 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:33:11.875589 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:33:11.876914 [debug] [Thread-4 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:33:11.889913 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:33:11.892928 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:33:11.895913 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m22:33:11.897421 [debug] [Thread-3 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:33:11.899000 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:11.907922 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:33:11.910913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.122 seconds
[0m22:33:11.913915 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:33:11.915914 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m22:33:11.917916 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:33:11.921053 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m22:33:11.922279 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:11.923914 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:11.929374 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m22:33:11.931914 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m22:33:11.934915 [info ] [Thread-2 (]: 19 of 29 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.26s]
[0m22:33:11.938913 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:33:11.940980 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:33:11.942912 [info ] [Thread-2 (]: 23 of 29 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m22:33:11.944914 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m22:33:11.947921 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:33:11.966916 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:33:11.969916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m22:33:11.974914 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:33:11.976915 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:33:11.980918 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:33:11.993915 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:33:11.994912 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m22:33:12.001080 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m22:33:12.003915 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:33:12.004916 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m22:33:12.006912 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m22:33:12.010914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:12.009915 [info ] [Thread-1 (]: 20 of 29 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.28s]
[0m22:33:12.014915 [debug] [Thread-1 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:33:12.016915 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:33:12.019918 [info ] [Thread-1 (]: 24 of 29 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m22:33:12.022914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m22:33:12.024916 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:33:12.048299 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:33:12.051912 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:33:12.066913 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:33:12.084253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.185 seconds
[0m22:33:12.085912 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:33:12.087960 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:33:12.089913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.166 seconds
[0m22:33:12.091916 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:33:12.093930 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:33:12.095913 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:12.097912 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m22:33:12.099915 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:33:12.104893 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m22:33:12.106912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:12.108935 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m22:33:12.111912 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:12.116915 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m22:33:12.120022 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m22:33:12.118913 [error] [Thread-4 (]: 21 of 29 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.32s]
[0m22:33:12.123913 [error] [Thread-3 (]: 22 of 29 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.27s]
[0m22:33:12.126915 [debug] [Thread-4 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:33:12.128923 [debug] [Thread-3 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:33:12.130915 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:33:12.133922 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:33:12.136916 [info ] [Thread-4 (]: 25 of 29 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m22:33:12.140379 [info ] [Thread-3 (]: 26 of 29 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m22:33:12.147914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m22:33:12.149972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m22:33:12.151929 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:33:12.154914 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:33:12.174914 [debug] [Thread-2 (]: SQL status: BEGIN in 0.164 seconds
[0m22:33:12.189914 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:33:12.194912 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:33:12.198913 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:33:12.199911 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:33:12.206913 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:33:12.208912 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:33:12.218916 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:33:12.220031 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:33:12.225910 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m22:33:12.234914 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:33:12.238392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.132 seconds
[0m22:33:12.239920 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m22:33:12.241912 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:33:12.244086 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:33:12.245913 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:33:12.248913 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m22:33:12.247913 [info ] [Thread-2 (]: 23 of 29 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.30s]
[0m22:33:12.251371 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:33:12.252913 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m22:33:12.254914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:12.256912 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:33:12.258917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:12.261916 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:33:12.263914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:33:12.272080 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m22:33:12.273912 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m22:33:12.266913 [info ] [Thread-2 (]: 27 of 29 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m22:33:12.276914 [info ] [Thread-1 (]: 24 of 29 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.25s]
[0m22:33:12.283820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m22:33:12.290915 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:33:12.285916 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:33:12.318913 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:33:12.323914 [info ] [Thread-1 (]: 28 of 29 START test source_unique_staging_users_referral_code .................. [RUN]
[0m22:33:12.345915 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:33:12.347913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e, now test.growth.source_unique_staging_users_referral_code.184becf50f)
[0m22:33:12.350913 [debug] [Thread-2 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:33:12.354914 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:33:12.366913 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:33:12.382912 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:33:12.385916 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:33:12.387913 [debug] [Thread-2 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m22:33:12.389915 [debug] [Thread-1 (]: Began executing node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:33:12.390915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:12.400919 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:33:12.409922 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:33:12.410923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.153 seconds
[0m22:33:12.412918 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: BEGIN
[0m22:33:12.415162 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:33:12.417162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:12.418250 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:33:12.425164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.170 seconds
[0m22:33:12.427165 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:33:12.428161 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:33:12.430163 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:33:12.435162 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m22:33:12.438313 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m22:33:12.441163 [info ] [Thread-3 (]: 26 of 29 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.29s]
[0m22:33:12.444555 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:33:12.446076 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:33:12.448078 [debug] [Thread-3 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:33:12.452616 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m22:33:12.454616 [info ] [Thread-3 (]: 29 of 29 START test source_unique_staging_users_user_id ........................ [RUN]
[0m22:33:12.456617 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m22:33:12.459616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m22:33:12.465753 [debug] [Thread-3 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:33:12.481618 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:33:12.463634 [info ] [Thread-4 (]: 25 of 29 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.32s]
[0m22:33:12.485363 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:33:12.496203 [debug] [Thread-3 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:33:12.511167 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:33:12.513837 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:33:12.516840 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m22:33:12.518832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:12.556040 [debug] [Thread-2 (]: SQL status: BEGIN in 0.165 seconds
[0m22:33:12.558039 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:33:12.560065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m22:33:12.561607 [debug] [Thread-2 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:12.563334 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:33:12.565285 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_referral_code.184becf50f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    referral_code as unique_field,
    count(*) as n_records

from (select * from "nca"."staging"."users" where referral_code is not null) dbt_subquery
where referral_code is not null
group by referral_code
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:12.569019 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:12.570764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:33:12.573660 [debug] [Thread-2 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m22:33:12.577948 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: ROLLBACK
[0m22:33:12.579969 [debug] [Thread-2 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m22:33:12.581793 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: Close
[0m22:33:12.584528 [error] [Thread-2 (]: 27 of 29 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.30s]
[0m22:33:12.590608 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:33:12.587530 [info ] [Thread-1 (]: 28 of 29 PASS source_unique_staging_users_referral_code ........................ [[32mPASS[0m in 0.24s]
[0m22:33:12.595133 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:33:12.628346 [debug] [Thread-3 (]: SQL status: BEGIN in 0.109 seconds
[0m22:33:12.630584 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:33:12.632729 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:12.637584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:12.643367 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m22:33:12.644995 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m22:33:12.647913 [info ] [Thread-3 (]: 29 of 29 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.19s]
[0m22:33:12.650797 [debug] [Thread-3 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:33:12.654796 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:12.656796 [debug] [MainThread]: On master: BEGIN
[0m22:33:12.657794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:12.760772 [debug] [MainThread]: SQL status: BEGIN in 0.102 seconds
[0m22:33:12.762627 [debug] [MainThread]: On master: COMMIT
[0m22:33:12.764285 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:12.765281 [debug] [MainThread]: On master: COMMIT
[0m22:33:12.767281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:12.769281 [debug] [MainThread]: On master: Close
[0m22:33:12.771301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:12.772883 [debug] [MainThread]: Connection 'list_nca_public' was properly closed.
[0m22:33:12.774280 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_referral_code.184becf50f' was properly closed.
[0m22:33:12.775280 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' was properly closed.
[0m22:33:12.777282 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m22:33:12.779282 [debug] [MainThread]: Connection 'test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be' was properly closed.
[0m22:33:12.781343 [info ] [MainThread]: 
[0m22:33:12.783335 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m22:33:12.813286 [debug] [MainThread]: Command end result
[0m22:33:12.893280 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:33:12.897281 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:33:12.916286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:33:12.918439 [info ] [MainThread]: 
[0m22:33:12.921674 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m22:33:12.923283 [info ] [MainThread]: 
[0m22:33:12.924284 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id (models\staging\schema.yml)[0m
[0m22:33:12.926342 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:33:12.928954 [info ] [MainThread]: 
[0m22:33:12.934284 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_ce21451ab51663af294524ce4a7e56fa.sql
[0m22:33:12.937285 [info ] [MainThread]: 
[0m22:33:12.941283 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_market_date__token (models\staging\schema.yml)[0m
[0m22:33:12.944288 [error] [MainThread]:   Got 156 results, configured to fail if != 0
[0m22:33:12.947283 [info ] [MainThread]: 
[0m22:33:12.950515 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_3a255a5db84d348db66273d767faeca9.sql
[0m22:33:12.952287 [info ] [MainThread]: 
[0m22:33:12.954283 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m22:33:12.957282 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:33:12.962673 [info ] [MainThread]: 
[0m22:33:12.964281 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m22:33:12.966281 [info ] [MainThread]: 
[0m22:33:12.969284 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m22:33:12.971283 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m22:33:12.975282 [info ] [MainThread]: 
[0m22:33:12.979282 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m22:33:12.980280 [info ] [MainThread]: 
[0m22:33:12.982294 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:33:12.985279 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:33:12.987280 [info ] [MainThread]: 
[0m22:33:12.990311 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m22:33:12.994282 [info ] [MainThread]: 
[0m22:33:12.996280 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m22:33:12.999280 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:33:13.000283 [info ] [MainThread]: 
[0m22:33:13.002271 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m22:33:13.005653 [info ] [MainThread]: 
[0m22:33:13.010292 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:33:13.012280 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:33:13.014280 [info ] [MainThread]: 
[0m22:33:13.016581 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m22:33:13.018280 [info ] [MainThread]: 
[0m22:33:13.020280 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m22:33:13.027284 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m22:33:13.030281 [info ] [MainThread]: 
[0m22:33:13.032284 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m22:33:13.034676 [info ] [MainThread]: 
[0m22:33:13.037282 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=8 SKIP=0 TOTAL=29
[0m22:33:13.044406 [debug] [MainThread]: Command `dbt test` failed at 22:33:13.044406 after 6.56 seconds
[0m22:33:13.045285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9E07D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9DBDCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA2099570>]}
[0m22:33:13.046283 [debug] [MainThread]: Flushing usage events
[0m22:33:14.708440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:58.419866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19F7BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A16694E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A16692D0>]}


============================== 22:53:58.428869 | 2c55b657-8a56-48d7-bd96-f0247e96ff15 ==============================
[0m22:53:58.428869 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:53:58.432870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:53:58.708865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c55b657-8a56-48d7-bd96-f0247e96ff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A16A28F0>]}
[0m22:53:58.963867 [debug] [MainThread]: Command `dbt clean` succeeded at 22:53:58.963867 after 0.69 seconds
[0m22:53:58.964867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19F7BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A16A1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A16A1990>]}
[0m22:53:58.966873 [debug] [MainThread]: Flushing usage events
[0m22:54:00.176321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:25.213085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136608BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001366276D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001366276D3C0>]}


============================== 22:54:25.217122 | 8000911d-fc8f-4add-8584-18d3bb2b78fd ==============================
[0m22:54:25.217122 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:54:25.219100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:25.553087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8000911d-fc8f-4add-8584-18d3bb2b78fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013662898EB0>]}
[0m22:54:25.653083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8000911d-fc8f-4add-8584-18d3bb2b78fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001366276D690>]}
[0m22:54:25.655125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:54:26.115341 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m22:54:26.117343 [debug] [MainThread]: Command `dbt run` failed at 22:54:26.117343 after 1.05 seconds
[0m22:54:26.118343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136608BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001365FC528F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001365FC51300>]}
[0m22:54:26.119343 [debug] [MainThread]: Flushing usage events
[0m22:54:27.182872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:45.299374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018512B6D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018514A19510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018514A19300>]}


============================== 22:54:45.303313 | fb89e3fb-c44a-4410-99ea-01ea2b2bf48b ==============================
[0m22:54:45.303313 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:54:45.304316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:54:45.506353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb89e3fb-c44a-4410-99ea-01ea2b2bf48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018514A1AF50>]}
[0m22:54:45.556315 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-z5kz3wtq'
[0m22:54:45.557355 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:54:46.591706 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:54:46.592770 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:54:47.232280 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:54:47.247270 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:54:49.081988 [info ] [MainThread]: Installed from version 1.1.1
[0m22:54:49.084990 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:54:49.085990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb89e3fb-c44a-4410-99ea-01ea2b2bf48b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018512E12740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018511E9C040>]}
[0m22:54:49.087989 [info ] [MainThread]: 
[0m22:54:49.088988 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:54:49.093989 [debug] [MainThread]: Command `dbt deps` succeeded at 22:54:49.092992 after 3.93 seconds
[0m22:54:49.094990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018512B6D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018514A1AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018514B6CE80>]}
[0m22:54:49.095987 [debug] [MainThread]: Flushing usage events
[0m22:54:50.073987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:58.437705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB1BCD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB3A81750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB3A81570>]}


============================== 22:54:58.448707 | 18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd ==============================
[0m22:54:58.448707 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:54:58.450707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:54:59.173706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB3BA8EE0>]}
[0m22:54:59.339703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB353B610>]}
[0m22:54:59.344708 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:55:00.415837 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:55:00.418532 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:55:00.421464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB0F60070>]}
[0m22:55:05.011124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.marts
- models.growth_metrics.intermediate
[0m22:55:05.051149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5618130>]}
[0m22:55:05.356718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:55:05.363654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:55:05.420905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB55B0EE0>]}
[0m22:55:05.421902 [info ] [MainThread]: Found 16 models, 29 data tests, 4 sources, 546 macros
[0m22:55:05.422901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB55B0F10>]}
[0m22:55:05.426903 [info ] [MainThread]: 
[0m22:55:05.428904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:05.429903 [info ] [MainThread]: 
[0m22:55:05.435908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:55:05.452903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m22:55:05.849909 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m22:55:05.851907 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m22:55:05.852910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:05.955907 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.103 seconds
[0m22:55:05.957905 [debug] [ThreadPool]: On list_nca: Close
[0m22:55:05.959912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nca, now create_nca_<default_schema>)
[0m22:55:05.961904 [debug] [ThreadPool]: Creating schema "database: "nca"
schema: "<default_schema>"
"
[0m22:55:05.972902 [debug] [ThreadPool]: Using postgres connection "create_nca_<default_schema>"
[0m22:55:05.973900 [debug] [ThreadPool]: On create_nca_<default_schema>: BEGIN
[0m22:55:05.974907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:06.037904 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m22:55:06.039905 [debug] [ThreadPool]: Using postgres connection "create_nca_<default_schema>"
[0m22:55:06.040903 [debug] [ThreadPool]: On create_nca_<default_schema>: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "create_nca_<default_schema>"} */
create schema if not exists "<default_schema>"
[0m22:55:06.045902 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m22:55:06.047903 [debug] [ThreadPool]: On create_nca_<default_schema>: COMMIT
[0m22:55:06.050908 [debug] [ThreadPool]: Using postgres connection "create_nca_<default_schema>"
[0m22:55:06.051907 [debug] [ThreadPool]: On create_nca_<default_schema>: COMMIT
[0m22:55:06.053903 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:55:06.054903 [debug] [ThreadPool]: On create_nca_<default_schema>: Close
[0m22:55:06.060904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_<default_schema>'
[0m22:55:06.072901 [debug] [ThreadPool]: Using postgres connection "list_nca_<default_schema>"
[0m22:55:06.073901 [debug] [ThreadPool]: On list_nca_<default_schema>: BEGIN
[0m22:55:06.074902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:06.133909 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m22:55:06.135903 [debug] [ThreadPool]: Using postgres connection "list_nca_<default_schema>"
[0m22:55:06.135903 [debug] [ThreadPool]: On list_nca_<default_schema>: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_<default_schema>"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '<default_schema>'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '<default_schema>'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '<default_schema>'
  
[0m22:55:06.145909 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:55:06.147902 [debug] [ThreadPool]: On list_nca_<default_schema>: ROLLBACK
[0m22:55:06.149905 [debug] [ThreadPool]: On list_nca_<default_schema>: Close
[0m22:55:06.160901 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:06.161900 [debug] [MainThread]: On master: BEGIN
[0m22:55:06.161900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:06.225902 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m22:55:06.226909 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:06.227904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:55:06.242905 [debug] [MainThread]: SQL status: SELECT 10 in 0.014 seconds
[0m22:55:06.244903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB42DFA60>]}
[0m22:55:06.245902 [debug] [MainThread]: On master: ROLLBACK
[0m22:55:06.246908 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:06.247906 [debug] [MainThread]: On master: BEGIN
[0m22:55:06.249910 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:55:06.251910 [debug] [MainThread]: On master: COMMIT
[0m22:55:06.252905 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:06.253903 [debug] [MainThread]: On master: COMMIT
[0m22:55:06.254905 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:55:06.254905 [debug] [MainThread]: On master: Close
[0m22:55:06.261903 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m22:55:06.262903 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m22:55:06.263903 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m22:55:06.265903 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m22:55:06.267906 [info ] [Thread-1 (]: 1 of 16 START sql view model <default_schema>.stg_market ....................... [RUN]
[0m22:55:06.269911 [info ] [Thread-2 (]: 2 of 16 START sql view model <default_schema>.stg_referrals .................... [RUN]
[0m22:55:06.271910 [info ] [Thread-3 (]: 3 of 16 START sql view model <default_schema>.stg_transactions ................. [RUN]
[0m22:55:06.275904 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m22:55:06.273902 [info ] [Thread-4 (]: 4 of 16 START sql view model <default_schema>.stg_users ........................ [RUN]
[0m22:55:06.277903 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m22:55:06.280908 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m22:55:06.284906 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m22:55:06.287907 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m22:55:06.288903 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m22:55:06.289905 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m22:55:06.308899 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m22:55:06.309901 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m22:55:06.319913 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m22:55:06.324900 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m22:55:06.330901 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m22:55:06.337904 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m22:55:06.339904 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m22:55:06.388899 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m22:55:06.414904 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m22:55:06.422905 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m22:55:06.424902 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m22:55:06.424902 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m22:55:06.434908 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m22:55:06.438909 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:55:06.439903 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:55:06.439903 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m22:55:06.440903 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:55:06.441902 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:06.442908 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m22:55:06.443906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:06.443906 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m22:55:06.444902 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m22:55:06.445903 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:06.447903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:06.453906 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:55:06.562906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.114 seconds
[0m22:55:06.563905 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:55:06.568909 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."<default_schema>"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m22:55:06.569907 [debug] [Thread-2 (]: SQL status: BEGIN in 0.124 seconds
[0m22:55:06.573904 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:55:06.574903 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."<default_schema>"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m22:55:06.589903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.137 seconds
[0m22:55:06.591905 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m22:55:06.592905 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m22:55:06.592905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m22:55:06.593901 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:06.594901 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:55:06.605899 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:55:06.611903 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:55:06.612903 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."<default_schema>"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m22:55:06.613901 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."<default_schema>"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m22:55:06.614902 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."<default_schema>"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m22:55:06.615902 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."<default_schema>"."stg_market__dbt_tmp" rename to "stg_market"
[0m22:55:06.620905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:06.621906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:55:06.622907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:55:06.623911 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:55:06.656899 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:55:06.659899 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:55:06.664902 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:06.672902 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:55:06.673902 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:55:06.674904 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:55:06.675901 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."<default_schema>"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:55:06.675901 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."<default_schema>"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:55:06.676903 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m22:55:06.677902 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m22:55:06.679903 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:06.680904 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:06.680904 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:06.685905 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:55:06.686903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:55:06.689911 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:55:06.698900 [debug] [Thread-2 (]: Applying DROP to: "nca"."<default_schema>"."stg_referrals__dbt_backup"
[0m22:55:06.701906 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:06.706900 [debug] [Thread-1 (]: Applying DROP to: "nca"."<default_schema>"."stg_market__dbt_backup"
[0m22:55:06.707904 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:55:06.713901 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m22:55:06.714903 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m22:55:06.717906 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m22:55:06.719907 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m22:55:06.720903 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."<default_schema>"."stg_referrals__dbt_backup" cascade
[0m22:55:06.721904 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."<default_schema>"."stg_market__dbt_backup" cascade
[0m22:55:06.722907 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:06.724906 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:06.725903 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:06.725903 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:06.729901 [debug] [Thread-4 (]: Applying DROP to: "nca"."<default_schema>"."stg_users__dbt_backup"
[0m22:55:06.737905 [debug] [Thread-3 (]: Applying DROP to: "nca"."<default_schema>"."stg_transactions__dbt_backup"
[0m22:55:06.741901 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m22:55:06.743908 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m22:55:06.744906 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:06.746906 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m22:55:06.752908 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB36D4D90>]}
[0m22:55:06.754910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB43996C0>]}
[0m22:55:06.756905 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."<default_schema>"."stg_users__dbt_backup" cascade
[0m22:55:06.758906 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."<default_schema>"."stg_transactions__dbt_backup" cascade
[0m22:55:06.759910 [info ] [Thread-2 (]: 2 of 16 OK created sql view model <default_schema>.stg_referrals ............... [[32mCREATE VIEW[0m in 0.47s]
[0m22:55:06.761903 [info ] [Thread-1 (]: 1 of 16 OK created sql view model <default_schema>.stg_market .................. [[32mCREATE VIEW[0m in 0.48s]
[0m22:55:06.764906 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:06.764906 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:06.767905 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m22:55:06.769918 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m22:55:06.772904 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m22:55:06.776904 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m22:55:06.778904 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m22:55:06.780906 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m22:55:06.786908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB42B36A0>]}
[0m22:55:06.788905 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB59B8610>]}
[0m22:55:06.790908 [info ] [Thread-2 (]: 5 of 16 START sql view model <default_schema>.dim_referrals .................... [RUN]
[0m22:55:06.803905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m22:55:06.795907 [info ] [Thread-4 (]: 4 of 16 OK created sql view model <default_schema>.stg_users ................... [[32mCREATE VIEW[0m in 0.50s]
[0m22:55:06.792907 [info ] [Thread-1 (]: 6 of 16 START sql view model <default_schema>.dim_market ....................... [RUN]
[0m22:55:06.805904 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m22:55:06.807906 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m22:55:06.798904 [info ] [Thread-3 (]: 3 of 16 OK created sql view model <default_schema>.stg_transactions ............ [[32mCREATE VIEW[0m in 0.51s]
[0m22:55:06.808903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_market)
[0m22:55:06.821905 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m22:55:06.822903 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m22:55:06.823902 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m22:55:06.825905 [debug] [Thread-1 (]: Began compiling node model.growth.dim_market
[0m22:55:06.828904 [info ] [Thread-4 (]: 7 of 16 START sql view model <default_schema>.dim_users ........................ [RUN]
[0m22:55:06.840904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.dim_users)
[0m22:55:06.830906 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m22:55:06.841907 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m22:55:06.846905 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_market"
[0m22:55:06.848908 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m22:55:06.854907 [info ] [Thread-3 (]: 8 of 16 START sql view model <default_schema>.dim_transactions ................. [RUN]
[0m22:55:06.869909 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m22:55:06.890910 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m22:55:06.892909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m22:55:06.903909 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m22:55:06.897905 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m22:55:06.894908 [debug] [Thread-1 (]: Began executing node model.growth.dim_market
[0m22:55:06.913909 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m22:55:06.920916 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:55:06.939905 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m22:55:06.955921 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_market"
[0m22:55:06.957903 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m22:55:06.959907 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m22:55:06.962906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:06.964907 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:55:06.968907 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:06.981904 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m22:55:06.986905 [debug] [Thread-1 (]: On model.growth.dim_market: BEGIN
[0m22:55:06.988904 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m22:55:06.990906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:06.992909 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:06.993906 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:55:06.996904 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m22:55:06.998906 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:07.180910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.190 seconds
[0m22:55:07.182908 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:55:07.185907 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."<default_schema>"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."<default_schema>"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m22:55:07.189908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.197 seconds
[0m22:55:07.190906 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:07.192906 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."<default_schema>"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."<default_schema>"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m22:55:07.194907 [debug] [Thread-3 (]: SQL status: BEGIN in 0.196 seconds
[0m22:55:07.195904 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:55:07.197907 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:55:07.208910 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:55:07.209902 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m22:55:07.210905 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."<default_schema>"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."<default_schema>"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m22:55:07.212903 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."<default_schema>"."dim_market__dbt_tmp" rename to "dim_market"
[0m22:55:07.223909 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:07.225904 [debug] [Thread-2 (]: SQL status: BEGIN in 0.264 seconds
[0m22:55:07.228907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:07.230904 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."<default_schema>"."dim_users__dbt_tmp" rename to "dim_users"
[0m22:55:07.232904 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:55:07.233906 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:55:07.238904 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:55:07.240903 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."<default_schema>"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."<default_schema>"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m22:55:07.241906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:55:07.258907 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m22:55:07.252921 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:55:07.260907 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:07.261907 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:55:07.254908 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:55:07.264908 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."<default_schema>"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m22:55:07.266906 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m22:55:07.280904 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:55:07.285905 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m22:55:07.288905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:07.289908 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:55:07.289908 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."<default_schema>"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m22:55:07.293904 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:55:07.293904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:55:07.298902 [debug] [Thread-4 (]: Applying DROP to: "nca"."<default_schema>"."dim_users__dbt_backup"
[0m22:55:07.299903 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:55:07.302906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:55:07.307903 [debug] [Thread-1 (]: Applying DROP to: "nca"."<default_schema>"."dim_market__dbt_backup"
[0m22:55:07.308901 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:07.309902 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m22:55:07.311901 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:55:07.312904 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m22:55:07.313907 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."<default_schema>"."dim_users__dbt_backup" cascade
[0m22:55:07.315903 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:55:07.316904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:07.318908 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."<default_schema>"."dim_market__dbt_backup" cascade
[0m22:55:07.320904 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m22:55:07.321904 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:55:07.325899 [debug] [Thread-3 (]: Applying DROP to: "nca"."<default_schema>"."dim_transactions__dbt_backup"
[0m22:55:07.327915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:07.328902 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:07.330903 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m22:55:07.331902 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m22:55:07.335905 [debug] [Thread-1 (]: On model.growth.dim_market: Close
[0m22:55:07.340903 [debug] [Thread-2 (]: Applying DROP to: "nca"."<default_schema>"."dim_referrals__dbt_backup"
[0m22:55:07.341902 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB56B5630>]}
[0m22:55:07.343903 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."<default_schema>"."dim_transactions__dbt_backup" cascade
[0m22:55:07.345906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB59F8040>]}
[0m22:55:07.348905 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m22:55:07.352908 [info ] [Thread-4 (]: 7 of 16 OK created sql view model <default_schema>.dim_users ................... [[32mCREATE VIEW[0m in 0.50s]
[0m22:55:07.357904 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:55:07.356906 [info ] [Thread-1 (]: 6 of 16 OK created sql view model <default_schema>.dim_market .................. [[32mCREATE VIEW[0m in 0.54s]
[0m22:55:07.358904 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."<default_schema>"."dim_referrals__dbt_backup" cascade
[0m22:55:07.360909 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m22:55:07.363900 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m22:55:07.374932 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB4188BE0>]}
[0m22:55:07.365904 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m22:55:07.372907 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:55:07.377909 [info ] [Thread-3 (]: 8 of 16 OK created sql view model <default_schema>.dim_transactions ............ [[32mCREATE VIEW[0m in 0.48s]
[0m22:55:07.370907 [debug] [Thread-4 (]: Began running node model.growth.fct_users_acquisition
[0m22:55:07.381908 [debug] [Thread-1 (]: Began running node model.growth.mart_daily_transactions
[0m22:55:07.390906 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m22:55:07.395905 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m22:55:07.403909 [info ] [Thread-4 (]: 9 of 16 START sql table model <default_schema>.fct_users_acquisition ........... [RUN]
[0m22:55:07.427906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB439B910>]}
[0m22:55:07.421910 [info ] [Thread-1 (]: 10 of 16 START sql table model <default_schema>.mart_daily_transactions ........ [RUN]
[0m22:55:07.430908 [debug] [Thread-3 (]: Began running node model.growth.mart_transaction_summary
[0m22:55:07.432908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.fct_users_acquisition)
[0m22:55:07.438910 [info ] [Thread-2 (]: 5 of 16 OK created sql view model <default_schema>.dim_referrals ............... [[32mCREATE VIEW[0m in 0.62s]
[0m22:55:07.440904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.mart_daily_transactions)
[0m22:55:07.442911 [info ] [Thread-3 (]: 11 of 16 START sql table model <default_schema>.mart_transaction_summary ....... [RUN]
[0m22:55:07.445905 [debug] [Thread-4 (]: Began compiling node model.growth.fct_users_acquisition
[0m22:55:07.447907 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m22:55:07.451908 [debug] [Thread-1 (]: Began compiling node model.growth.mart_daily_transactions
[0m22:55:07.453905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.mart_transaction_summary)
[0m22:55:07.476907 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m22:55:07.487905 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_transactions
[0m22:55:07.513909 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m22:55:07.515908 [debug] [Thread-3 (]: Began compiling node model.growth.mart_transaction_summary
[0m22:55:07.524912 [debug] [Thread-4 (]: Began executing node model.growth.fct_users_acquisition
[0m22:55:07.521908 [info ] [Thread-2 (]: 12 of 16 START sql view model <default_schema>.int_enriched_transactions ....... [RUN]
[0m22:55:07.529909 [debug] [Thread-1 (]: Began executing node model.growth.mart_daily_transactions
[0m22:55:07.554907 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m22:55:07.579905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.int_enriched_transactions)
[0m22:55:07.653907 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m22:55:07.664917 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m22:55:07.668908 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_transactions
[0m22:55:07.670906 [debug] [Thread-3 (]: Began executing node model.growth.mart_transaction_summary
[0m22:55:07.683457 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m22:55:07.693643 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:55:07.695138 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:55:07.699007 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m22:55:07.703192 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: BEGIN
[0m22:55:07.705029 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: BEGIN
[0m22:55:07.706184 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_transactions
[0m22:55:07.707831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:07.709976 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:07.711243 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:55:07.721913 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m22:55:07.725070 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: BEGIN
[0m22:55:07.728154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:07.731153 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:55:07.733154 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: BEGIN
[0m22:55:07.744154 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:07.844465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.136 seconds
[0m22:55:07.846020 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:55:07.847034 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."<default_schema>"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."<default_schema>"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m22:55:07.866656 [debug] [Thread-3 (]: SQL status: BEGIN in 0.138 seconds
[0m22:55:07.868661 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:55:07.871660 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."<default_schema>"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."<default_schema>"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."<default_schema>"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."<default_schema>"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m22:55:07.876658 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.027 seconds
[0m22:55:07.888834 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:55:07.889846 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."<default_schema>"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m22:55:07.891853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m22:55:07.892847 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:55:07.893850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:07.895848 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."<default_schema>"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."<default_schema>"."dim_transactions" t
    LEFT JOIN "nca"."<default_schema>"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m22:55:07.909998 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.037 seconds
[0m22:55:07.912009 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m22:55:07.925111 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:55:07.926418 [debug] [Thread-4 (]: SQL status: BEGIN in 0.217 seconds
[0m22:55:07.928057 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m22:55:07.929668 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:55:07.931308 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."<default_schema>"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m22:55:07.932928 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:55:07.944364 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:55:07.945982 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m22:55:07.948356 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."<default_schema>"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."<default_schema>"."stg_users" u
    LEFT JOIN "nca"."<default_schema>"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."<default_schema>"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m22:55:07.951024 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:55:07.953448 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."<default_schema>"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m22:55:07.958818 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:55:07.959945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:55:07.961958 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:55:07.964080 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:55:07.976921 [debug] [Thread-1 (]: Applying DROP to: "nca"."<default_schema>"."mart_daily_transactions__dbt_backup"
[0m22:55:07.978912 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: COMMIT
[0m22:55:07.982912 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:55:07.986916 [debug] [Thread-4 (]: SQL status: SELECT 97 in 0.031 seconds
[0m22:55:07.992160 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m22:55:07.993846 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:55:07.994898 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:08.005385 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:55:08.006988 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."<default_schema>"."mart_daily_transactions__dbt_backup" cascade
[0m22:55:08.008058 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m22:55:08.014168 [debug] [Thread-3 (]: Applying DROP to: "nca"."<default_schema>"."mart_transaction_summary__dbt_backup"
[0m22:55:08.015767 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."<default_schema>"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m22:55:08.021849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:55:08.024662 [debug] [Thread-3 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m22:55:08.025479 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:55:08.029178 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: Close
[0m22:55:08.029713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:55:08.031309 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."<default_schema>"."mart_transaction_summary__dbt_backup" cascade
[0m22:55:08.039454 [debug] [Thread-2 (]: Applying DROP to: "nca"."<default_schema>"."int_enriched_transactions__dbt_backup"
[0m22:55:08.042070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB55DF3D0>]}
[0m22:55:08.045948 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:55:08.048632 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m22:55:08.053622 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:55:08.051621 [info ] [Thread-1 (]: 10 of 16 OK created sql table model <default_schema>.mart_daily_transactions ... [[32mSELECT 1000[0m in 0.60s]
[0m22:55:08.055621 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."<default_schema>"."int_enriched_transactions__dbt_backup" cascade
[0m22:55:08.057620 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m22:55:08.059259 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m22:55:08.061108 [debug] [Thread-1 (]: Finished running node model.growth.mart_daily_transactions
[0m22:55:08.065281 [debug] [Thread-3 (]: On model.growth.mart_transaction_summary: Close
[0m22:55:08.066296 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:55:08.070299 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:08.072295 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m22:55:08.076295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5A43460>]}
[0m22:55:08.079125 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: Close
[0m22:55:08.091140 [debug] [Thread-4 (]: Applying DROP to: "nca"."<default_schema>"."fct_users_acquisition__dbt_backup"
[0m22:55:08.094138 [info ] [Thread-1 (]: 13 of 16 START sql view model <default_schema>.int_enriched_users .............. [RUN]
[0m22:55:08.099140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB40973D0>]}
[0m22:55:08.103144 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m22:55:08.105138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.int_enriched_users)
[0m22:55:08.096138 [info ] [Thread-3 (]: 11 of 16 OK created sql table model <default_schema>.mart_transaction_summary .. [[32mSELECT 8[0m in 0.62s]
[0m22:55:08.109142 [info ] [Thread-2 (]: 12 of 16 OK created sql view model <default_schema>.int_enriched_transactions .. [[32mCREATE VIEW[0m in 0.52s]
[0m22:55:08.111140 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."<default_schema>"."fct_users_acquisition__dbt_backup" cascade
[0m22:55:08.113142 [debug] [Thread-1 (]: Began compiling node model.growth.int_enriched_users
[0m22:55:08.116151 [debug] [Thread-3 (]: Finished running node model.growth.mart_transaction_summary
[0m22:55:08.122139 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_transactions
[0m22:55:08.125140 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:55:08.131135 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m22:55:08.134137 [debug] [Thread-3 (]: Began running node model.growth.fct_token_metrics
[0m22:55:08.141140 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: Close
[0m22:55:08.145143 [debug] [Thread-1 (]: Began executing node model.growth.int_enriched_users
[0m22:55:08.147136 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5A5DED0>]}
[0m22:55:08.143138 [info ] [Thread-3 (]: 14 of 16 START sql table model <default_schema>.fct_token_metrics .............. [RUN]
[0m22:55:08.166133 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m22:55:08.156139 [info ] [Thread-4 (]: 9 of 16 OK created sql table model <default_schema>.fct_users_acquisition ...... [[32mSELECT 97[0m in 0.71s]
[0m22:55:08.173153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.fct_token_metrics)
[0m22:55:08.176139 [debug] [Thread-4 (]: Finished running node model.growth.fct_users_acquisition
[0m22:55:08.178139 [debug] [Thread-3 (]: Began compiling node model.growth.fct_token_metrics
[0m22:55:08.180139 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:55:08.279133 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m22:55:08.280137 [debug] [Thread-1 (]: On model.growth.int_enriched_users: BEGIN
[0m22:55:08.281136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:08.283138 [debug] [Thread-3 (]: Began executing node model.growth.fct_token_metrics
[0m22:55:08.297140 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m22:55:08.300140 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:55:08.303145 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: BEGIN
[0m22:55:08.307136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:08.377139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m22:55:08.378150 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:55:08.379136 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."<default_schema>"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."<default_schema>"."dim_users" u
    LEFT JOIN "nca"."<default_schema>"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m22:55:08.388138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:55:08.396137 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:55:08.398139 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."<default_schema>"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m22:55:08.399137 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m22:55:08.401137 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:55:08.403144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:55:08.404137 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."<default_schema>"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."<default_schema>"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m22:55:08.408137 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m22:55:08.410140 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:55:08.411142 [debug] [Thread-1 (]: On model.growth.int_enriched_users: COMMIT
[0m22:55:08.414138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:08.422138 [debug] [Thread-1 (]: Applying DROP to: "nca"."<default_schema>"."int_enriched_users__dbt_backup"
[0m22:55:08.424142 [debug] [Thread-1 (]: Using postgres connection "model.growth.int_enriched_users"
[0m22:55:08.425136 [debug] [Thread-1 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."<default_schema>"."int_enriched_users__dbt_backup" cascade
[0m22:55:08.427137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:55:08.430135 [debug] [Thread-1 (]: On model.growth.int_enriched_users: Close
[0m22:55:08.432139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5BBB010>]}
[0m22:55:08.434138 [info ] [Thread-1 (]: 13 of 16 OK created sql view model <default_schema>.int_enriched_users ......... [[32mCREATE VIEW[0m in 0.33s]
[0m22:55:08.441141 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m22:55:08.443141 [debug] [Thread-2 (]: Began running node model.growth.fct_referral_metrics
[0m22:55:08.444139 [debug] [Thread-4 (]: Began running node model.growth.fct_user_metrics
[0m22:55:08.446136 [info ] [Thread-2 (]: 15 of 16 START sql table model <default_schema>.fct_referral_metrics ........... [RUN]
[0m22:55:08.449136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_referral_metrics)
[0m22:55:08.456138 [debug] [Thread-2 (]: Began compiling node model.growth.fct_referral_metrics
[0m22:55:08.447136 [info ] [Thread-4 (]: 16 of 16 START sql table model <default_schema>.fct_user_metrics ............... [RUN]
[0m22:55:08.474142 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m22:55:08.476138 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_user_metrics)
[0m22:55:08.477140 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_metrics
[0m22:55:08.489164 [debug] [Thread-2 (]: Began executing node model.growth.fct_referral_metrics
[0m22:55:08.495138 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m22:55:08.510138 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m22:55:08.512136 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_metrics
[0m22:55:08.514138 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:55:08.530141 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m22:55:08.531143 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.122 seconds
[0m22:55:08.533138 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: BEGIN
[0m22:55:08.542138 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:55:08.544138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:08.545139 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:55:08.546137 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."<default_schema>"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m22:55:08.548137 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: BEGIN
[0m22:55:08.550139 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:08.554138 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:55:08.559138 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:55:08.561138 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:55:08.563138 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: COMMIT
[0m22:55:08.565138 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:08.576142 [debug] [Thread-3 (]: Applying DROP to: "nca"."<default_schema>"."fct_token_metrics__dbt_backup"
[0m22:55:08.578140 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m22:55:08.580139 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."<default_schema>"."fct_token_metrics__dbt_backup" cascade
[0m22:55:08.582138 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:55:08.588141 [debug] [Thread-3 (]: On model.growth.fct_token_metrics: Close
[0m22:55:08.590139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5AB33A0>]}
[0m22:55:08.593141 [info ] [Thread-3 (]: 14 of 16 OK created sql table model <default_schema>.fct_token_metrics ......... [[32mSELECT 4[0m in 0.42s]
[0m22:55:08.597139 [debug] [Thread-3 (]: Finished running node model.growth.fct_token_metrics
[0m22:55:08.662138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.119 seconds
[0m22:55:08.664139 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:55:08.666139 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."<default_schema>"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."<default_schema>"."dim_referrals" r
    JOIN "nca"."<default_schema>"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."<default_schema>"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m22:55:08.672141 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m22:55:08.673141 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:55:08.675151 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."<default_schema>"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."<default_schema>"."int_enriched_users" u
    LEFT JOIN "nca"."<default_schema>"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m22:55:08.759137 [debug] [Thread-2 (]: SQL status: SELECT 77 in 0.091 seconds
[0m22:55:08.766140 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:55:08.767141 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.090 seconds
[0m22:55:08.770138 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."<default_schema>"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m22:55:08.778136 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:55:08.780137 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."<default_schema>"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m22:55:08.781140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:08.786146 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:55:08.788139 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:55:08.789141 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:55:08.793140 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:55:08.794138 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m22:55:08.795138 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:55:08.797138 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m22:55:08.798138 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:08.807135 [debug] [Thread-2 (]: Applying DROP to: "nca"."<default_schema>"."fct_referral_metrics__dbt_backup"
[0m22:55:08.808134 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m22:55:08.809140 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m22:55:08.815139 [debug] [Thread-4 (]: Applying DROP to: "nca"."<default_schema>"."fct_user_metrics__dbt_backup"
[0m22:55:08.816137 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."<default_schema>"."fct_referral_metrics__dbt_backup" cascade
[0m22:55:08.818138 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m22:55:08.821154 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:55:08.822139 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."<default_schema>"."fct_user_metrics__dbt_backup" cascade
[0m22:55:08.824142 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: Close
[0m22:55:08.827140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB599CB20>]}
[0m22:55:08.828138 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:55:08.836153 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: Close
[0m22:55:08.831138 [info ] [Thread-2 (]: 15 of 16 OK created sql table model <default_schema>.fct_referral_metrics ...... [[32mSELECT 77[0m in 0.38s]
[0m22:55:08.839138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18bdf5c7-bf9c-4603-b54f-8ebb6edff0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB5AFC280>]}
[0m22:55:08.841144 [debug] [Thread-2 (]: Finished running node model.growth.fct_referral_metrics
[0m22:55:08.844141 [info ] [Thread-4 (]: 16 of 16 OK created sql table model <default_schema>.fct_user_metrics .......... [[32mSELECT 200[0m in 0.36s]
[0m22:55:08.848140 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_metrics
[0m22:55:08.855139 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:08.857145 [debug] [MainThread]: On master: BEGIN
[0m22:55:08.858139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:08.941138 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m22:55:08.942141 [debug] [MainThread]: On master: COMMIT
[0m22:55:08.943139 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:08.944139 [debug] [MainThread]: On master: COMMIT
[0m22:55:08.946139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:55:08.946139 [debug] [MainThread]: On master: Close
[0m22:55:08.948137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:08.948137 [debug] [MainThread]: Connection 'create_nca_<default_schema>' was properly closed.
[0m22:55:08.949139 [debug] [MainThread]: Connection 'list_nca_<default_schema>' was properly closed.
[0m22:55:08.950139 [debug] [MainThread]: Connection 'model.growth.int_enriched_users' was properly closed.
[0m22:55:08.952140 [debug] [MainThread]: Connection 'model.growth.fct_referral_metrics' was properly closed.
[0m22:55:08.954141 [debug] [MainThread]: Connection 'model.growth.fct_token_metrics' was properly closed.
[0m22:55:08.955141 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m22:55:08.958170 [info ] [MainThread]: 
[0m22:55:08.959137 [info ] [MainThread]: Finished running 6 table models, 10 view models in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m22:55:08.964135 [debug] [MainThread]: Command end result
[0m22:55:09.043132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:55:09.047142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:55:09.062136 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:55:09.063138 [info ] [MainThread]: 
[0m22:55:09.065138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:09.066139 [info ] [MainThread]: 
[0m22:55:09.067152 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m22:55:09.073136 [debug] [MainThread]: Command `dbt run` succeeded at 22:55:09.072139 after 11.00 seconds
[0m22:55:09.074140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB1BCD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB55F7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB2E49C60>]}
[0m22:55:09.076159 [debug] [MainThread]: Flushing usage events
[0m22:55:11.841091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:34.800215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F3BBD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F5A71720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F5A71510>]}


============================== 22:55:34.804213 | 929dac61-99ba-4154-af27-36010ce361aa ==============================
[0m22:55:34.804213 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:55:34.805215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:35.095218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F5B946D0>]}
[0m22:55:35.184255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F5578B50>]}
[0m22:55:35.186216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:55:35.672214 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:55:36.023219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:36.024218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:36.037214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.intermediate
- models.growth_metrics.marts
- models.growth_metrics.staging
[0m22:55:36.125217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F6309450>]}
[0m22:55:36.299216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:55:36.303214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:55:36.374217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F6311630>]}
[0m22:55:36.375218 [info ] [MainThread]: Found 16 models, 29 data tests, 4 sources, 546 macros
[0m22:55:36.395215 [info ] [MainThread]: 
[0m22:55:36.401217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:36.402216 [info ] [MainThread]: 
[0m22:55:36.404216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:55:36.423218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m22:55:36.584217 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m22:55:36.585216 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m22:55:36.586215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:36.639213 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.054 seconds
[0m22:55:36.641215 [debug] [ThreadPool]: On list_nca: Close
[0m22:55:36.647218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_<default_schema>'
[0m22:55:36.706216 [debug] [ThreadPool]: Using postgres connection "list_nca_<default_schema>"
[0m22:55:36.706216 [debug] [ThreadPool]: On list_nca_<default_schema>: BEGIN
[0m22:55:36.707216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:36.756213 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m22:55:36.757217 [debug] [ThreadPool]: Using postgres connection "list_nca_<default_schema>"
[0m22:55:36.758216 [debug] [ThreadPool]: On list_nca_<default_schema>: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_<default_schema>"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '<default_schema>'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '<default_schema>'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '<default_schema>'
  
[0m22:55:36.765216 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m22:55:36.767216 [debug] [ThreadPool]: On list_nca_<default_schema>: ROLLBACK
[0m22:55:36.768218 [debug] [ThreadPool]: On list_nca_<default_schema>: Close
[0m22:55:36.781221 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:36.782216 [debug] [MainThread]: On master: BEGIN
[0m22:55:36.782216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:36.836216 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m22:55:36.837216 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:36.838216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:55:36.859118 [debug] [MainThread]: SQL status: SELECT 22 in 0.019 seconds
[0m22:55:36.866305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F635F640>]}
[0m22:55:36.867417 [debug] [MainThread]: On master: ROLLBACK
[0m22:55:36.868983 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:36.869517 [debug] [MainThread]: On master: BEGIN
[0m22:55:36.871117 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:55:36.871651 [debug] [MainThread]: On master: COMMIT
[0m22:55:36.872185 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:36.873252 [debug] [MainThread]: On master: COMMIT
[0m22:55:36.874247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:55:36.875285 [debug] [MainThread]: On master: Close
[0m22:55:36.884549 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:55:36.885072 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:55:36.886162 [debug] [Thread-3 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:55:36.886745 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:55:36.887309 [info ] [Thread-1 (]: 1 of 45 START test dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [RUN]
[0m22:55:36.888471 [info ] [Thread-2 (]: 2 of 45 START test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [RUN]
[0m22:55:36.889506 [info ] [Thread-3 (]: 3 of 45 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m22:55:36.890518 [info ] [Thread-4 (]: 4 of 45 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m22:55:36.892142 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80'
[0m22:55:36.893040 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700'
[0m22:55:36.894037 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m22:55:36.895036 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m22:55:36.899041 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:55:36.900043 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:55:36.902041 [debug] [Thread-3 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:55:36.902994 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:55:36.935767 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:55:36.949026 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:55:36.975796 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:55:36.990716 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:55:36.992715 [debug] [Thread-1 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:55:36.993715 [debug] [Thread-2 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:55:37.016112 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:55:37.017109 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:55:37.018114 [debug] [Thread-3 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:55:37.022401 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:55:37.031926 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:55:37.037922 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:55:37.038923 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:55:37.039926 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:55:37.040923 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: BEGIN
[0m22:55:37.041921 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:55:37.042926 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: BEGIN
[0m22:55:37.043925 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:55:37.044922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:37.045923 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m22:55:37.048927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:37.049923 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m22:55:37.050923 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:55:37.051925 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:37.152925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m22:55:37.154924 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m22:55:37.154924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.103 seconds
[0m22:55:37.155927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.111 seconds
[0m22:55:37.156924 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        referred_user_id
    from "nca"."staging"."referrals"
    group by referred_user_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m22:55:37.157924 [debug] [Thread-4 (]: SQL status: BEGIN in 0.107 seconds
[0m22:55:37.157924 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m22:55:37.158922 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m22:55:37.159921 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m22:55:37.160924 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m22:55:37.162926 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:55:37.164926 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date, token
    from "nca"."staging"."market"
    group by date, token
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m22:55:37.165924 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m22:55:37.171921 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: ROLLBACK
[0m22:55:37.171921 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:55:37.173924 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: Close
[0m22:55:37.175922 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m22:55:37.176926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:55:37.177926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:55:37.181928 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m22:55:37.184922 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m22:55:37.179923 [error] [Thread-2 (]: 2 of 45 FAIL 15 dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [[31mFAIL 15[0m in 0.29s]
[0m22:55:37.187920 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: ROLLBACK
[0m22:55:37.190929 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m22:55:37.191936 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m22:55:37.188924 [info ] [Thread-3 (]: 3 of 45 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.29s]
[0m22:55:37.194925 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:55:37.196927 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: Close
[0m22:55:37.199925 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m22:55:37.202923 [debug] [Thread-3 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m22:55:37.201925 [info ] [Thread-4 (]: 4 of 45 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.31s]
[0m22:55:37.204925 [info ] [Thread-2 (]: 5 of 45 START test source_not_null_staging_market_date ......................... [RUN]
[0m22:55:37.206926 [error] [Thread-1 (]: 1 of 45 FAIL 156 dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [[31mFAIL 156[0m in 0.32s]
[0m22:55:37.209926 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:55:37.211938 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m22:55:37.216924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m22:55:37.217926 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m22:55:37.219922 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:55:37.218926 [info ] [Thread-3 (]: 6 of 45 START test source_not_null_staging_market_price ........................ [RUN]
[0m22:55:37.220925 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:55:37.221923 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:55:37.222923 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80' to be skipped because of status 'fail'.  Reason: Got 156 results, configured to fail if != 0.
[0m22:55:37.222923 [info ] [Thread-4 (]: 7 of 45 START test source_not_null_staging_market_token ........................ [RUN]
[0m22:55:37.223923 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m22:55:37.234924 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:55:37.235933 [info ] [Thread-1 (]: 8 of 45 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m22:55:37.237925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m22:55:37.238923 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:55:37.239923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m22:55:37.240928 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:55:37.241922 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:55:37.249924 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:55:37.251928 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:55:37.257925 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:55:37.261922 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:55:37.273928 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:55:37.274923 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:55:37.276924 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:55:37.285926 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:55:37.288923 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:55:37.292923 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:55:37.293926 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:55:37.294924 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m22:55:37.298927 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:55:37.300924 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:55:37.303925 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:55:37.304924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:37.305927 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m22:55:37.307923 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m22:55:37.309926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:37.310926 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:55:37.311930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:37.315925 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m22:55:37.318928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:37.424923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m22:55:37.425926 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m22:55:37.426925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.122 seconds
[0m22:55:37.430925 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m22:55:37.428924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m22:55:37.432926 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m22:55:37.435925 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:37.436926 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:37.439925 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m22:55:37.442923 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m22:55:37.444923 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m22:55:37.445924 [debug] [Thread-4 (]: SQL status: BEGIN in 0.133 seconds
[0m22:55:37.448926 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m22:55:37.450928 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m22:55:37.446924 [error] [Thread-3 (]: 6 of 45 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.22s]
[0m22:55:37.453927 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m22:55:37.452929 [info ] [Thread-2 (]: 5 of 45 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.24s]
[0m22:55:37.454927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.136 seconds
[0m22:55:37.456925 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m22:55:37.458926 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m22:55:37.460926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:37.461925 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m22:55:37.463934 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:55:37.465926 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:55:37.467926 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_market_price.7a0eea0e50' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m22:55:37.470925 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m22:55:37.472925 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m22:55:37.473927 [info ] [Thread-3 (]: 9 of 45 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m22:55:37.475925 [info ] [Thread-2 (]: 10 of 45 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m22:55:37.477926 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m22:55:37.481926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m22:55:37.482925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:55:37.484925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m22:55:37.487927 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:55:37.486928 [info ] [Thread-4 (]: 7 of 45 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.25s]
[0m22:55:37.490929 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m22:55:37.492928 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:55:37.507927 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:55:37.508932 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m22:55:37.509924 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m22:55:37.522927 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:55:37.524926 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:55:37.527924 [info ] [Thread-1 (]: 8 of 45 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.29s]
[0m22:55:37.526926 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:55:37.534929 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m22:55:37.529924 [info ] [Thread-4 (]: 11 of 45 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m22:55:37.541923 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:55:37.542926 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:55:37.543925 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:55:37.544922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m22:55:37.554926 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:55:37.557924 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:55:37.555926 [info ] [Thread-1 (]: 12 of 45 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m22:55:37.559926 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:55:37.571927 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:55:37.572926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m22:55:37.573923 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:55:37.574923 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m22:55:37.576924 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:55:37.576924 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:55:37.577925 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m22:55:37.578923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:37.587925 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:55:37.591923 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:55:37.592923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:37.595925 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:55:37.607924 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:55:37.609926 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:55:37.611927 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:55:37.614928 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m22:55:37.617929 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m22:55:37.618929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:37.620925 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:37.691924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m22:55:37.692924 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m22:55:37.694924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m22:55:37.697934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:37.701920 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m22:55:37.703921 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m22:55:37.705923 [info ] [Thread-3 (]: 9 of 45 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.23s]
[0m22:55:37.708925 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m22:55:37.709925 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:55:37.710924 [info ] [Thread-3 (]: 13 of 45 START test source_not_null_staging_transactions_token ................. [RUN]
[0m22:55:37.712921 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m22:55:37.719923 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:55:37.720923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.128 seconds
[0m22:55:37.733925 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:55:37.735926 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m22:55:37.735926 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m22:55:37.736923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.118 seconds
[0m22:55:37.737921 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m22:55:37.739930 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m22:55:37.740923 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:55:37.740923 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m22:55:37.742923 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m22:55:37.742923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:55:37.751925 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:55:37.753929 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m22:55:37.756925 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m22:55:37.757924 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:55:37.759925 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m22:55:37.762926 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m22:55:37.767925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:55:37.773926 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m22:55:37.774926 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m22:55:37.769925 [error] [Thread-2 (]: 10 of 45 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.28s]
[0m22:55:37.775926 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m22:55:37.779925 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m22:55:37.777926 [error] [Thread-4 (]: 11 of 45 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.23s]
[0m22:55:37.785926 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:55:37.783928 [info ] [Thread-1 (]: 12 of 45 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.21s]
[0m22:55:37.787925 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964' to be skipped because of status 'fail'.  Reason: Got 5 results, configured to fail if != 0.
[0m22:55:37.789926 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m22:55:37.790927 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:55:37.792924 [info ] [Thread-2 (]: 14 of 45 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m22:55:37.794927 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m22:55:37.796924 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:55:37.801924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m22:55:37.802928 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_transactions_amount.a378a55704' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m22:55:37.804924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m22:55:37.805922 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:55:37.806922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:37.806922 [info ] [Thread-4 (]: 15 of 45 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m22:55:37.808923 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:55:37.809922 [info ] [Thread-1 (]: 16 of 45 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m22:55:37.810922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m22:55:37.824924 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:55:37.825923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m22:55:37.827925 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:55:37.829923 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:55:37.849943 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:55:37.856926 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:55:37.857923 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:55:37.867924 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:55:37.868923 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:55:37.872924 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:55:37.873925 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:55:37.875924 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:55:37.884923 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:55:37.886927 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:55:37.887927 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m22:55:37.889924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.082 seconds
[0m22:55:37.890922 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m22:55:37.891924 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:55:37.892927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:37.893923 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m22:55:37.896924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m22:55:37.894923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:37.895922 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m22:55:37.901926 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:37.902925 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:37.906925 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m22:55:37.908925 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m22:55:37.910925 [info ] [Thread-3 (]: 13 of 45 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.20s]
[0m22:55:37.913923 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m22:55:37.915930 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:55:37.917926 [info ] [Thread-3 (]: 17 of 45 START test source_not_null_staging_users_country ...................... [RUN]
[0m22:55:37.919926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m22:55:37.920924 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:55:37.934926 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:55:37.936924 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:55:37.944929 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:55:37.951924 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:55:37.953926 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m22:55:37.954925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:38.015925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m22:55:38.016930 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m22:55:38.018929 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m22:55:38.020931 [debug] [Thread-2 (]: SQL status: BEGIN in 0.128 seconds
[0m22:55:38.021927 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m22:55:38.023928 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:55:38.024925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:55:38.026929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m22:55:38.027924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:38.032930 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m22:55:38.034925 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m22:55:38.038924 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m22:55:38.039925 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m22:55:38.040924 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m22:55:38.042926 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m22:55:38.048926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:55:38.053928 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m22:55:38.043924 [info ] [Thread-1 (]: 16 of 45 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.22s]
[0m22:55:38.055926 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m22:55:38.056925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.102 seconds
[0m22:55:38.058926 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m22:55:38.045926 [info ] [Thread-2 (]: 14 of 45 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.24s]
[0m22:55:38.061926 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m22:55:38.060925 [info ] [Thread-4 (]: 15 of 45 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.25s]
[0m22:55:38.066925 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:55:38.068926 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m22:55:38.069925 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m22:55:38.071926 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m22:55:38.074925 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:55:38.072925 [info ] [Thread-1 (]: 18 of 45 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m22:55:38.076926 [debug] [Thread-4 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:55:38.077926 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:38.080925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m22:55:38.078926 [info ] [Thread-2 (]: 19 of 45 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m22:55:38.084929 [info ] [Thread-4 (]: 20 of 45 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m22:55:38.087924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m22:55:38.088922 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:55:38.089923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m22:55:38.090925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m22:55:38.092924 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m22:55:38.103924 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:55:38.103924 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:55:38.104925 [debug] [Thread-4 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:55:38.106924 [info ] [Thread-3 (]: 17 of 45 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.19s]
[0m22:55:38.129926 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:55:38.126928 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:55:38.120925 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:55:38.134927 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m22:55:38.143925 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:55:38.144925 [debug] [Thread-4 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:55:38.146922 [debug] [Thread-3 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:55:38.151927 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:55:38.158925 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:55:38.159923 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:55:38.160922 [info ] [Thread-3 (]: 21 of 45 START test source_positive_value_staging_market_price ................. [RUN]
[0m22:55:38.169927 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:55:38.170925 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m22:55:38.171925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m22:55:38.173925 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:55:38.174924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:38.176926 [debug] [Thread-3 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:55:38.176926 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:55:38.177922 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m22:55:38.199930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:38.193924 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:55:38.195924 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m22:55:38.202931 [debug] [Thread-3 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:55:38.204926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:38.211925 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:55:38.218924 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:55:38.220926 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m22:55:38.222923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:38.268924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m22:55:38.270927 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m22:55:38.271925 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m22:55:38.274925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:38.278922 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m22:55:38.280923 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m22:55:38.282928 [info ] [Thread-1 (]: 18 of 45 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.20s]
[0m22:55:38.287924 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m22:55:38.289925 [debug] [Thread-1 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:55:38.291925 [debug] [Thread-4 (]: SQL status: BEGIN in 0.093 seconds
[0m22:55:38.291925 [info ] [Thread-1 (]: 22 of 45 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m22:55:38.293925 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m22:55:38.297925 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:55:38.295925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m22:55:38.301926 [debug] [Thread-1 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:55:38.313925 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m22:55:38.318932 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m22:55:38.319924 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m22:55:38.323927 [debug] [Thread-2 (]: SQL status: BEGIN in 0.120 seconds
[0m22:55:38.325923 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m22:55:38.327926 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m22:55:38.321929 [info ] [Thread-4 (]: 20 of 45 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.23s]
[0m22:55:38.335924 [debug] [Thread-4 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m22:55:38.329924 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:55:38.337925 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:38.338925 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:55:38.341922 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m22:55:38.344922 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m22:55:38.347925 [info ] [Thread-2 (]: 19 of 45 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.26s]
[0m22:55:38.343925 [info ] [Thread-4 (]: 23 of 45 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m22:55:38.352925 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m22:55:38.355929 [debug] [Thread-1 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:55:38.356924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m22:55:38.358936 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:55:38.375928 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:55:38.377923 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:55:38.379926 [info ] [Thread-2 (]: 24 of 45 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m22:55:38.383926 [debug] [Thread-3 (]: SQL status: BEGIN in 0.161 seconds
[0m22:55:38.409923 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:55:38.410926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m22:55:38.412923 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:55:38.413923 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m22:55:38.418925 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:55:38.420925 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:55:38.421922 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m22:55:38.422923 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:55:38.429927 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:55:38.436923 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:55:38.437924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:38.440923 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:55:38.441924 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:55:38.443923 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:55:38.451924 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:55:38.455924 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m22:55:38.456923 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m22:55:38.458923 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m22:55:38.460926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:38.461926 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:55:38.463927 [error] [Thread-3 (]: 21 of 45 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.29s]
[0m22:55:38.469927 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m22:55:38.471925 [debug] [Thread-3 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m22:55:38.472925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:38.473927 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:55:38.475927 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_price.1ee4a4b889' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m22:55:38.477926 [info ] [Thread-3 (]: 25 of 45 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m22:55:38.479926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m22:55:38.484936 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:55:38.502928 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:55:38.505926 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:55:38.519924 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:55:38.534927 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:55:38.536927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m22:55:38.538924 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m22:55:38.539926 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m22:55:38.540923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:38.541923 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m22:55:38.545925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:55:38.551932 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m22:55:38.552928 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m22:55:38.554923 [error] [Thread-1 (]: 22 of 45 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.26s]
[0m22:55:38.557925 [debug] [Thread-1 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m22:55:38.558926 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:55:38.560925 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m22:55:38.561926 [info ] [Thread-1 (]: 26 of 45 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m22:55:38.564926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m22:55:38.569928 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:55:38.588925 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:55:38.590924 [debug] [Thread-4 (]: SQL status: BEGIN in 0.131 seconds
[0m22:55:38.592925 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m22:55:38.593924 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:55:38.595926 [debug] [Thread-2 (]: SQL status: BEGIN in 0.123 seconds
[0m22:55:38.597925 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m22:55:38.599926 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:55:38.601927 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:55:38.605925 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m22:55:38.606926 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:55:38.608925 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:55:38.609923 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m22:55:38.611925 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m22:55:38.621924 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:55:38.625925 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m22:55:38.623923 [info ] [Thread-4 (]: 23 of 45 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.27s]
[0m22:55:38.634927 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m22:55:38.636925 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:55:38.637924 [debug] [Thread-4 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:55:38.633935 [info ] [Thread-2 (]: 24 of 45 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.22s]
[0m22:55:38.639923 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m22:55:38.643926 [info ] [Thread-4 (]: 27 of 45 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m22:55:38.646943 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m22:55:38.652925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:38.653923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m22:55:38.657928 [debug] [Thread-4 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:55:38.654922 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:55:38.676925 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:55:38.677927 [debug] [Thread-3 (]: SQL status: BEGIN in 0.137 seconds
[0m22:55:38.680925 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m22:55:38.682933 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:55:38.686923 [debug] [Thread-4 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:55:38.678923 [info ] [Thread-2 (]: 28 of 45 START test source_unique_staging_users_referral_code .................. [RUN]
[0m22:55:38.694926 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:55:38.696925 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m22:55:38.702926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e, now test.growth.source_unique_staging_users_referral_code.184becf50f)
[0m22:55:38.707926 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m22:55:38.708924 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:55:38.710925 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:55:38.712927 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m22:55:38.713929 [debug] [Thread-4 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m22:55:38.724922 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:55:38.726922 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:38.729924 [debug] [Thread-2 (]: Began executing node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:55:38.742923 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:55:38.725924 [info ] [Thread-3 (]: 25 of 45 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.25s]
[0m22:55:38.745925 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m22:55:38.746925 [debug] [Thread-3 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:55:38.751927 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:55:38.753926 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: BEGIN
[0m22:55:38.754927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:38.757932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m22:55:38.759927 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m22:55:38.760924 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:55:38.748925 [info ] [Thread-3 (]: 29 of 45 START test source_unique_staging_users_user_id ........................ [RUN]
[0m22:55:38.763926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m22:55:38.769926 [debug] [Thread-3 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:55:38.770926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:55:38.786924 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m22:55:38.790926 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:55:38.792925 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m22:55:38.796925 [debug] [Thread-3 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:55:38.807925 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:55:38.809924 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:55:38.811925 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m22:55:38.812926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:38.794926 [info ] [Thread-1 (]: 26 of 45 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.23s]
[0m22:55:38.821935 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m22:55:38.823924 [debug] [Thread-1 (]: Began running node model.growth.stg_referrals
[0m22:55:38.825926 [info ] [Thread-1 (]: 30 of 45 SKIP relation <default_schema>.stg_referrals .......................... [[33mSKIP[0m]
[0m22:55:38.839924 [debug] [Thread-1 (]: Finished running node model.growth.stg_referrals
[0m22:55:38.840924 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m22:55:38.841933 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_referrals' to be skipped because of status 'skipped'. 
[0m22:55:38.842923 [info ] [Thread-1 (]: 31 of 45 SKIP relation <default_schema>.stg_market ............................. [[33mSKIP[0m]
[0m22:55:38.846927 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m22:55:38.851926 [debug] [Thread-1 (]: Began running node model.growth.dim_referrals
[0m22:55:38.854925 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_market' to be skipped because of status 'skipped'. 
[0m22:55:38.853927 [info ] [Thread-1 (]: 32 of 45 SKIP relation <default_schema>.dim_referrals .......................... [[33mSKIP[0m]
[0m22:55:38.858923 [debug] [Thread-1 (]: Finished running node model.growth.dim_referrals
[0m22:55:38.859922 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m22:55:38.860924 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_referrals' to be skipped because of status 'skipped'. 
[0m22:55:38.861936 [info ] [Thread-1 (]: 33 of 45 SKIP relation <default_schema>.dim_market ............................. [[33mSKIP[0m]
[0m22:55:38.870929 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m22:55:38.871930 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_market' to be skipped because of status 'skipped'. 
[0m22:55:38.872927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.146 seconds
[0m22:55:38.874923 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m22:55:38.876928 [debug] [Thread-4 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:38.886926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m22:55:38.890923 [debug] [Thread-4 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m22:55:38.891929 [debug] [Thread-4 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m22:55:38.903946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.149 seconds
[0m22:55:38.905925 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m22:55:38.906928 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_referral_code.184becf50f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    referral_code as unique_field,
    count(*) as n_records

from (select * from "nca"."staging"."users" where referral_code is not null) dbt_subquery
where referral_code is not null
group by referral_code
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:38.894926 [error] [Thread-4 (]: 27 of 45 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.24s]
[0m22:55:38.910926 [debug] [Thread-4 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m22:55:38.911924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:55:38.912924 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' to be skipped because of status 'fail'.  Reason: Got 10 results, configured to fail if != 0.
[0m22:55:38.916929 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: ROLLBACK
[0m22:55:38.919937 [debug] [Thread-1 (]: Began running node model.growth.stg_transactions
[0m22:55:38.921926 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: Close
[0m22:55:38.922928 [info ] [Thread-1 (]: 34 of 45 SKIP relation <default_schema>.stg_transactions ....................... [[33mSKIP[0m]
[0m22:55:38.925922 [debug] [Thread-1 (]: Finished running node model.growth.stg_transactions
[0m22:55:38.924925 [info ] [Thread-2 (]: 28 of 45 PASS source_unique_staging_users_referral_code ........................ [[32mPASS[0m in 0.22s]
[0m22:55:38.927925 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_transactions' to be skipped because of status 'skipped'. 
[0m22:55:38.929926 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m22:55:38.934925 [debug] [Thread-4 (]: Began running node model.growth.dim_transactions
[0m22:55:38.936931 [debug] [Thread-2 (]: Began running node model.growth.mart_daily_transactions
[0m22:55:38.937926 [info ] [Thread-4 (]: 35 of 45 SKIP relation <default_schema>.dim_transactions ....................... [[33mSKIP[0m]
[0m22:55:38.940926 [debug] [Thread-4 (]: Finished running node model.growth.dim_transactions
[0m22:55:38.944925 [debug] [Thread-4 (]: Began running node model.growth.mart_transaction_summary
[0m22:55:38.955925 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_transactions' to be skipped because of status 'skipped'. 
[0m22:55:38.939925 [info ] [Thread-2 (]: 36 of 45 SKIP relation <default_schema>.mart_daily_transactions ................ [[33mSKIP[0m]
[0m22:55:38.957923 [debug] [Thread-2 (]: Finished running node model.growth.mart_daily_transactions
[0m22:55:38.975923 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'skipped'. 
[0m22:55:38.978927 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_transactions
[0m22:55:38.945928 [info ] [Thread-4 (]: 37 of 45 SKIP relation <default_schema>.mart_transaction_summary ............... [[33mSKIP[0m]
[0m22:55:38.988927 [debug] [Thread-4 (]: Finished running node model.growth.mart_transaction_summary
[0m22:55:38.989928 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_transaction_summary' to be skipped because of status 'skipped'. 
[0m22:55:38.986929 [info ] [Thread-1 (]: 38 of 45 SKIP relation <default_schema>.int_enriched_transactions .............. [[33mSKIP[0m]
[0m22:55:38.992927 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_transactions
[0m22:55:38.994926 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_transactions' to be skipped because of status 'skipped'. 
[0m22:55:38.995928 [debug] [Thread-2 (]: Began running node model.growth.fct_token_metrics
[0m22:55:39.003925 [info ] [Thread-2 (]: 39 of 45 SKIP relation <default_schema>.fct_token_metrics ...................... [[33mSKIP[0m]
[0m22:55:39.005930 [debug] [Thread-2 (]: Finished running node model.growth.fct_token_metrics
[0m22:55:39.006925 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_token_metrics' to be skipped because of status 'skipped'. 
[0m22:55:39.008927 [debug] [Thread-3 (]: SQL status: BEGIN in 0.196 seconds
[0m22:55:39.010927 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m22:55:39.011927 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:39.018926 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:55:39.021923 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m22:55:39.023925 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m22:55:39.025924 [info ] [Thread-3 (]: 29 of 45 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.26s]
[0m22:55:39.039926 [debug] [Thread-3 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m22:55:39.055928 [debug] [Thread-1 (]: Began running node model.growth.stg_users
[0m22:55:39.056926 [info ] [Thread-1 (]: 40 of 45 START sql view model <default_schema>.stg_users ....................... [RUN]
[0m22:55:39.073927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4, now model.growth.stg_users)
[0m22:55:39.074927 [debug] [Thread-1 (]: Began compiling node model.growth.stg_users
[0m22:55:39.088929 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_users"
[0m22:55:39.090926 [debug] [Thread-1 (]: Began executing node model.growth.stg_users
[0m22:55:39.188977 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_users"
[0m22:55:39.191156 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.192766 [debug] [Thread-1 (]: On model.growth.stg_users: BEGIN
[0m22:55:39.193842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:39.259315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m22:55:39.261022 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.262066 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."<default_schema>"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m22:55:39.269612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:55:39.285966 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.287146 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."<default_schema>"."stg_users" rename to "stg_users__dbt_backup"
[0m22:55:39.289204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:39.389810 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.391811 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."<default_schema>"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:55:39.392809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:39.435807 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m22:55:39.437812 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.439810 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m22:55:39.440809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:39.455812 [debug] [Thread-1 (]: Applying DROP to: "nca"."<default_schema>"."stg_users__dbt_backup"
[0m22:55:39.461812 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m22:55:39.462809 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."<default_schema>"."stg_users__dbt_backup" cascade
[0m22:55:39.470808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:55:39.472808 [debug] [Thread-1 (]: On model.growth.stg_users: Close
[0m22:55:39.477810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F7C7A710>]}
[0m22:55:39.479813 [info ] [Thread-1 (]: 40 of 45 OK created sql view model <default_schema>.stg_users .................. [[32mCREATE VIEW[0m in 0.40s]
[0m22:55:39.481808 [debug] [Thread-1 (]: Finished running node model.growth.stg_users
[0m22:55:39.484810 [debug] [Thread-2 (]: Began running node model.growth.dim_users
[0m22:55:39.485811 [debug] [Thread-3 (]: Began running node model.growth.fct_users_acquisition
[0m22:55:39.487809 [info ] [Thread-2 (]: 41 of 45 START sql view model <default_schema>.dim_users ....................... [RUN]
[0m22:55:39.488809 [info ] [Thread-3 (]: 42 of 45 SKIP relation <default_schema>.fct_users_acquisition .................. [[33mSKIP[0m]
[0m22:55:39.490815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_users_referral_code.184becf50f, now model.growth.dim_users)
[0m22:55:39.491814 [debug] [Thread-3 (]: Finished running node model.growth.fct_users_acquisition
[0m22:55:39.493812 [debug] [Thread-2 (]: Began compiling node model.growth.dim_users
[0m22:55:39.494809 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'skipped'. 
[0m22:55:39.505805 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_users"
[0m22:55:39.507811 [debug] [Thread-2 (]: Began executing node model.growth.dim_users
[0m22:55:39.519812 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_users"
[0m22:55:39.522831 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:39.524808 [debug] [Thread-2 (]: On model.growth.dim_users: BEGIN
[0m22:55:39.525810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:39.579808 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m22:55:39.579808 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:39.580811 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."<default_schema>"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."<default_schema>"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m22:55:39.586808 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:55:39.590807 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:39.591805 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."<default_schema>"."dim_users__dbt_tmp" rename to "dim_users"
[0m22:55:39.592810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:55:39.594806 [debug] [Thread-2 (]: On model.growth.dim_users: COMMIT
[0m22:55:39.594806 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:39.595807 [debug] [Thread-2 (]: On model.growth.dim_users: COMMIT
[0m22:55:39.596808 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:55:39.603805 [debug] [Thread-2 (]: Applying DROP to: "nca"."<default_schema>"."dim_users__dbt_backup"
[0m22:55:39.604808 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_users"
[0m22:55:39.604808 [debug] [Thread-2 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."<default_schema>"."dim_users__dbt_backup" cascade
[0m22:55:39.606808 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:55:39.608806 [debug] [Thread-2 (]: On model.growth.dim_users: Close
[0m22:55:39.609808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929dac61-99ba-4154-af27-36010ce361aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F6B04DC0>]}
[0m22:55:39.610812 [info ] [Thread-2 (]: 41 of 45 OK created sql view model <default_schema>.dim_users .................. [[32mCREATE VIEW[0m in 0.12s]
[0m22:55:39.613810 [debug] [Thread-2 (]: Finished running node model.growth.dim_users
[0m22:55:39.614807 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m22:55:39.616818 [info ] [Thread-1 (]: 43 of 45 SKIP relation <default_schema>.int_enriched_users ..................... [[33mSKIP[0m]
[0m22:55:39.618809 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m22:55:39.619810 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_users' to be skipped because of status 'skipped'. 
[0m22:55:39.622814 [debug] [Thread-3 (]: Began running node model.growth.fct_referral_metrics
[0m22:55:39.622814 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m22:55:39.623810 [info ] [Thread-3 (]: 44 of 45 SKIP relation <default_schema>.fct_referral_metrics ................... [[33mSKIP[0m]
[0m22:55:39.624807 [info ] [Thread-2 (]: 45 of 45 SKIP relation <default_schema>.fct_user_metrics ....................... [[33mSKIP[0m]
[0m22:55:39.625810 [debug] [Thread-3 (]: Finished running node model.growth.fct_referral_metrics
[0m22:55:39.626807 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m22:55:39.627807 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referral_metrics' to be skipped because of status 'skipped'. 
[0m22:55:39.628806 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_metrics' to be skipped because of status 'skipped'. 
[0m22:55:39.629806 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:39.630809 [debug] [MainThread]: On master: BEGIN
[0m22:55:39.631807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:39.689809 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m22:55:39.690808 [debug] [MainThread]: On master: COMMIT
[0m22:55:39.690808 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:39.691807 [debug] [MainThread]: On master: COMMIT
[0m22:55:39.691807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:55:39.692806 [debug] [MainThread]: On master: Close
[0m22:55:39.693807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:39.694809 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m22:55:39.694809 [debug] [MainThread]: Connection 'list_nca_<default_schema>' was properly closed.
[0m22:55:39.695809 [debug] [MainThread]: Connection 'model.growth.stg_users' was properly closed.
[0m22:55:39.697811 [debug] [MainThread]: Connection 'model.growth.dim_users' was properly closed.
[0m22:55:39.697811 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m22:55:39.699811 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' was properly closed.
[0m22:55:39.701814 [info ] [MainThread]: 
[0m22:55:39.703808 [info ] [MainThread]: Finished running 6 table models, 29 data tests, 10 view models in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m22:55:39.711804 [debug] [MainThread]: Command end result
[0m22:55:39.770804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m22:55:39.773806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m22:55:39.786807 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m22:55:39.787806 [info ] [MainThread]: 
[0m22:55:39.788808 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m22:55:39.789809 [info ] [MainThread]: 
[0m22:55:39.790808 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id (models\staging\schema.yml)[0m
[0m22:55:39.791809 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:55:39.792810 [info ] [MainThread]: 
[0m22:55:39.794810 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_ce21451ab51663af294524ce4a7e56fa.sql
[0m22:55:39.796808 [info ] [MainThread]: 
[0m22:55:39.800811 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_market_date__token (models\staging\schema.yml)[0m
[0m22:55:39.803810 [error] [MainThread]:   Got 156 results, configured to fail if != 0
[0m22:55:39.804807 [info ] [MainThread]: 
[0m22:55:39.805807 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_3a255a5db84d348db66273d767faeca9.sql
[0m22:55:39.806809 [info ] [MainThread]: 
[0m22:55:39.807809 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m22:55:39.808810 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:55:39.809808 [info ] [MainThread]: 
[0m22:55:39.811811 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m22:55:39.812810 [info ] [MainThread]: 
[0m22:55:39.814808 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m22:55:39.820812 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m22:55:39.821816 [info ] [MainThread]: 
[0m22:55:39.823808 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m22:55:39.824808 [info ] [MainThread]: 
[0m22:55:39.825807 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:55:39.827808 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:55:39.828810 [info ] [MainThread]: 
[0m22:55:39.829809 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m22:55:39.831808 [info ] [MainThread]: 
[0m22:55:39.837816 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m22:55:39.838809 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m22:55:39.839810 [info ] [MainThread]: 
[0m22:55:39.840810 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m22:55:39.841809 [info ] [MainThread]: 
[0m22:55:39.843810 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m22:55:39.844809 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m22:55:39.845809 [info ] [MainThread]: 
[0m22:55:39.846810 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m22:55:39.847809 [info ] [MainThread]: 
[0m22:55:39.853816 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m22:55:39.854808 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m22:55:39.855810 [info ] [MainThread]: 
[0m22:55:39.856810 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m22:55:39.858812 [info ] [MainThread]: 
[0m22:55:39.859808 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=8 SKIP=14 TOTAL=45
[0m22:55:39.861811 [debug] [MainThread]: Command `dbt build` failed at 22:55:39.860808 after 5.24 seconds
[0m22:55:39.861811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F3BBD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F3E838E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147F7B5A8F0>]}
[0m22:55:39.862809 [debug] [MainThread]: Flushing usage events
[0m22:55:40.856711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:54.348584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35533D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3571E9600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3571E9420>]}


============================== 22:57:54.355585 | 03e4a1f0-83f4-4db2-a862-7375efa2ee58 ==============================
[0m22:57:54.355585 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:57:54.356582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:54.587583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03e4a1f0-83f4-4db2-a862-7375efa2ee58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E353B136A0>]}
[0m22:57:54.761588 [debug] [MainThread]: Command `dbt clean` succeeded at 22:57:54.761588 after 0.56 seconds
[0m22:57:54.762584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35533D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3571C55A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E357221780>]}
[0m22:57:54.763583 [debug] [MainThread]: Flushing usage events
[0m22:57:56.175336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:04.808395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024019DCD060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401BC7D540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401BC7D330>]}


============================== 22:58:04.815394 | 1263dab0-c076-42a6-b819-1cbf815eee1e ==============================
[0m22:58:04.815394 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:58:04.817393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:58:05.151389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1263dab0-c076-42a6-b819-1cbf815eee1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401BD8E320>]}
[0m22:58:05.238394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1263dab0-c076-42a6-b819-1cbf815eee1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401B7EB6D0>]}
[0m22:58:05.240396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:58:05.708392 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m22:58:05.710396 [debug] [MainThread]: Command `dbt run` failed at 22:58:05.710396 after 1.04 seconds
[0m22:58:05.713396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024019DCD060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401915FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401915FD00>]}
[0m22:58:05.714393 [debug] [MainThread]: Flushing usage events
[0m22:58:06.619874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:15.365904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29AA2D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29C8D9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29C8D9210>]}


============================== 22:58:15.369841 | 40ddda4a-2a8c-4a5a-be7a-c0eb78d3a9f6 ==============================
[0m22:58:15.369841 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:58:15.371849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:15.578843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40ddda4a-2a8c-4a5a-be7a-c0eb78d3a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29CA09CF0>]}
[0m22:58:15.630842 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-4u4jdo75'
[0m22:58:15.631843 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:58:17.255252 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:58:17.257319 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:58:17.965712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:58:17.970708 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:58:20.337329 [error] [MainThread]: Encountered an error:
[WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1\\integration_tests'
[0m22:58:20.383349 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 816, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1' -> 'dbt_packages\\dbt_utils'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\task\deps.py", line 254, in run
    package.install(self.project, renderer)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\registry.py", line 63, in install
    self._install(project, renderer)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\base.py", line 121, in _install
    connection_exception_retry(download_untar_fn, 5)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\utils\connection.py", line 21, in connection_exception_retry
    return fn()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\base.py", line 133, in download_and_untar
    system.untar_package(tar_path, deps_path, package_name)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 646, in untar_package
    dbt_common.clients.system.rename(downloaded_path, desired_path, force=True)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 609, in rename
    shutil.move(from_path, to_path)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 834, in move
    rmtree(src)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 750, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 615, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 624, in _rmtree_unsafe
    onerror(os.rmdir, path, sys.exc_info())
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 622, in _rmtree_unsafe
    os.rmdir(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1\\integration_tests'

[0m22:58:20.438337 [debug] [MainThread]: Command `dbt deps` failed at 22:58:20.437339 after 5.21 seconds
[0m22:58:20.439332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29AA2D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C299D5EDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C299D5D660>]}
[0m22:58:20.448335 [debug] [MainThread]: Flushing usage events
[0m22:58:21.421332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:35.265010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD909ED180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9289D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9289D570>]}


============================== 22:58:35.273670 | 7d2adb9b-6e83-4afe-bd3d-6e5f5f03c6e9 ==============================
[0m22:58:35.273670 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:58:35.277677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:58:35.789874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2adb9b-6e83-4afe-bd3d-6e5f5f03c6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8F9BF700>]}
[0m22:58:35.910879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2adb9b-6e83-4afe-bd3d-6e5f5f03c6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9235BDC0>]}
[0m22:58:35.913928 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:58:36.603871 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1\dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1
[0m22:58:36.607874 [debug] [MainThread]: Command `dbt run` failed at 22:58:36.606873 after 1.62 seconds
[0m22:58:36.611878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD909ED180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8FD56380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8FD57BB0>]}
[0m22:58:36.612877 [debug] [MainThread]: Flushing usage events
[0m22:58:37.553632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:21.528223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BC6CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BE57D6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BE57D510>]}


============================== 22:59:21.532220 | fd39e089-9806-4a50-be38-470566a8ee10 ==============================
[0m22:59:21.532220 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:59:21.534222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:59:21.835220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd39e089-9806-4a50-be38-470566a8ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BC97B610>]}
[0m22:59:21.925262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd39e089-9806-4a50-be38-470566a8ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BE5881F0>]}
[0m22:59:21.926264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:59:22.453965 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1\dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1
[0m22:59:22.458966 [debug] [MainThread]: Command `dbt run` failed at 22:59:22.458966 after 1.07 seconds
[0m22:59:22.459963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BC6CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BBA3A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BBA3B250>]}
[0m22:59:22.460965 [debug] [MainThread]: Flushing usage events
[0m22:59:23.661677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:42.832360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6897FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68B6A94E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68B6A92D0>]}


============================== 23:01:42.838360 | 668061fa-e942-4c5f-983f-d2afbea24c80 ==============================
[0m23:01:42.838360 [info ] [MainThread]: Running with dbt=1.9.1
[0m23:01:42.839361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:01:43.102605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668061fa-e942-4c5f-983f-d2afbea24c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68B6E28F0>]}
[0m23:01:43.443912 [debug] [MainThread]: Command `dbt clean` succeeded at 23:01:43.443912 after 0.77 seconds
[0m23:01:43.444916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6897FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68B6E0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68B6E1990>]}
[0m23:01:43.446916 [debug] [MainThread]: Flushing usage events
[0m23:01:45.653224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:48.588268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258935CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895479600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895479420>]}


============================== 23:01:48.592265 | 05783299-b3af-4f4b-be54-cf847db74348 ==============================
[0m23:01:48.592265 [info ] [MainThread]: Running with dbt=1.9.1
[0m23:01:48.594266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:01:48.876707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05783299-b3af-4f4b-be54-cf847db74348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025891DA36A0>]}
[0m23:01:48.913706 [error] [MainThread]: Encountered an error:
[WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'
[0m23:01:48.920710 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 622, in _rmtree_unsafe
    os.rmdir(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\task\deps.py", line 227, in run
    system.rmtree(self.project.packages_install_path)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 750, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 615, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 624, in _rmtree_unsafe
    onerror(os.rmdir, path, sys.exc_info())
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 661, in chmod_and_retry
    func(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'

[0m23:01:48.927705 [debug] [MainThread]: Command `dbt deps` failed at 23:01:48.927705 after 0.49 seconds
[0m23:01:48.928708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258935CD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589289BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589289B790>]}
[0m23:01:48.929704 [debug] [MainThread]: Flushing usage events
[0m23:01:49.874387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:25.889355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367C10D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367DFB9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367DFB9210>]}


============================== 23:05:25.895357 | aba59609-0595-4415-9fdf-e9a5d718b050 ==============================
[0m23:05:25.895357 [info ] [MainThread]: Running with dbt=1.9.1
[0m23:05:25.897318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:26.212317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba59609-0595-4415-9fdf-e9a5d718b050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367E0E9CF0>]}
[0m23:05:26.271323 [error] [MainThread]: Encountered an error:
[WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'
[0m23:05:26.277316 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 622, in _rmtree_unsafe
    os.rmdir(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\task\deps.py", line 227, in run
    system.rmtree(self.project.packages_install_path)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 750, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 615, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 624, in _rmtree_unsafe
    onerror(os.rmdir, path, sys.exc_info())
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 661, in chmod_and_retry
    func(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.1.1'

[0m23:05:26.283320 [debug] [MainThread]: Command `dbt deps` failed at 23:05:26.283320 after 0.55 seconds
[0m23:05:26.284321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367C10D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367B3CBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001367B3CB700>]}
[0m23:05:26.288336 [debug] [MainThread]: Flushing usage events
[0m23:05:27.613102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:20.565349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154509CD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001545287D600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001545287D3F0>]}


============================== 08:28:20.565349 | b88f674d-1a47-467b-a887-1fbba7a0bfb9 ==============================
[0m08:28:20.565349 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:28:20.565349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:28:21.006924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88f674d-1a47-467b-a887-1fbba7a0bfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001544F19F6D0>]}
[0m08:28:21.116308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88f674d-1a47-467b-a887-1fbba7a0bfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001545233B940>]}
[0m08:28:21.116308 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:28:21.601767 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1\dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in C:\Users\musta\Documents\GrowthMetrics\dbt_packages\dbt-utils-1.1.1
[0m08:28:21.617389 [debug] [MainThread]: Command `dbt run` failed at 08:28:21.617389 after 1.20 seconds
[0m08:28:21.617389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154509CD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001544FD5E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001544FD5C490>]}
[0m08:28:21.617389 [debug] [MainThread]: Flushing usage events
[0m08:28:23.052270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:47.211250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FD8FD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FF7A9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FF7A9270>]}


============================== 08:29:47.226833 | 39e0846f-d182-4ce2-9682-0eca8712306d ==============================
[0m08:29:47.226833 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:29:47.226833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:29:47.478469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39e0846f-d182-4ce2-9682-0eca8712306d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FF7AA560>]}
[0m08:29:47.572168 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-t8kkqeqy'
[0m08:29:47.572168 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:29:48.418978 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:29:48.434605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:29:48.781377 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:29:48.796921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:29:50.381207 [info ] [MainThread]: Installed from version 1.1.1
[0m08:29:50.381207 [info ] [MainThread]: Updated version available: 1.3.0
[0m08:29:50.381207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '39e0846f-d182-4ce2-9682-0eca8712306d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FDB9FA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FCC1C3D0>]}
[0m08:29:50.381207 [info ] [MainThread]: 
[0m08:29:50.381207 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m08:29:50.394797 [debug] [MainThread]: Command `dbt deps` succeeded at 08:29:50.394797 after 3.32 seconds
[0m08:29:50.395806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FD8FD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FF7A8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FDB9FA30>]}
[0m08:29:50.398116 [debug] [MainThread]: Flushing usage events
[0m08:29:51.637483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:31:14.940376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4BBD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF6A69480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF6A69270>]}


============================== 08:31:14.946898 | 37a50f52-63a1-433e-a694-626465a5e316 ==============================
[0m08:31:14.946898 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:31:14.948182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:31:15.174370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a50f52-63a1-433e-a694-626465a5e316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF6A6A560>]}
[0m08:31:15.289701 [debug] [MainThread]: Command `dbt clean` succeeded at 08:31:15.289701 after 0.50 seconds
[0m08:31:15.289701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4BBD120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF6A68940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF6B43A30>]}
[0m08:31:15.289701 [debug] [MainThread]: Flushing usage events
[0m08:31:16.461651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:31:23.981025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510987D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510B729480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510B729270>]}


============================== 08:31:23.997560 | fc8543b4-4b54-451b-8a07-d05400315b36 ==============================
[0m08:31:23.997560 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:31:23.997560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m08:31:24.187544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8543b4-4b54-451b-8a07-d05400315b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510B72A560>]}
[0m08:31:24.218796 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-z06n9byw'
[0m08:31:24.218796 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:31:24.812223 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:31:24.812223 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:31:25.221396 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:31:25.299469 [info ] [MainThread]: Updating lock file in file path: C:\Users\musta\Documents\GrowthMetrics/package-lock.yml
[0m08:31:25.299469 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-0_47oqsc'
[0m08:31:25.320067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:31:34.506470 [error] [MainThread]: Encountered an error:
[WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.3.0\\integration_tests'
[0m08:31:34.537703 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 816, in move
    os.rename(src, real_dst)
PermissionError: [WinError 5] Access is denied: 'dbt_packages\\dbt-utils-1.3.0' -> 'dbt_packages\\dbt_utils'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\task\deps.py", line 254, in run
    package.install(self.project, renderer)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\registry.py", line 63, in install
    self._install(project, renderer)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\base.py", line 121, in _install
    connection_exception_retry(download_untar_fn, 5)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\utils\connection.py", line 21, in connection_exception_retry
    return fn()
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt\deps\base.py", line 133, in download_and_untar
    system.untar_package(tar_path, deps_path, package_name)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 646, in untar_package
    dbt_common.clients.system.rename(downloaded_path, desired_path, force=True)
  File "C:\Users\musta\Documents\GrowthMetrics\dbt_env\lib\site-packages\dbt_common\clients\system.py", line 609, in rename
    shutil.move(from_path, to_path)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 834, in move
    rmtree(src)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 750, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 615, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 624, in _rmtree_unsafe
    onerror(os.rmdir, path, sys.exc_info())
  File "C:\Users\musta\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 622, in _rmtree_unsafe
    os.rmdir(path)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'dbt_packages\\dbt-utils-1.3.0\\integration_tests'

[0m08:31:34.558295 [debug] [MainThread]: Command `dbt deps` failed at 08:31:34.557295 after 10.70 seconds
[0m08:31:34.559294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510987D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025109B20B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108BAAB30>]}
[0m08:31:34.560297 [debug] [MainThread]: Flushing usage events
[0m08:31:35.591069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:55.623235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13B5191B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13D3C9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13D3C9300>]}


============================== 08:35:55.627236 | 1972e399-f246-4f9c-80af-1ae0b8c3a74c ==============================
[0m08:35:55.627236 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:35:55.628237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:35:55.811957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1972e399-f246-4f9c-80af-1ae0b8c3a74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13D4FAA40>]}
[0m08:35:55.838980 [debug] [MainThread]: Command `dbt clean` succeeded at 08:35:55.838980 after 0.34 seconds
[0m08:35:55.838980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13B5191B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13D4FA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D13D4FA680>]}
[0m08:35:55.839979 [debug] [MainThread]: Flushing usage events
[0m08:35:57.887665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:12.587055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC6C7D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC8B29600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC8B29420>]}


============================== 08:36:12.591095 | b0464589-df15-4915-b7a7-a777831f0e6c ==============================
[0m08:36:12.591095 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:36:12.592056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:36:12.776439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0464589-df15-4915-b7a7-a777831f0e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC54536A0>]}
[0m08:36:12.811751 [debug] [MainThread]: Set downloads directory='C:\Users\musta\AppData\Local\Temp\dbt-downloads-lh4tamr8'
[0m08:36:12.812753 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:36:13.674864 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:36:13.677864 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:36:13.994890 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:36:14.003938 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:36:18.599198 [info ] [MainThread]: Installed from version 1.3.0
[0m08:36:18.600201 [info ] [MainThread]: Up to date!
[0m08:36:18.601203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b0464589-df15-4915-b7a7-a777831f0e6c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC6F13A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC5FA8220>]}
[0m08:36:18.603201 [debug] [MainThread]: Command `dbt deps` succeeded at 08:36:18.603201 after 6.14 seconds
[0m08:36:18.604241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC6C7D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC8B055A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC6F10130>]}
[0m08:36:18.604241 [debug] [MainThread]: Flushing usage events
[0m08:36:19.648823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:31.232309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020249D6D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024BC1D6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024BC1D4E0>]}


============================== 08:36:31.238270 | b9e65323-d78d-42ce-8f7d-4783d1c2ab16 ==============================
[0m08:36:31.238270 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:36:31.239271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:36:31.522346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024BBF9C30>]}
[0m08:36:31.599486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024B6D9C90>]}
[0m08:36:31.602937 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:36:31.982518 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:36:31.983518 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:36:31.984519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020249101150>]}
[0m08:36:34.240918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.intermediate
- models.growth_metrics.marts
[0m08:36:34.262058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D7C1ED0>]}
[0m08:36:34.413301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m08:36:34.418300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m08:36:34.456131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D77A5C0>]}
[0m08:36:34.457129 [info ] [MainThread]: Found 16 models, 29 data tests, 4 sources, 548 macros
[0m08:36:34.458128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D77A5F0>]}
[0m08:36:34.461126 [info ] [MainThread]: 
[0m08:36:34.462127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:34.463127 [info ] [MainThread]: 
[0m08:36:34.464128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:36:34.473332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m08:36:34.691568 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m08:36:34.692567 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m08:36:34.693567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:34.763066 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.070 seconds
[0m08:36:34.764025 [debug] [ThreadPool]: On list_nca: Close
[0m08:36:34.766024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nca, now create_nca_marts)
[0m08:36:34.767026 [debug] [ThreadPool]: Creating schema "database: "nca"
schema: "marts"
"
[0m08:36:34.776115 [debug] [ThreadPool]: Using postgres connection "create_nca_marts"
[0m08:36:34.776115 [debug] [ThreadPool]: On create_nca_marts: BEGIN
[0m08:36:34.777119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:34.824373 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m08:36:34.825416 [debug] [ThreadPool]: Using postgres connection "create_nca_marts"
[0m08:36:34.825416 [debug] [ThreadPool]: On create_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "create_nca_marts"} */
create schema if not exists "marts"
[0m08:36:34.832371 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m08:36:34.834373 [debug] [ThreadPool]: On create_nca_marts: COMMIT
[0m08:36:34.834373 [debug] [ThreadPool]: Using postgres connection "create_nca_marts"
[0m08:36:34.835372 [debug] [ThreadPool]: On create_nca_marts: COMMIT
[0m08:36:34.836372 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:36:34.836372 [debug] [ThreadPool]: On create_nca_marts: Close
[0m08:36:34.842635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m08:36:34.849675 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m08:36:34.849675 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m08:36:34.850674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:34.897196 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m08:36:34.898237 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m08:36:34.898237 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m08:36:34.910719 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m08:36:34.912722 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m08:36:34.913720 [debug] [ThreadPool]: On list_nca_marts: Close
[0m08:36:34.920719 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.923821 [debug] [MainThread]: On master: BEGIN
[0m08:36:34.923821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:34.969221 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m08:36:34.970266 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.970266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:36:34.985245 [debug] [MainThread]: SQL status: SELECT 10 in 0.014 seconds
[0m08:36:34.986246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C5C1600>]}
[0m08:36:34.987246 [debug] [MainThread]: On master: ROLLBACK
[0m08:36:34.989000 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.990541 [debug] [MainThread]: On master: BEGIN
[0m08:36:34.991542 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:36:34.992541 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.993540 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.993540 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.994539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:34.994539 [debug] [MainThread]: On master: Close
[0m08:36:35.001540 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m08:36:35.001540 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m08:36:35.002539 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m08:36:35.002539 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m08:36:35.003580 [info ] [Thread-1 (]: 1 of 16 START sql view model marts.stg_market .................................. [RUN]
[0m08:36:35.006553 [info ] [Thread-2 (]: 2 of 16 START sql view model marts.stg_referrals ............................... [RUN]
[0m08:36:35.008432 [info ] [Thread-3 (]: 3 of 16 START sql view model marts.stg_transactions ............................ [RUN]
[0m08:36:35.010434 [info ] [Thread-4 (]: 4 of 16 START sql view model marts.stg_users ................................... [RUN]
[0m08:36:35.011433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m08:36:35.011433 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m08:36:35.012439 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m08:36:35.013433 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m08:36:35.014432 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m08:36:35.014432 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m08:36:35.015433 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m08:36:35.015433 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m08:36:35.027099 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m08:36:35.031097 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m08:36:35.035100 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m08:36:35.042171 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m08:36:35.044170 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m08:36:35.045171 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m08:36:35.056321 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m08:36:35.057324 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m08:36:35.090068 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m08:36:35.094068 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m08:36:35.099068 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m08:36:35.103065 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m08:36:35.107559 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m08:36:35.107559 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m08:36:35.108549 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m08:36:35.108549 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m08:36:35.109547 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m08:36:35.109547 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m08:36:35.110548 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:36:35.111547 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m08:36:35.111547 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m08:36:35.112547 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:36:35.113547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:35.113547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:36:35.200948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m08:36:35.201947 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m08:36:35.202949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m08:36:35.203945 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."marts"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m08:36:35.205944 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m08:36:35.208257 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m08:36:35.210258 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m08:36:35.211258 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m08:36:35.212259 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m08:36:35.213257 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."marts"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m08:36:35.215258 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m08:36:35.216258 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."marts"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m08:36:35.221257 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:36:35.221257 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:36:35.223641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m08:36:35.224639 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m08:36:35.231636 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m08:36:35.236639 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m08:36:35.242770 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m08:36:35.245772 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m08:36:35.246772 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m08:36:35.247773 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:36:35.247773 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market__dbt_tmp" rename to "stg_market"
[0m08:36:35.248771 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m08:36:35.250774 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.251772 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:36:35.251772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:36:35.251772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:36:35.268369 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m08:36:35.270374 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m08:36:35.272475 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m08:36:35.274736 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m08:36:35.275735 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m08:36:35.276734 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m08:36:35.276734 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m08:36:35.277734 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m08:36:35.277734 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m08:36:35.278735 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m08:36:35.278735 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m08:36:35.279735 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m08:36:35.280735 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.281737 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.281737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:35.282733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:35.291074 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m08:36:35.294054 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_transactions__dbt_backup"
[0m08:36:35.298051 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_market__dbt_backup"
[0m08:36:35.302052 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."stg_referrals__dbt_backup"
[0m08:36:35.308452 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m08:36:35.309453 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m08:36:35.310450 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m08:36:35.310450 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m08:36:35.311451 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m08:36:35.312452 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."marts"."stg_transactions__dbt_backup" cascade
[0m08:36:35.312452 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."marts"."stg_market__dbt_backup" cascade
[0m08:36:35.313450 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."marts"."stg_referrals__dbt_backup" cascade
[0m08:36:35.314452 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:35.315453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:35.315453 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:35.316451 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:36:35.318449 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m08:36:35.320453 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m08:36:35.323428 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m08:36:35.325430 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m08:36:35.330430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C3513C0>]}
[0m08:36:35.331430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C353220>]}
[0m08:36:35.332430 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C3502E0>]}
[0m08:36:35.333432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202490621D0>]}
[0m08:36:35.334429 [info ] [Thread-3 (]: 3 of 16 OK created sql view model marts.stg_transactions ....................... [[32mCREATE VIEW[0m in 0.31s]
[0m08:36:35.336432 [info ] [Thread-1 (]: 1 of 16 OK created sql view model marts.stg_market ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m08:36:35.338430 [info ] [Thread-2 (]: 2 of 16 OK created sql view model marts.stg_referrals .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m08:36:35.341372 [info ] [Thread-4 (]: 4 of 16 OK created sql view model marts.stg_users .............................. [[32mCREATE VIEW[0m in 0.32s]
[0m08:36:35.343373 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m08:36:35.344373 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m08:36:35.345371 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m08:36:35.346368 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m08:36:35.347368 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m08:36:35.347368 [debug] [Thread-1 (]: Began running node model.growth.mart_daily_transactions
[0m08:36:35.348370 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m08:36:35.349370 [debug] [Thread-4 (]: Began running node model.growth.dim_market
[0m08:36:35.349370 [info ] [Thread-3 (]: 5 of 16 START sql view model marts.dim_transactions ............................ [RUN]
[0m08:36:35.350371 [info ] [Thread-1 (]: 6 of 16 START sql table model marts.mart_daily_transactions .................... [RUN]
[0m08:36:35.351371 [info ] [Thread-2 (]: 7 of 16 START sql table model marts.mart_transaction_summary ................... [RUN]
[0m08:36:35.352371 [info ] [Thread-4 (]: 8 of 16 START sql view model marts.dim_market .................................. [RUN]
[0m08:36:35.353371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m08:36:35.353371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.mart_daily_transactions)
[0m08:36:35.354369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.mart_transaction_summary)
[0m08:36:35.357933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.dim_market)
[0m08:36:35.358939 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m08:36:35.359933 [debug] [Thread-1 (]: Began compiling node model.growth.mart_daily_transactions
[0m08:36:35.360931 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m08:36:35.360931 [debug] [Thread-4 (]: Began compiling node model.growth.dim_market
[0m08:36:35.364932 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m08:36:35.368929 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m08:36:35.375394 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m08:36:35.379390 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_market"
[0m08:36:35.380391 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m08:36:35.381391 [debug] [Thread-1 (]: Began executing node model.growth.mart_daily_transactions
[0m08:36:35.387391 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m08:36:35.387391 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m08:36:35.388390 [debug] [Thread-4 (]: Began executing node model.growth.dim_market
[0m08:36:35.414825 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m08:36:35.419831 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m08:36:35.425512 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_market"
[0m08:36:35.426511 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m08:36:35.428508 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m08:36:35.428508 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m08:36:35.429519 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m08:36:35.429519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:35.430511 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_market"
[0m08:36:35.430511 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: BEGIN
[0m08:36:35.431508 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m08:36:35.432512 [debug] [Thread-4 (]: On model.growth.dim_market: BEGIN
[0m08:36:35.433513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:35.433513 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:35.435510 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:36:35.517353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.087 seconds
[0m08:36:35.518357 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m08:36:35.519356 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."marts"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."marts"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m08:36:35.521356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m08:36:35.524024 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m08:36:35.526028 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."marts"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."marts"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m08:36:35.528797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m08:36:35.529789 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m08:36:35.531789 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m08:36:35.532788 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m08:36:35.532788 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_market"
[0m08:36:35.533787 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."marts"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."marts"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m08:36:35.539443 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m08:36:35.541158 [debug] [Thread-4 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."marts"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."marts"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m08:36:35.543160 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."marts"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m08:36:35.545161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.548160 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m08:36:35.549162 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:36:35.549162 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.023 seconds
[0m08:36:35.550162 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m08:36:35.559894 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_market"
[0m08:36:35.568893 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m08:36:35.569897 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.027 seconds
[0m08:36:35.570894 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m08:36:35.572842 [debug] [Thread-4 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."marts"."dim_market__dbt_tmp" rename to "dim_market"
[0m08:36:35.575057 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m08:36:35.580054 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m08:36:35.582055 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.582055 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:35.583054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:36:35.584054 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m08:36:35.587055 [debug] [Thread-4 (]: On model.growth.dim_market: COMMIT
[0m08:36:35.594517 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_transactions__dbt_backup"
[0m08:36:35.600515 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m08:36:35.601515 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_market"
[0m08:36:35.602517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.603516 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m08:36:35.608013 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m08:36:35.609011 [debug] [Thread-4 (]: On model.growth.dim_market: COMMIT
[0m08:36:35.612009 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m08:36:35.614010 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."marts"."dim_transactions__dbt_backup" cascade
[0m08:36:35.615012 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m08:36:35.617008 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m08:36:35.618024 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.619009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:35.620013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.621009 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m08:36:35.629736 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."dim_market__dbt_backup"
[0m08:36:35.631734 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m08:36:35.635733 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."mart_daily_transactions__dbt_backup"
[0m08:36:35.636733 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_market"
[0m08:36:35.637736 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:35.639570 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DBF1690>]}
[0m08:36:35.646317 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m08:36:35.647318 [debug] [Thread-4 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."marts"."dim_market__dbt_backup" cascade
[0m08:36:35.654321 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."mart_transaction_summary__dbt_backup"
[0m08:36:35.656222 [info ] [Thread-3 (]: 5 of 16 OK created sql view model marts.dim_transactions ....................... [[32mCREATE VIEW[0m in 0.29s]
[0m08:36:35.658429 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."marts"."mart_daily_transactions__dbt_backup" cascade
[0m08:36:35.660426 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m08:36:35.661435 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:36:35.662428 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m08:36:35.663428 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."marts"."mart_transaction_summary__dbt_backup" cascade
[0m08:36:35.663428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:36:35.666428 [debug] [Thread-4 (]: On model.growth.dim_market: Close
[0m08:36:35.667428 [debug] [Thread-3 (]: Began running node model.growth.dim_referrals
[0m08:36:35.669429 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: Close
[0m08:36:35.670428 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:36:35.671429 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C611A50>]}
[0m08:36:35.675324 [info ] [Thread-3 (]: 9 of 16 START sql view model marts.dim_referrals ............................... [RUN]
[0m08:36:35.676457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C57E620>]}
[0m08:36:35.679447 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m08:36:35.681446 [info ] [Thread-4 (]: 8 of 16 OK created sql view model marts.dim_market ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m08:36:35.683444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.dim_referrals)
[0m08:36:35.684444 [info ] [Thread-1 (]: 6 of 16 OK created sql table model marts.mart_daily_transactions ............... [[32mSELECT 1000[0m in 0.32s]
[0m08:36:35.686445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D707A60>]}
[0m08:36:35.687445 [debug] [Thread-4 (]: Finished running node model.growth.dim_market
[0m08:36:35.689633 [debug] [Thread-3 (]: Began compiling node model.growth.dim_referrals
[0m08:36:35.692855 [debug] [Thread-1 (]: Finished running node model.growth.mart_daily_transactions
[0m08:36:35.693853 [info ] [Thread-2 (]: 7 of 16 OK created sql table model marts.mart_transaction_summary .............. [[32mSELECT 8[0m in 0.33s]
[0m08:36:35.695855 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m08:36:35.700852 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m08:36:35.701857 [debug] [Thread-1 (]: Began running node model.growth.fct_users_acquisition
[0m08:36:35.702852 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m08:36:35.703858 [info ] [Thread-4 (]: 10 of 16 START sql view model marts.dim_users .................................. [RUN]
[0m08:36:35.705857 [info ] [Thread-1 (]: 11 of 16 START sql table model marts.fct_users_acquisition ..................... [RUN]
[0m08:36:35.709367 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_transactions
[0m08:36:35.710368 [debug] [Thread-3 (]: Began executing node model.growth.dim_referrals
[0m08:36:35.711366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.dim_users)
[0m08:36:35.712369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_users_acquisition)
[0m08:36:35.713368 [info ] [Thread-2 (]: 12 of 16 START sql view model marts.int_enriched_transactions .................. [RUN]
[0m08:36:35.719368 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m08:36:35.720367 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m08:36:35.720367 [debug] [Thread-1 (]: Began compiling node model.growth.fct_users_acquisition
[0m08:36:35.721369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.int_enriched_transactions)
[0m08:36:35.729605 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m08:36:35.736603 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m08:36:35.737603 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_referrals"
[0m08:36:35.738602 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_transactions
[0m08:36:35.742242 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m08:36:35.742951 [debug] [Thread-3 (]: On model.growth.dim_referrals: BEGIN
[0m08:36:35.747956 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m08:36:35.748954 [debug] [Thread-1 (]: Began executing node model.growth.fct_users_acquisition
[0m08:36:35.758332 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m08:36:35.759341 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:35.766334 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m08:36:35.766334 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_transactions
[0m08:36:35.768334 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:36:35.778082 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m08:36:35.780083 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m08:36:35.781082 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m08:36:35.782083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:36:35.783085 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m08:36:35.784083 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: BEGIN
[0m08:36:35.786084 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: BEGIN
[0m08:36:35.787084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:35.790090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:35.838355 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m08:36:35.841024 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_referrals"
[0m08:36:35.842237 [debug] [Thread-3 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."marts"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."marts"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m08:36:35.848236 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:36:35.858132 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_referrals"
[0m08:36:35.859142 [debug] [Thread-3 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."marts"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m08:36:35.861135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.864130 [debug] [Thread-3 (]: On model.growth.dim_referrals: COMMIT
[0m08:36:35.865132 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_referrals"
[0m08:36:35.866131 [debug] [Thread-3 (]: On model.growth.dim_referrals: COMMIT
[0m08:36:35.868131 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.873132 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_referrals__dbt_backup"
[0m08:36:35.875390 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_referrals"
[0m08:36:35.876387 [debug] [Thread-3 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."marts"."dim_referrals__dbt_backup" cascade
[0m08:36:35.878916 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:35.881916 [debug] [Thread-3 (]: On model.growth.dim_referrals: Close
[0m08:36:35.881916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m08:36:35.883917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DBF1690>]}
[0m08:36:35.883917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m08:36:35.884915 [debug] [Thread-2 (]: SQL status: BEGIN in 0.096 seconds
[0m08:36:35.884915 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:36:35.886915 [info ] [Thread-3 (]: 9 of 16 OK created sql view model marts.dim_referrals .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:36:35.887914 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m08:36:35.890923 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m08:36:35.893150 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m08:36:35.894164 [debug] [Thread-3 (]: Finished running node model.growth.dim_referrals
[0m08:36:35.895150 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."marts"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."marts"."stg_users" u
    LEFT JOIN "nca"."marts"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."marts"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m08:36:35.896149 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."marts"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."marts"."dim_transactions" t
    LEFT JOIN "nca"."marts"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m08:36:35.902155 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:36:35.902155 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:36:35.912443 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:36:35.918445 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m08:36:35.919439 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m08:36:35.920443 [debug] [Thread-1 (]: SQL status: SELECT 97 in 0.023 seconds
[0m08:36:35.921441 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."marts"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m08:36:35.928979 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m08:36:35.928979 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m08:36:35.929980 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m08:36:35.930979 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:35.932981 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m08:36:35.934981 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m08:36:35.935981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:36:35.936983 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:36:35.936983 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m08:36:35.940987 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m08:36:35.941836 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m08:36:35.942838 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m08:36:35.943838 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m08:36:35.944838 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m08:36:35.945838 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:35.946840 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:35.950848 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m08:36:35.950848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:36:35.954837 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."int_enriched_transactions__dbt_backup"
[0m08:36:35.956844 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:36:35.962522 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_users_acquisition__dbt_backup"
[0m08:36:35.963524 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m08:36:35.963524 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m08:36:35.964522 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m08:36:35.965522 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."marts"."int_enriched_transactions__dbt_backup" cascade
[0m08:36:35.966525 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."marts"."fct_users_acquisition__dbt_backup" cascade
[0m08:36:35.967545 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:35.969526 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:35.969526 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:36:35.972525 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m08:36:35.976050 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: Close
[0m08:36:35.978050 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: Close
[0m08:36:35.979050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DBC7580>]}
[0m08:36:35.980053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024C493310>]}
[0m08:36:35.982050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DCA1210>]}
[0m08:36:35.983050 [info ] [Thread-4 (]: 10 of 16 OK created sql view model marts.dim_users ............................. [[32mCREATE VIEW[0m in 0.27s]
[0m08:36:35.989050 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m08:36:35.991054 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_users
[0m08:36:35.985062 [info ] [Thread-2 (]: 12 of 16 OK created sql view model marts.int_enriched_transactions ............. [[32mCREATE VIEW[0m in 0.26s]
[0m08:36:35.987052 [info ] [Thread-1 (]: 11 of 16 OK created sql table model marts.fct_users_acquisition ................ [[32mSELECT 97[0m in 0.27s]
[0m08:36:35.998122 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_transactions
[0m08:36:35.993122 [info ] [Thread-3 (]: 13 of 16 START sql view model marts.int_enriched_users ......................... [RUN]
[0m08:36:35.999122 [debug] [Thread-1 (]: Finished running node model.growth.fct_users_acquisition
[0m08:36:36.001122 [debug] [Thread-4 (]: Began running node model.growth.fct_token_metrics
[0m08:36:36.002123 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.int_enriched_users)
[0m08:36:36.003122 [info ] [Thread-4 (]: 14 of 16 START sql table model marts.fct_token_metrics ......................... [RUN]
[0m08:36:36.004123 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_users
[0m08:36:36.005126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.fct_token_metrics)
[0m08:36:36.016245 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m08:36:36.017241 [debug] [Thread-4 (]: Began compiling node model.growth.fct_token_metrics
[0m08:36:36.100783 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m08:36:36.101784 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_users
[0m08:36:36.109562 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m08:36:36.110558 [debug] [Thread-4 (]: Began executing node model.growth.fct_token_metrics
[0m08:36:36.116564 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m08:36:36.117559 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m08:36:36.118563 [debug] [Thread-3 (]: On model.growth.int_enriched_users: BEGIN
[0m08:36:36.119562 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m08:36:36.119562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:36.120561 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: BEGIN
[0m08:36:36.121561 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:36:36.180381 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m08:36:36.181380 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m08:36:36.181380 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m08:36:36.182381 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."marts"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."marts"."dim_users" u
    LEFT JOIN "nca"."marts"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m08:36:36.182381 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m08:36:36.183380 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."marts"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m08:36:36.187380 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:36:36.195928 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m08:36:36.195928 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."marts"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m08:36:36.196928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:36.199928 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m08:36:36.200929 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m08:36:36.201931 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m08:36:36.202929 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:36.209756 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."int_enriched_users__dbt_backup"
[0m08:36:36.210757 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m08:36:36.211756 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."marts"."int_enriched_users__dbt_backup" cascade
[0m08:36:36.211756 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:36.213759 [debug] [Thread-3 (]: On model.growth.int_enriched_users: Close
[0m08:36:36.214758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DBC7B20>]}
[0m08:36:36.215758 [info ] [Thread-3 (]: 13 of 16 OK created sql view model marts.int_enriched_users .................... [[32mCREATE VIEW[0m in 0.21s]
[0m08:36:36.217761 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_users
[0m08:36:36.218758 [debug] [Thread-2 (]: Began running node model.growth.fct_referral_metrics
[0m08:36:36.219760 [debug] [Thread-1 (]: Began running node model.growth.fct_user_metrics
[0m08:36:36.220757 [info ] [Thread-2 (]: 15 of 16 START sql table model marts.fct_referral_metrics ...................... [RUN]
[0m08:36:36.221757 [info ] [Thread-1 (]: 16 of 16 START sql table model marts.fct_user_metrics .......................... [RUN]
[0m08:36:36.226219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_referral_metrics)
[0m08:36:36.227218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_user_metrics)
[0m08:36:36.227218 [debug] [Thread-2 (]: Began compiling node model.growth.fct_referral_metrics
[0m08:36:36.228214 [debug] [Thread-1 (]: Began compiling node model.growth.fct_user_metrics
[0m08:36:36.238214 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m08:36:36.245651 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m08:36:36.246653 [debug] [Thread-2 (]: Began executing node model.growth.fct_referral_metrics
[0m08:36:36.251650 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m08:36:36.251650 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.068 seconds
[0m08:36:36.252652 [debug] [Thread-1 (]: Began executing node model.growth.fct_user_metrics
[0m08:36:36.257661 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m08:36:36.260024 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m08:36:36.264025 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m08:36:36.265025 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m08:36:36.265025 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: BEGIN
[0m08:36:36.266024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:36.267027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:36.267027 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m08:36:36.270030 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m08:36:36.271027 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: BEGIN
[0m08:36:36.272028 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m08:36:36.276005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:36.276985 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m08:36:36.278983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:36.285983 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_token_metrics__dbt_backup"
[0m08:36:36.287984 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m08:36:36.288984 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."marts"."fct_token_metrics__dbt_backup" cascade
[0m08:36:36.291481 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:36:36.295486 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: Close
[0m08:36:36.297485 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DC3EB90>]}
[0m08:36:36.298484 [info ] [Thread-4 (]: 14 of 16 OK created sql table model marts.fct_token_metrics .................... [[32mSELECT 4[0m in 0.29s]
[0m08:36:36.301485 [debug] [Thread-4 (]: Finished running node model.growth.fct_token_metrics
[0m08:36:36.337402 [debug] [Thread-2 (]: SQL status: BEGIN in 0.071 seconds
[0m08:36:36.338402 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m08:36:36.339401 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."marts"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."marts"."dim_referrals" r
    JOIN "nca"."marts"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m08:36:36.346418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m08:36:36.348419 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m08:36:36.349423 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."marts"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m08:36:36.399135 [debug] [Thread-2 (]: SQL status: SELECT 77 in 0.058 seconds
[0m08:36:36.404134 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m08:36:36.405133 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m08:36:36.407141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:36.410099 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m08:36:36.411097 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m08:36:36.412098 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m08:36:36.414096 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:36.417097 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_referral_metrics__dbt_backup"
[0m08:36:36.418097 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.067 seconds
[0m08:36:36.418097 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m08:36:36.422097 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m08:36:36.423097 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."marts"."fct_referral_metrics__dbt_backup" cascade
[0m08:36:36.425388 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m08:36:36.426718 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:36:36.426718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:36.428716 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: Close
[0m08:36:36.430716 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: COMMIT
[0m08:36:36.431716 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024BA91990>]}
[0m08:36:36.432716 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m08:36:36.433719 [info ] [Thread-2 (]: 15 of 16 OK created sql table model marts.fct_referral_metrics ................. [[32mSELECT 77[0m in 0.20s]
[0m08:36:36.434718 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: COMMIT
[0m08:36:36.436717 [debug] [Thread-2 (]: Finished running node model.growth.fct_referral_metrics
[0m08:36:36.437733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:36.444605 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_user_metrics__dbt_backup"
[0m08:36:36.445604 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m08:36:36.445604 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."marts"."fct_user_metrics__dbt_backup" cascade
[0m08:36:36.446604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:36:36.448605 [debug] [Thread-1 (]: On model.growth.fct_user_metrics: Close
[0m08:36:36.449606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9e65323-d78d-42ce-8f7d-4783d1c2ab16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D82C970>]}
[0m08:36:36.450609 [info ] [Thread-1 (]: 16 of 16 OK created sql table model marts.fct_user_metrics ..................... [[32mSELECT 200[0m in 0.22s]
[0m08:36:36.452607 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_metrics
[0m08:36:36.454604 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:36.454604 [debug] [MainThread]: On master: BEGIN
[0m08:36:36.455603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:36.504144 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m08:36:36.504144 [debug] [MainThread]: On master: COMMIT
[0m08:36:36.505146 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:36.505146 [debug] [MainThread]: On master: COMMIT
[0m08:36:36.507096 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:36.508632 [debug] [MainThread]: On master: Close
[0m08:36:36.509633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:36.510633 [debug] [MainThread]: Connection 'create_nca_marts' was properly closed.
[0m08:36:36.510633 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m08:36:36.511631 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m08:36:36.512634 [debug] [MainThread]: Connection 'model.growth.fct_referral_metrics' was properly closed.
[0m08:36:36.513632 [debug] [MainThread]: Connection 'model.growth.int_enriched_users' was properly closed.
[0m08:36:36.514630 [debug] [MainThread]: Connection 'model.growth.fct_token_metrics' was properly closed.
[0m08:36:36.514630 [info ] [MainThread]: 
[0m08:36:36.515630 [info ] [MainThread]: Finished running 6 table models, 10 view models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m08:36:36.519631 [debug] [MainThread]: Command end result
[0m08:36:36.571934 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m08:36:36.578540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m08:36:36.591248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m08:36:36.592250 [info ] [MainThread]: 
[0m08:36:36.593251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:36:36.595255 [info ] [MainThread]: 
[0m08:36:36.596257 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m08:36:36.598259 [debug] [MainThread]: Command `dbt run` succeeded at 08:36:36.598259 after 5.49 seconds
[0m08:36:36.599255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020249D6D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DB2D6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024DB2D1E0>]}
[0m08:36:36.599255 [debug] [MainThread]: Flushing usage events
[0m08:36:37.930438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:08.210375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016686E9D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688D51780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688D51570>]}


============================== 08:37:08.214375 | 75de4493-cc27-40c6-b926-0b9c27cab340 ==============================
[0m08:37:08.214375 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:37:08.214375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:08.467620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668566F6D0>]}
[0m08:37:08.548312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668880B010>]}
[0m08:37:08.549314 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:37:08.912969 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:37:09.241684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:09.242725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:09.250724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.intermediate
- models.growth_metrics.marts
[0m08:37:09.319447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166895E9750>]}
[0m08:37:09.475209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m08:37:09.480254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m08:37:09.534135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166869EB4C0>]}
[0m08:37:09.534135 [info ] [MainThread]: Found 16 models, 29 data tests, 4 sources, 548 macros
[0m08:37:09.544305 [info ] [MainThread]: 
[0m08:37:09.545108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:09.546042 [info ] [MainThread]: 
[0m08:37:09.547053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:37:09.553052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m08:37:09.679306 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m08:37:09.680306 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m08:37:09.680306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:09.729987 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.050 seconds
[0m08:37:09.731946 [debug] [ThreadPool]: On list_nca: Close
[0m08:37:09.736988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m08:37:09.789135 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m08:37:09.792073 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m08:37:09.792073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:09.838203 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m08:37:09.839205 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m08:37:09.839205 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m08:37:09.846130 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.004 seconds
[0m08:37:09.848109 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m08:37:09.848109 [debug] [ThreadPool]: On list_nca_marts: Close
[0m08:37:09.860807 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:09.861808 [debug] [MainThread]: On master: BEGIN
[0m08:37:09.862809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:09.909709 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m08:37:09.910710 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:09.910710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:37:09.924740 [debug] [MainThread]: SQL status: SELECT 22 in 0.013 seconds
[0m08:37:09.928739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016689633D00>]}
[0m08:37:09.929739 [debug] [MainThread]: On master: ROLLBACK
[0m08:37:09.930739 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:09.930739 [debug] [MainThread]: On master: BEGIN
[0m08:37:09.931739 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:37:09.931739 [debug] [MainThread]: On master: COMMIT
[0m08:37:09.932743 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:09.932743 [debug] [MainThread]: On master: COMMIT
[0m08:37:09.933749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:09.934740 [debug] [MainThread]: On master: Close
[0m08:37:09.939739 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m08:37:09.942387 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m08:37:09.942387 [debug] [Thread-3 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m08:37:09.943384 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m08:37:09.943384 [info ] [Thread-1 (]: 1 of 45 START test dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [RUN]
[0m08:37:09.944383 [info ] [Thread-2 (]: 2 of 45 START test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [RUN]
[0m08:37:09.945386 [info ] [Thread-3 (]: 3 of 45 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m08:37:09.946385 [info ] [Thread-4 (]: 4 of 45 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m08:37:09.947390 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80'
[0m08:37:09.948386 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700'
[0m08:37:09.949385 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m08:37:09.950385 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m08:37:09.950385 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m08:37:09.951383 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m08:37:09.952384 [debug] [Thread-3 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m08:37:09.952384 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m08:37:09.979265 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m08:37:09.984267 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m08:37:09.999576 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m08:37:10.011058 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m08:37:10.013058 [debug] [Thread-2 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m08:37:10.013058 [debug] [Thread-1 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m08:37:10.023057 [debug] [Thread-3 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m08:37:10.031403 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m08:37:10.032409 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m08:37:10.035403 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m08:37:10.038405 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m08:37:10.044061 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m08:37:10.046064 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m08:37:10.047064 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: BEGIN
[0m08:37:10.048064 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m08:37:10.048064 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:37:10.049063 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m08:37:10.049063 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: BEGIN
[0m08:37:10.050062 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m08:37:10.051064 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m08:37:10.052064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:37:10.053065 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m08:37:10.054065 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:37:10.056064 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:37:10.134060 [debug] [Thread-2 (]: SQL status: BEGIN in 0.086 seconds
[0m08:37:10.135063 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m08:37:10.136062 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        referred_user_id
    from "nca"."staging"."referrals"
    group by referred_user_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m08:37:10.139061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m08:37:10.141925 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m08:37:10.140062 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.143816 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date, token
    from "nca"."staging"."market"
    group by date, token
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m08:37:10.151817 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: ROLLBACK
[0m08:37:10.153820 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m08:37:10.153820 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: Close
[0m08:37:10.154819 [debug] [Thread-4 (]: SQL status: BEGIN in 0.099 seconds
[0m08:37:10.155821 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:37:10.157347 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m08:37:10.160486 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m08:37:10.159487 [error] [Thread-2 (]: 2 of 45 FAIL 15 dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [[31mFAIL 15[0m in 0.21s]
[0m08:37:10.163486 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: ROLLBACK
[0m08:37:10.164487 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m08:37:10.165485 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m08:37:10.166483 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m08:37:10.167484 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: Close
[0m08:37:10.169486 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m08:37:10.170485 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m08:37:10.171483 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:37:10.171483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:37:10.172485 [error] [Thread-1 (]: 1 of 45 FAIL 156 dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [[31mFAIL 156[0m in 0.23s]
[0m08:37:10.181620 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m08:37:10.176617 [info ] [Thread-2 (]: 5 of 45 START test source_not_null_staging_market_date ......................... [RUN]
[0m08:37:10.183621 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m08:37:10.184619 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m08:37:10.186618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m08:37:10.186618 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m08:37:10.187618 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m08:37:10.188619 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m08:37:10.192661 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80' to be skipped because of status 'fail'.  Reason: Got 156 results, configured to fail if != 0.
[0m08:37:10.193669 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m08:37:10.195655 [info ] [Thread-3 (]: 3 of 45 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.25s]
[0m08:37:10.197661 [info ] [Thread-4 (]: 4 of 45 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.25s]
[0m08:37:10.198659 [info ] [Thread-1 (]: 6 of 45 START test source_not_null_staging_market_price ........................ [RUN]
[0m08:37:10.209659 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m08:37:10.212014 [debug] [Thread-3 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m08:37:10.213013 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m08:37:10.214014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m08:37:10.215011 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m08:37:10.217013 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m08:37:10.217013 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m08:37:10.218012 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m08:37:10.219012 [info ] [Thread-3 (]: 7 of 45 START test source_not_null_staging_market_token ........................ [RUN]
[0m08:37:10.220013 [info ] [Thread-4 (]: 8 of 45 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m08:37:10.226332 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m08:37:10.232332 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m08:37:10.233331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m08:37:10.234328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m08:37:10.236328 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m08:37:10.237327 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m08:37:10.238327 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m08:37:10.239328 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m08:37:10.246705 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m08:37:10.247706 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m08:37:10.252704 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m08:37:10.260236 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m08:37:10.261220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:10.262217 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m08:37:10.263216 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m08:37:10.268219 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m08:37:10.268219 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m08:37:10.276103 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m08:37:10.277100 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m08:37:10.279101 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m08:37:10.280100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:10.281101 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m08:37:10.281101 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m08:37:10.283101 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m08:37:10.284102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:10.284102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:10.331457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.070 seconds
[0m08:37:10.333456 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m08:37:10.334454 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m08:37:10.337455 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.341464 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m08:37:10.342904 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m08:37:10.344904 [info ] [Thread-2 (]: 5 of 45 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.16s]
[0m08:37:10.346918 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m08:37:10.347904 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m08:37:10.348909 [info ] [Thread-2 (]: 9 of 45 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m08:37:10.350906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m08:37:10.351914 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m08:37:10.365068 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m08:37:10.367068 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m08:37:10.373067 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m08:37:10.378375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m08:37:10.379373 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m08:37:10.380372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m08:37:10.380372 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m08:37:10.381373 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m08:37:10.382372 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m08:37:10.382372 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m08:37:10.383370 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m08:37:10.384372 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m08:37:10.384372 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.385371 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m08:37:10.385371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:10.386370 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m08:37:10.388370 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m08:37:10.389372 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m08:37:10.394886 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m08:37:10.395888 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m08:37:10.392021 [error] [Thread-1 (]: 6 of 45 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.18s]
[0m08:37:10.398891 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m08:37:10.401886 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m08:37:10.403888 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m08:37:10.405888 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m08:37:10.405888 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m08:37:10.408741 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m08:37:10.410741 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_market_price.7a0eea0e50' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m08:37:10.411743 [info ] [Thread-4 (]: 8 of 45 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.18s]
[0m08:37:10.413745 [info ] [Thread-3 (]: 7 of 45 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.18s]
[0m08:37:10.414743 [info ] [Thread-1 (]: 10 of 45 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m08:37:10.416743 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m08:37:10.418742 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m08:37:10.419744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m08:37:10.420743 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m08:37:10.421742 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m08:37:10.422742 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m08:37:10.422742 [info ] [Thread-4 (]: 11 of 45 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m08:37:10.426568 [info ] [Thread-3 (]: 12 of 45 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m08:37:10.432774 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m08:37:10.433775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m08:37:10.434775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m08:37:10.435775 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m08:37:10.436775 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m08:37:10.436775 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m08:37:10.448780 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m08:37:10.455781 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m08:37:10.463158 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m08:37:10.464158 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m08:37:10.466158 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m08:37:10.467159 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m08:37:10.467159 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m08:37:10.472162 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m08:37:10.472162 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m08:37:10.473155 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m08:37:10.478953 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m08:37:10.479953 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m08:37:10.480953 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m08:37:10.481953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:10.482955 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.483950 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m08:37:10.483950 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m08:37:10.487952 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m08:37:10.488952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:10.489953 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m08:37:10.493620 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m08:37:10.494621 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:10.496620 [info ] [Thread-2 (]: 9 of 45 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.15s]
[0m08:37:10.498621 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m08:37:10.500622 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m08:37:10.501621 [info ] [Thread-2 (]: 13 of 45 START test source_not_null_staging_transactions_token ................. [RUN]
[0m08:37:10.503621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m08:37:10.505622 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m08:37:10.530425 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m08:37:10.533414 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m08:37:10.543084 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m08:37:10.545087 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m08:37:10.546087 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m08:37:10.548086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:10.571888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m08:37:10.572887 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m08:37:10.573886 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m08:37:10.577602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.581604 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m08:37:10.582604 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m08:37:10.583606 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m08:37:10.586605 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m08:37:10.585607 [error] [Thread-1 (]: 10 of 45 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.17s]
[0m08:37:10.587606 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m08:37:10.588606 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m08:37:10.591310 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m08:37:10.593500 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m08:37:10.594505 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m08:37:10.595510 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964' to be skipped because of status 'fail'.  Reason: Got 5 results, configured to fail if != 0.
[0m08:37:10.596503 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:37:10.597505 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m08:37:10.599503 [info ] [Thread-1 (]: 14 of 45 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m08:37:10.603504 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m08:37:10.605504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m08:37:10.606501 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.607940 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m08:37:10.611941 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m08:37:10.614942 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m08:37:10.622941 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m08:37:10.624948 [info ] [Thread-3 (]: 12 of 45 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.19s]
[0m08:37:10.628808 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m08:37:10.630811 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m08:37:10.632813 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m08:37:10.634810 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m08:37:10.633810 [error] [Thread-4 (]: 11 of 45 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.20s]
[0m08:37:10.635810 [info ] [Thread-3 (]: 15 of 45 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m08:37:10.644873 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m08:37:10.646874 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m08:37:10.647874 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m08:37:10.647874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m08:37:10.649878 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m08:37:10.650877 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_transactions_amount.a378a55704' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m08:37:10.651876 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m08:37:10.652877 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m08:37:10.652877 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m08:37:10.653875 [info ] [Thread-4 (]: 16 of 45 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m08:37:10.655877 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m08:37:10.664452 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m08:37:10.665450 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m08:37:10.666449 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m08:37:10.668451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:10.669451 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.669451 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m08:37:10.670450 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m08:37:10.673452 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m08:37:10.683947 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m08:37:10.692120 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m08:37:10.694127 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m08:37:10.696121 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m08:37:10.698126 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m08:37:10.697124 [info ] [Thread-2 (]: 13 of 45 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.19s]
[0m08:37:10.704123 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m08:37:10.705120 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m08:37:10.706117 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m08:37:10.710061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:10.711058 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m08:37:10.712056 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m08:37:10.713056 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m08:37:10.714060 [info ] [Thread-2 (]: 17 of 45 START test source_not_null_staging_users_country ...................... [RUN]
[0m08:37:10.716059 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:10.717059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m08:37:10.719061 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m08:37:10.731415 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m08:37:10.734415 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m08:37:10.743718 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m08:37:10.746716 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m08:37:10.747716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m08:37:10.748718 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m08:37:10.749714 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m08:37:10.750716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:10.751715 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m08:37:10.755715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.760694 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m08:37:10.762694 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m08:37:10.764692 [info ] [Thread-1 (]: 14 of 45 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.16s]
[0m08:37:10.766696 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m08:37:10.767695 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m08:37:10.768696 [info ] [Thread-1 (]: 18 of 45 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m08:37:10.770692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m08:37:10.772696 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m08:37:10.786730 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m08:37:10.788730 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m08:37:10.797496 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m08:37:10.798496 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m08:37:10.800498 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m08:37:10.801501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:10.802496 [debug] [Thread-3 (]: SQL status: BEGIN in 0.093 seconds
[0m08:37:10.804499 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m08:37:10.805498 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m08:37:10.810342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:37:10.814345 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m08:37:10.815345 [debug] [Thread-4 (]: SQL status: BEGIN in 0.099 seconds
[0m08:37:10.816345 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m08:37:10.817347 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m08:37:10.820344 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m08:37:10.819345 [info ] [Thread-3 (]: 15 of 45 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.17s]
[0m08:37:10.822360 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m08:37:10.824958 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m08:37:10.827327 [info ] [Thread-3 (]: 19 of 45 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m08:37:10.828325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m08:37:10.830325 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m08:37:10.843511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m08:37:10.840329 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m08:37:10.847512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m08:37:10.849512 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m08:37:10.850514 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m08:37:10.851510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m08:37:10.852509 [info ] [Thread-4 (]: 16 of 45 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.19s]
[0m08:37:10.863544 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m08:37:10.864544 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m08:37:10.866547 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m08:37:10.867547 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m08:37:10.868546 [debug] [Thread-4 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m08:37:10.869545 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m08:37:10.870544 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m08:37:10.870544 [info ] [Thread-4 (]: 20 of 45 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m08:37:10.871547 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.872544 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:10.873545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m08:37:10.876553 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m08:37:10.879510 [debug] [Thread-4 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m08:37:10.880509 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m08:37:10.893366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m08:37:10.896345 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m08:37:10.898347 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m08:37:10.897345 [info ] [Thread-2 (]: 17 of 45 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.18s]
[0m08:37:10.900354 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m08:37:10.902345 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m08:37:10.903344 [debug] [Thread-4 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m08:37:10.905343 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m08:37:10.906343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:37:10.914043 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m08:37:10.915043 [info ] [Thread-2 (]: 21 of 45 START test source_positive_value_staging_market_price ................. [RUN]
[0m08:37:10.917044 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m08:37:10.919044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m08:37:10.920045 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m08:37:10.920045 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m08:37:10.921043 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m08:37:10.922042 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m08:37:10.932602 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m08:37:10.923043 [info ] [Thread-1 (]: 18 of 45 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.15s]
[0m08:37:10.933601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:10.935601 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m08:37:10.936602 [debug] [Thread-2 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m08:37:10.937604 [debug] [Thread-1 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m08:37:10.946223 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m08:37:10.947225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.075 seconds
[0m08:37:10.945222 [info ] [Thread-1 (]: 22 of 45 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m08:37:10.948221 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m08:37:10.949223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m08:37:10.950224 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m08:37:10.952222 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m08:37:10.953221 [debug] [Thread-1 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m08:37:10.954223 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m08:37:10.960898 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m08:37:10.963891 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m08:37:10.964892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:10.966891 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m08:37:10.968894 [debug] [Thread-1 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m08:37:10.969893 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m08:37:10.978829 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m08:37:10.980827 [info ] [Thread-3 (]: 19 of 45 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.15s]
[0m08:37:10.983829 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m08:37:10.984844 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m08:37:10.986827 [info ] [Thread-3 (]: 23 of 45 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m08:37:10.987826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m08:37:10.989827 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m08:37:10.990832 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m08:37:11.011331 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m08:37:11.012335 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m08:37:11.013334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:11.014333 [debug] [Thread-4 (]: SQL status: BEGIN in 0.080 seconds
[0m08:37:11.015331 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m08:37:11.016333 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m08:37:11.017333 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m08:37:11.023334 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m08:37:11.027745 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m08:37:11.028741 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m08:37:11.032740 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m08:37:11.033738 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m08:37:11.034739 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m08:37:11.036751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:11.037741 [info ] [Thread-4 (]: 20 of 45 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.16s]
[0m08:37:11.039741 [debug] [Thread-4 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m08:37:11.041741 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m08:37:11.043740 [info ] [Thread-4 (]: 24 of 45 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m08:37:11.046946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m08:37:11.047941 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m08:37:11.048942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.084 seconds
[0m08:37:11.061949 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m08:37:11.064950 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m08:37:11.066951 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m08:37:11.068950 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m08:37:11.072949 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m08:37:11.073949 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m08:37:11.079689 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m08:37:11.080694 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m08:37:11.081693 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m08:37:11.082691 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m08:37:11.084691 [error] [Thread-2 (]: 21 of 45 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.17s]
[0m08:37:11.086690 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:11.087690 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m08:37:11.089690 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m08:37:11.095305 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_price.1ee4a4b889' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m08:37:11.100306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m08:37:11.101309 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m08:37:11.090692 [info ] [Thread-2 (]: 25 of 45 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m08:37:11.102307 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m08:37:11.104317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m08:37:11.105309 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m08:37:11.121706 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m08:37:11.122706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m08:37:11.127132 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m08:37:11.130130 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m08:37:11.131132 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m08:37:11.131132 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m08:37:11.132133 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:37:11.133131 [debug] [Thread-1 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m08:37:11.143842 [error] [Thread-1 (]: 22 of 45 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.19s]
[0m08:37:11.146629 [debug] [Thread-1 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m08:37:11.140133 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m08:37:11.147629 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m08:37:11.148626 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m08:37:11.149626 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m08:37:11.152627 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m08:37:11.154626 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m08:37:11.154626 [info ] [Thread-1 (]: 26 of 45 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m08:37:11.157642 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m08:37:11.160056 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m08:37:11.162059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m08:37:11.164058 [info ] [Thread-3 (]: 23 of 45 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.18s]
[0m08:37:11.165058 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:11.166066 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m08:37:11.168056 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m08:37:11.184986 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m08:37:11.186987 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m08:37:11.187987 [debug] [Thread-3 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m08:37:11.188987 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m08:37:11.191739 [info ] [Thread-3 (]: 27 of 45 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m08:37:11.194908 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m08:37:11.195907 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:37:11.197898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m08:37:11.201902 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m08:37:11.202898 [debug] [Thread-3 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m08:37:11.217356 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m08:37:11.217356 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m08:37:11.218353 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m08:37:11.221349 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m08:37:11.222351 [debug] [Thread-3 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m08:37:11.223356 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m08:37:11.226137 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m08:37:11.232138 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m08:37:11.232138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:11.234137 [info ] [Thread-4 (]: 24 of 45 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.19s]
[0m08:37:11.238140 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m08:37:11.236140 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m08:37:11.239139 [debug] [Thread-4 (]: Began running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m08:37:11.243880 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m08:37:11.245881 [debug] [Thread-2 (]: SQL status: BEGIN in 0.081 seconds
[0m08:37:11.244884 [info ] [Thread-4 (]: 28 of 45 START test source_unique_staging_users_referral_code .................. [RUN]
[0m08:37:11.247882 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:11.248881 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m08:37:11.249881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e, now test.growth.source_unique_staging_users_referral_code.184becf50f)
[0m08:37:11.251881 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:37:11.252882 [debug] [Thread-4 (]: Began compiling node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m08:37:11.268200 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m08:37:11.269195 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m08:37:11.273195 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m08:37:11.274196 [debug] [Thread-4 (]: Began executing node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m08:37:11.277202 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m08:37:11.286461 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m08:37:11.288459 [info ] [Thread-2 (]: 25 of 45 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.18s]
[0m08:37:11.290461 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m08:37:11.293116 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m08:37:11.295195 [info ] [Thread-2 (]: 29 of 45 START test source_unique_staging_users_user_id ........................ [RUN]
[0m08:37:11.297186 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m08:37:11.298184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m08:37:11.299186 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: BEGIN
[0m08:37:11.300185 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m08:37:11.301192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:11.313907 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m08:37:11.316911 [debug] [Thread-2 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m08:37:11.322908 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m08:37:11.325202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m08:37:11.326253 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m08:37:11.328388 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:37:11.329389 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m08:37:11.331388 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m08:37:11.332393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:11.335391 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m08:37:11.336388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m08:37:11.337388 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m08:37:11.340390 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m08:37:11.343529 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:37:11.344527 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m08:37:11.346528 [info ] [Thread-1 (]: 26 of 45 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.18s]
[0m08:37:11.349528 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m08:37:11.349528 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m08:37:11.351529 [debug] [Thread-1 (]: Began running node model.growth.stg_referrals
[0m08:37:11.354527 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m08:37:11.356526 [info ] [Thread-1 (]: 30 of 45 SKIP relation marts.stg_referrals ..................................... [[33mSKIP[0m]
[0m08:37:11.359534 [debug] [Thread-1 (]: Finished running node model.growth.stg_referrals
[0m08:37:11.362190 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m08:37:11.363188 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m08:37:11.364188 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_referrals' to be skipped because of status 'skipped'. 
[0m08:37:11.366191 [error] [Thread-3 (]: 27 of 45 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.17s]
[0m08:37:11.367190 [info ] [Thread-1 (]: 31 of 45 SKIP relation marts.stg_market ........................................ [[33mSKIP[0m]
[0m08:37:11.370189 [debug] [Thread-3 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m08:37:11.371189 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m08:37:11.372190 [debug] [Thread-3 (]: Began running node model.growth.dim_referrals
[0m08:37:11.374188 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' to be skipped because of status 'fail'.  Reason: Got 10 results, configured to fail if != 0.
[0m08:37:11.378214 [info ] [Thread-3 (]: 32 of 45 SKIP relation marts.dim_referrals ..................................... [[33mSKIP[0m]
[0m08:37:11.380203 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_market' to be skipped because of status 'skipped'. 
[0m08:37:11.381202 [debug] [Thread-1 (]: Began running node model.growth.stg_transactions
[0m08:37:11.382201 [debug] [Thread-3 (]: Finished running node model.growth.dim_referrals
[0m08:37:11.385201 [debug] [Thread-3 (]: Began running node model.growth.dim_market
[0m08:37:11.386209 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_referrals' to be skipped because of status 'skipped'. 
[0m08:37:11.384202 [info ] [Thread-1 (]: 33 of 45 SKIP relation marts.stg_transactions .................................. [[33mSKIP[0m]
[0m08:37:11.388202 [info ] [Thread-3 (]: 34 of 45 SKIP relation marts.dim_market ........................................ [[33mSKIP[0m]
[0m08:37:11.390203 [debug] [Thread-1 (]: Finished running node model.growth.stg_transactions
[0m08:37:11.396231 [debug] [Thread-3 (]: Finished running node model.growth.dim_market
[0m08:37:11.397229 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_transactions' to be skipped because of status 'skipped'. 
[0m08:37:11.399230 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_market' to be skipped because of status 'skipped'. 
[0m08:37:11.400232 [debug] [Thread-1 (]: Began running node model.growth.dim_transactions
[0m08:37:11.401229 [debug] [Thread-3 (]: Began running node model.growth.mart_daily_transactions
[0m08:37:11.402229 [info ] [Thread-1 (]: 35 of 45 SKIP relation marts.dim_transactions .................................. [[33mSKIP[0m]
[0m08:37:11.403229 [info ] [Thread-3 (]: 36 of 45 SKIP relation marts.mart_daily_transactions ........................... [[33mSKIP[0m]
[0m08:37:11.405231 [debug] [Thread-1 (]: Finished running node model.growth.dim_transactions
[0m08:37:11.406231 [debug] [Thread-3 (]: Finished running node model.growth.mart_daily_transactions
[0m08:37:11.409235 [debug] [Thread-1 (]: Began running node model.growth.mart_transaction_summary
[0m08:37:11.412240 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_transactions' to be skipped because of status 'skipped'. 
[0m08:37:11.415241 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'skipped'. 
[0m08:37:11.416240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m08:37:11.414241 [info ] [Thread-1 (]: 37 of 45 SKIP relation marts.mart_transaction_summary .......................... [[33mSKIP[0m]
[0m08:37:11.418239 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_transactions
[0m08:37:11.419239 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m08:37:11.420241 [debug] [Thread-1 (]: Finished running node model.growth.mart_transaction_summary
[0m08:37:11.423240 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_referral_code.184becf50f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    referral_code as unique_field,
    count(*) as n_records

from (select * from "nca"."staging"."users" where referral_code is not null) dbt_subquery
where referral_code is not null
group by referral_code
having count(*) > 1



      
    ) dbt_internal_test
[0m08:37:11.421237 [info ] [Thread-3 (]: 38 of 45 SKIP relation marts.int_enriched_transactions ......................... [[33mSKIP[0m]
[0m08:37:11.424237 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_transaction_summary' to be skipped because of status 'skipped'. 
[0m08:37:11.430059 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_transactions
[0m08:37:11.431057 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_transactions' to be skipped because of status 'skipped'. 
[0m08:37:11.433057 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m08:37:11.433057 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m08:37:11.435058 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m08:37:11.436059 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: ROLLBACK
[0m08:37:11.437060 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m08:37:11.438059 [info ] [Thread-1 (]: 39 of 45 SKIP relation marts.fct_token_metrics ................................. [[33mSKIP[0m]
[0m08:37:11.439056 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: Close
[0m08:37:11.440057 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:37:11.443968 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m08:37:11.445965 [info ] [Thread-4 (]: 28 of 45 PASS source_unique_staging_users_referral_code ........................ [[32mPASS[0m in 0.20s]
[0m08:37:11.447965 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_token_metrics' to be skipped because of status 'skipped'. 
[0m08:37:11.449967 [debug] [Thread-4 (]: Finished running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m08:37:11.450962 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m08:37:11.454962 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m08:37:11.456964 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m08:37:11.459148 [info ] [Thread-2 (]: 29 of 45 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.16s]
[0m08:37:11.464194 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m08:37:11.466192 [debug] [Thread-3 (]: Began running node model.growth.stg_users
[0m08:37:11.467197 [info ] [Thread-3 (]: 40 of 45 START sql view model marts.stg_users .................................. [RUN]
[0m08:37:11.468193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1, now model.growth.stg_users)
[0m08:37:11.469195 [debug] [Thread-3 (]: Began compiling node model.growth.stg_users
[0m08:37:11.473190 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_users"
[0m08:37:11.478035 [debug] [Thread-3 (]: Began executing node model.growth.stg_users
[0m08:37:11.532871 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_users"
[0m08:37:11.533873 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.534871 [debug] [Thread-3 (]: On model.growth.stg_users: BEGIN
[0m08:37:11.535872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:37:11.594389 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m08:37:11.595390 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.596387 [debug] [Thread-3 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m08:37:11.600390 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:37:11.613515 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.614517 [debug] [Thread-3 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m08:37:11.616524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:37:11.689022 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.689022 [debug] [Thread-3 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m08:37:11.691022 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:11.710853 [debug] [Thread-3 (]: On model.growth.stg_users: COMMIT
[0m08:37:11.711849 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.711849 [debug] [Thread-3 (]: On model.growth.stg_users: COMMIT
[0m08:37:11.712847 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:37:11.720846 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m08:37:11.727295 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_users"
[0m08:37:11.727295 [debug] [Thread-3 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m08:37:11.732291 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m08:37:11.734291 [debug] [Thread-3 (]: On model.growth.stg_users: Close
[0m08:37:11.737294 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668AFC67D0>]}
[0m08:37:11.738294 [info ] [Thread-3 (]: 40 of 45 OK created sql view model marts.stg_users ............................. [[32mCREATE VIEW[0m in 0.27s]
[0m08:37:11.740296 [debug] [Thread-3 (]: Finished running node model.growth.stg_users
[0m08:37:11.741292 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m08:37:11.743977 [debug] [Thread-2 (]: Began running node model.growth.fct_users_acquisition
[0m08:37:11.744986 [info ] [Thread-4 (]: 41 of 45 START sql view model marts.dim_users .................................. [RUN]
[0m08:37:11.745980 [info ] [Thread-2 (]: 42 of 45 SKIP relation marts.fct_users_acquisition ............................. [[33mSKIP[0m]
[0m08:37:11.746980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_users_referral_code.184becf50f, now model.growth.dim_users)
[0m08:37:11.746980 [debug] [Thread-2 (]: Finished running node model.growth.fct_users_acquisition
[0m08:37:11.747978 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m08:37:11.748978 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'skipped'. 
[0m08:37:11.752976 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m08:37:11.753977 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m08:37:11.762103 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m08:37:11.763095 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:37:11.764097 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m08:37:11.764097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:37:11.813945 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m08:37:11.814945 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:37:11.814945 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m08:37:11.818942 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:37:11.821940 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:37:11.822941 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m08:37:11.823942 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:11.827471 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m08:37:11.828747 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:37:11.828747 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m08:37:11.829745 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m08:37:11.834745 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m08:37:11.834745 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m08:37:11.835746 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m08:37:11.836745 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:37:11.838746 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m08:37:11.839746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75de4493-cc27-40c6-b926-0b9c27cab340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668AD6CB50>]}
[0m08:37:11.840748 [info ] [Thread-4 (]: 41 of 45 OK created sql view model marts.dim_users ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m08:37:11.844656 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m08:37:11.846652 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_users
[0m08:37:11.847652 [info ] [Thread-3 (]: 43 of 45 SKIP relation marts.int_enriched_users ................................ [[33mSKIP[0m]
[0m08:37:11.848654 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_users
[0m08:37:11.848654 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_users' to be skipped because of status 'skipped'. 
[0m08:37:11.849657 [debug] [Thread-2 (]: Began running node model.growth.fct_referral_metrics
[0m08:37:11.850651 [debug] [Thread-4 (]: Began running node model.growth.fct_user_metrics
[0m08:37:11.850651 [info ] [Thread-2 (]: 44 of 45 SKIP relation marts.fct_referral_metrics .............................. [[33mSKIP[0m]
[0m08:37:11.851655 [info ] [Thread-4 (]: 45 of 45 SKIP relation marts.fct_user_metrics .................................. [[33mSKIP[0m]
[0m08:37:11.852656 [debug] [Thread-2 (]: Finished running node model.growth.fct_referral_metrics
[0m08:37:11.853651 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_metrics
[0m08:37:11.853651 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referral_metrics' to be skipped because of status 'skipped'. 
[0m08:37:11.854652 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_metrics' to be skipped because of status 'skipped'. 
[0m08:37:11.856652 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:11.856652 [debug] [MainThread]: On master: BEGIN
[0m08:37:11.857651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:11.906038 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m08:37:11.906038 [debug] [MainThread]: On master: COMMIT
[0m08:37:11.907040 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:11.907040 [debug] [MainThread]: On master: COMMIT
[0m08:37:11.908038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:11.909102 [debug] [MainThread]: On master: Close
[0m08:37:11.911300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:11.912292 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m08:37:11.912292 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m08:37:11.913292 [debug] [MainThread]: Connection 'test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4' was properly closed.
[0m08:37:11.914294 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m08:37:11.915292 [debug] [MainThread]: Connection 'model.growth.stg_users' was properly closed.
[0m08:37:11.915292 [debug] [MainThread]: Connection 'model.growth.dim_users' was properly closed.
[0m08:37:11.916290 [info ] [MainThread]: 
[0m08:37:11.916799 [info ] [MainThread]: Finished running 6 table models, 29 data tests, 10 view models in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m08:37:11.923825 [debug] [MainThread]: Command end result
[0m08:37:11.970344 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m08:37:11.973345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m08:37:11.984499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m08:37:11.985502 [info ] [MainThread]: 
[0m08:37:11.986499 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m08:37:11.987501 [info ] [MainThread]: 
[0m08:37:11.988528 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id (models\staging\schema.yml)[0m
[0m08:37:11.990502 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m08:37:11.990502 [info ] [MainThread]: 
[0m08:37:11.994097 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_ce21451ab51663af294524ce4a7e56fa.sql
[0m08:37:11.995095 [info ] [MainThread]: 
[0m08:37:11.996088 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_market_date__token (models\staging\schema.yml)[0m
[0m08:37:11.997087 [error] [MainThread]:   Got 156 results, configured to fail if != 0
[0m08:37:11.998085 [info ] [MainThread]: 
[0m08:37:11.999085 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_3a255a5db84d348db66273d767faeca9.sql
[0m08:37:12.000085 [info ] [MainThread]: 
[0m08:37:12.000085 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m08:37:12.001085 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m08:37:12.002085 [info ] [MainThread]: 
[0m08:37:12.003085 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m08:37:12.004086 [info ] [MainThread]: 
[0m08:37:12.004593 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m08:37:12.005502 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m08:37:12.006513 [info ] [MainThread]: 
[0m08:37:12.007516 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m08:37:12.008520 [info ] [MainThread]: 
[0m08:37:12.012473 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m08:37:12.013472 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m08:37:12.014476 [info ] [MainThread]: 
[0m08:37:12.014476 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m08:37:12.015476 [info ] [MainThread]: 
[0m08:37:12.016471 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m08:37:12.017472 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m08:37:12.018475 [info ] [MainThread]: 
[0m08:37:12.018475 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m08:37:12.019476 [info ] [MainThread]: 
[0m08:37:12.020472 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m08:37:12.021471 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m08:37:12.022118 [info ] [MainThread]: 
[0m08:37:12.023131 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m08:37:12.023131 [info ] [MainThread]: 
[0m08:37:12.024174 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m08:37:12.028484 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m08:37:12.029480 [info ] [MainThread]: 
[0m08:37:12.031524 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m08:37:12.031524 [info ] [MainThread]: 
[0m08:37:12.032524 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=8 SKIP=14 TOTAL=45
[0m08:37:12.034523 [debug] [MainThread]: Command `dbt build` failed at 08:37:12.033489 after 3.95 seconds
[0m08:37:12.034523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016686E9D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166869EB4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668AD20E20>]}
[0m08:37:12.035523 [debug] [MainThread]: Flushing usage events
[0m08:37:13.341273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:31.185730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36EA8D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3709416F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D370941510>]}


============================== 09:15:31.201353 | 455a94d9-057b-4f6f-8b26-dd4895b547b4 ==============================
[0m09:15:31.201353 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:15:31.201353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:15:31.646318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455a94d9-057b-4f6f-8b26-dd4895b547b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36ED3B460>]}
[0m09:15:31.719604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455a94d9-057b-4f6f-8b26-dd4895b547b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3709481F0>]}
[0m09:15:31.719604 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:32.174260 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_referrals_performance.sql
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_retention.sql
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_acquisition.sql
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_transaction_metrics.sql
[0m09:15:32.564927 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_engagement.sql
[0m09:15:32.833128 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.growth.fct_referrals_performance' (models\marts\fct_referrals_performance.sql) depends on a node named 'int_cleaned_referrals' which was not found
[0m09:15:32.833128 [debug] [MainThread]: Command `dbt run` failed at 09:15:32.833128 after 1.78 seconds
[0m09:15:32.833128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36EA8D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D2FB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D37118E980>]}
[0m09:15:32.833128 [debug] [MainThread]: Flushing usage events
[0m09:15:36.710135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:21.323565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7042FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7061AD600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7061AD3F0>]}


============================== 09:16:21.339236 | af26acea-dc24-46db-a139-3c0105735960 ==============================
[0m09:16:21.339236 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:16:21.339236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:21.616386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D702ACF6D0>]}
[0m09:16:21.694473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D705C6B940>]}
[0m09:16:21.694473 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:22.118385 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:16:22.528331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m09:16:22.530077 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_referrals_performance.sql
[0m09:16:22.530586 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_acquisition.sql
[0m09:16:22.531639 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_retention.sql
[0m09:16:22.532858 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_transaction_metrics.sql
[0m09:16:22.533914 [debug] [MainThread]: Partial parsing: added file: growth://models\marts\fct_user_engagement.sql
[0m09:16:22.903112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.intermediate
- models.growth_metrics.staging
- models.growth_metrics.marts
[0m09:16:22.947560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706C10130>]}
[0m09:16:23.108093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:16:23.108093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:16:23.248778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7067BF9A0>]}
[0m09:16:23.248778 [info ] [MainThread]: Found 21 models, 29 data tests, 4 sources, 548 macros
[0m09:16:23.248778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7067BF790>]}
[0m09:16:23.248778 [info ] [MainThread]: 
[0m09:16:23.248778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:23.262697 [info ] [MainThread]: 
[0m09:16:23.264872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:23.266718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:16:23.501173 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:16:23.501173 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:16:23.501173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:23.563673 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m09:16:23.563673 [debug] [ThreadPool]: On list_nca: Close
[0m09:16:23.580539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:16:23.580539 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:16:23.580539 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:16:23.580539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:23.624620 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m09:16:23.624620 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:16:23.640247 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:16:23.640247 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.009 seconds
[0m09:16:23.640247 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:16:23.640247 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:16:23.655873 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:23.655873 [debug] [MainThread]: On master: BEGIN
[0m09:16:23.655873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:23.702792 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m09:16:23.702792 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:23.702792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:23.718374 [debug] [MainThread]: SQL status: SELECT 10 in 0.012 seconds
[0m09:16:23.718374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706B20EB0>]}
[0m09:16:23.733998 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:23.733998 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:23.733998 [debug] [MainThread]: On master: BEGIN
[0m09:16:23.733998 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:16:23.733998 [debug] [MainThread]: On master: COMMIT
[0m09:16:23.733998 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:23.733998 [debug] [MainThread]: On master: COMMIT
[0m09:16:23.733998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:16:23.733998 [debug] [MainThread]: On master: Close
[0m09:16:23.733998 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m09:16:23.733998 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m09:16:23.733998 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m09:16:23.733998 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m09:16:23.749621 [info ] [Thread-1 (]: 1 of 21 START sql view model marts.stg_market .................................. [RUN]
[0m09:16:23.749621 [info ] [Thread-2 (]: 2 of 21 START sql view model marts.stg_referrals ............................... [RUN]
[0m09:16:23.749621 [info ] [Thread-3 (]: 3 of 21 START sql view model marts.stg_transactions ............................ [RUN]
[0m09:16:23.749621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m09:16:23.749621 [info ] [Thread-4 (]: 4 of 21 START sql view model marts.stg_users ................................... [RUN]
[0m09:16:23.749621 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m09:16:23.749621 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m09:16:23.749621 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m09:16:23.749621 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m09:16:23.749621 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m09:16:23.749621 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m09:16:23.777994 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m09:16:23.778993 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m09:16:23.781614 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m09:16:23.781614 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m09:16:23.795432 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:16:23.795432 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m09:16:23.795432 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m09:16:23.810645 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m09:16:23.827296 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m09:16:23.843398 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m09:16:23.843398 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m09:16:23.843398 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m09:16:23.859024 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:16:23.859024 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:23.859024 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:23.859024 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m09:16:23.859024 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:23.859024 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m09:16:23.859024 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:23.859024 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:16:23.859024 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m09:16:23.859024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:16:23.859024 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m09:16:23.859024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:16:23.874651 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:16:23.952777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.087 seconds
[0m09:16:23.952777 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:23.952777 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."marts"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m09:16:23.952777 [debug] [Thread-3 (]: SQL status: BEGIN in 0.093 seconds
[0m09:16:23.952777 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:23.968401 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."marts"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m09:16:23.968401 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:16:23.968401 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:16:23.984029 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:23.984029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m09:16:23.984029 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:23.984029 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m09:16:23.984029 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m09:16:23.999648 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:23.999648 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m09:16:23.999648 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:23.999648 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."marts"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m09:16:23.999648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:23.999648 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:23.999648 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:16:23.999648 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:23.999648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:16:24.015271 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:24.015271 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m09:16:24.015271 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:24.015271 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:16:24.015271 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m09:16:24.030898 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market" rename to "stg_market__dbt_backup"
[0m09:16:24.030898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:24.030898 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:24.030898 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.046524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:16:24.062148 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:16:24.062148 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:16:24.077775 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:16:24.077775 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:24.077775 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:24.077775 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:24.077775 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.077775 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market__dbt_tmp" rename to "stg_market"
[0m09:16:24.077775 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:16:24.093400 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:16:24.093400 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:24.093400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.093400 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.093400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.093400 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:16:24.093400 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:16:24.111181 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_transactions__dbt_backup"
[0m09:16:24.111181 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."stg_referrals__dbt_backup"
[0m09:16:24.111181 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:24.111181 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.131384 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:16:24.132344 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:16:24.133344 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:16:24.134345 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:16:24.135344 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."marts"."stg_transactions__dbt_backup" cascade
[0m09:16:24.136340 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."marts"."stg_referrals__dbt_backup" cascade
[0m09:16:24.137343 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:24.137343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.139342 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:16:24.143018 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_market__dbt_backup"
[0m09:16:24.143018 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m09:16:24.143018 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m09:16:24.143018 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:16:24.143018 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.143018 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m09:16:24.143018 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m09:16:24.143018 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."marts"."stg_market__dbt_backup" cascade
[0m09:16:24.143018 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:16:24.158645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7062C15A0>]}
[0m09:16:24.158645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706A57A90>]}
[0m09:16:24.158645 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:16:24.158645 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:16:24.158645 [info ] [Thread-2 (]: 2 of 21 OK created sql view model marts.stg_referrals .......................... [[32mCREATE VIEW[0m in 0.41s]
[0m09:16:24.158645 [info ] [Thread-3 (]: 3 of 21 OK created sql view model marts.stg_transactions ....................... [[32mCREATE VIEW[0m in 0.41s]
[0m09:16:24.158645 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:16:24.174272 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m09:16:24.174272 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m09:16:24.174272 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m09:16:24.174272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708036620>]}
[0m09:16:24.174272 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:16:24.174272 [info ] [Thread-1 (]: 1 of 21 OK created sql view model marts.stg_market ............................. [[32mCREATE VIEW[0m in 0.42s]
[0m09:16:24.189895 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m09:16:24.190587 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m09:16:24.194839 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m09:16:24.196839 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m09:16:24.197749 [info ] [Thread-2 (]: 5 of 21 START sql view model marts.dim_referrals ............................... [RUN]
[0m09:16:24.202583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70618E3E0>]}
[0m09:16:24.203881 [debug] [Thread-1 (]: Began running node model.growth.mart_daily_transactions
[0m09:16:24.209099 [info ] [Thread-4 (]: 4 of 21 OK created sql view model marts.stg_users .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m09:16:24.207101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m09:16:24.199800 [info ] [Thread-3 (]: 6 of 21 START sql view model marts.dim_transactions ............................ [RUN]
[0m09:16:24.211761 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m09:16:24.211761 [info ] [Thread-1 (]: 7 of 21 START sql table model marts.mart_daily_transactions .................... [RUN]
[0m09:16:24.211761 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m09:16:24.218767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m09:16:24.219765 [debug] [Thread-4 (]: Began running node model.growth.mart_transaction_summary
[0m09:16:24.220766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.mart_daily_transactions)
[0m09:16:24.228500 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m09:16:24.228500 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m09:16:24.228500 [debug] [Thread-1 (]: Began compiling node model.growth.mart_daily_transactions
[0m09:16:24.228500 [info ] [Thread-4 (]: 8 of 21 START sql table model marts.mart_transaction_summary ................... [RUN]
[0m09:16:24.240419 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m09:16:24.245184 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m09:16:24.245184 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m09:16:24.245184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.mart_transaction_summary)
[0m09:16:24.245184 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m09:16:24.245184 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m09:16:24.245184 [debug] [Thread-4 (]: Began compiling node model.growth.mart_transaction_summary
[0m09:16:24.261976 [debug] [Thread-1 (]: Began executing node model.growth.mart_daily_transactions
[0m09:16:24.268275 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m09:16:24.270276 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m09:16:24.270276 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:16:24.310623 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m09:16:24.310623 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:16:24.310623 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m09:16:24.310623 [debug] [Thread-4 (]: Began executing node model.growth.mart_transaction_summary
[0m09:16:24.310623 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m09:16:24.310623 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.310623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:24.330030 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m09:16:24.331030 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:16:24.332030 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: BEGIN
[0m09:16:24.334041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:24.336033 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.337032 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: BEGIN
[0m09:16:24.338033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:16:24.408289 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m09:16:24.423916 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:16:24.423916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.088 seconds
[0m09:16:24.423916 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m09:16:24.423916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m09:16:24.423916 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."marts"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."marts"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m09:16:24.423916 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.423916 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:16:24.423916 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.423916 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."marts"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."marts"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m09:16:24.423916 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."marts"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."marts"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m09:16:24.423916 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."marts"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."marts"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m09:16:24.423916 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:16:24.439544 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:16:24.439544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:16:24.439544 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."marts"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m09:16:24.439544 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:16:24.439544 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."marts"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m09:16:24.439544 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.455165 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m09:16:24.455165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:16:24.455165 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.022 seconds
[0m09:16:24.455165 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:16:24.455165 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m09:16:24.455165 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.028 seconds
[0m09:16:24.455165 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.455165 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m09:16:24.455165 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:16:24.470789 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.470789 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions" rename to "mart_daily_transactions__dbt_backup"
[0m09:16:24.470789 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m09:16:24.470789 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:16:24.470789 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary" rename to "mart_transaction_summary__dbt_backup"
[0m09:16:24.470789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.470789 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.470789 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."dim_referrals__dbt_backup"
[0m09:16:24.486414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:24.486414 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.486414 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_transactions__dbt_backup"
[0m09:16:24.486414 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:16:24.486414 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.486414 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m09:16:24.486414 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:16:24.486414 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."marts"."dim_referrals__dbt_backup" cascade
[0m09:16:24.502038 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m09:16:24.502038 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."marts"."dim_transactions__dbt_backup" cascade
[0m09:16:24.502038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.502038 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:16:24.502038 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.502038 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:16:24.502038 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:16:24.502038 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m09:16:24.502038 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:16:24.517664 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m09:16:24.517664 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.517664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708161990>]}
[0m09:16:24.517664 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.517664 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708148D90>]}
[0m09:16:24.517664 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:16:24.517664 [info ] [Thread-2 (]: 5 of 21 OK created sql view model marts.dim_referrals .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:16:24.517664 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:16:24.517664 [info ] [Thread-3 (]: 6 of 21 OK created sql view model marts.dim_transactions ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:16:24.533289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.533289 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m09:16:24.533289 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m09:16:24.533289 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.533289 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."mart_daily_transactions__dbt_backup"
[0m09:16:24.533289 [debug] [Thread-2 (]: Began running node model.growth.dim_market
[0m09:16:24.533289 [debug] [Thread-3 (]: Began running node model.growth.dim_users
[0m09:16:24.548924 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."mart_transaction_summary__dbt_backup"
[0m09:16:24.554789 [debug] [Thread-1 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:16:24.554789 [info ] [Thread-2 (]: 9 of 21 START sql view model marts.dim_market .................................. [RUN]
[0m09:16:24.562442 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:16:24.554789 [info ] [Thread-3 (]: 10 of 21 START sql view model marts.dim_users .................................. [RUN]
[0m09:16:24.565032 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."marts"."mart_daily_transactions__dbt_backup" cascade
[0m09:16:24.565032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.dim_market)
[0m09:16:24.565032 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."marts"."mart_transaction_summary__dbt_backup" cascade
[0m09:16:24.565032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.dim_users)
[0m09:16:24.565032 [debug] [Thread-2 (]: Began compiling node model.growth.dim_market
[0m09:16:24.565032 [debug] [Thread-3 (]: Began compiling node model.growth.dim_users
[0m09:16:24.579718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:16:24.581774 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_market"
[0m09:16:24.582770 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:16:24.587780 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:16:24.587780 [debug] [Thread-1 (]: On model.growth.mart_daily_transactions: Close
[0m09:16:24.587780 [debug] [Thread-4 (]: On model.growth.mart_transaction_summary: Close
[0m09:16:24.595422 [debug] [Thread-2 (]: Began executing node model.growth.dim_market
[0m09:16:24.597256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706C9A560>]}
[0m09:16:24.597256 [debug] [Thread-3 (]: Began executing node model.growth.dim_users
[0m09:16:24.597256 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706A2C7C0>]}
[0m09:16:24.612345 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_market"
[0m09:16:24.612345 [info ] [Thread-1 (]: 7 of 21 OK created sql table model marts.mart_daily_transactions ............... [[32mSELECT 1000[0m in 0.38s]
[0m09:16:24.612345 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:16:24.612345 [info ] [Thread-4 (]: 8 of 21 OK created sql table model marts.mart_transaction_summary .............. [[32mSELECT 8[0m in 0.35s]
[0m09:16:24.625068 [debug] [Thread-1 (]: Finished running node model.growth.mart_daily_transactions
[0m09:16:24.629075 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_market"
[0m09:16:24.631067 [debug] [Thread-4 (]: Finished running node model.growth.mart_transaction_summary
[0m09:16:24.633066 [debug] [Thread-1 (]: Began running node model.growth.fct_users_acquisition
[0m09:16:24.634065 [debug] [Thread-2 (]: On model.growth.dim_market: BEGIN
[0m09:16:24.638454 [info ] [Thread-1 (]: 11 of 21 START sql table model marts.fct_users_acquisition ..................... [RUN]
[0m09:16:24.640444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:24.641442 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:16:24.642443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_users_acquisition)
[0m09:16:24.649334 [debug] [Thread-3 (]: On model.growth.dim_users: BEGIN
[0m09:16:24.652234 [debug] [Thread-1 (]: Began compiling node model.growth.fct_users_acquisition
[0m09:16:24.653233 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:16:24.666839 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m09:16:24.669836 [debug] [Thread-1 (]: Began executing node model.growth.fct_users_acquisition
[0m09:16:24.680340 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m09:16:24.680340 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.680340 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: BEGIN
[0m09:16:24.680340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:24.750686 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m09:16:24.758699 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_market"
[0m09:16:24.758699 [debug] [Thread-2 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."marts"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."marts"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m09:16:24.758699 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m09:16:24.758699 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:16:24.758699 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:16:24.758699 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:16:24.771153 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:16:24.775573 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_market"
[0m09:16:24.782580 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:16:24.783383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m09:16:24.784438 [debug] [Thread-2 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."marts"."dim_market__dbt_tmp" rename to "dim_market"
[0m09:16:24.784963 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:16:24.786022 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.786548 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:24.788394 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."marts"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."marts"."stg_users" u
    LEFT JOIN "nca"."marts"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."marts"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m09:16:24.788926 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:24.791547 [debug] [Thread-2 (]: On model.growth.dim_market: COMMIT
[0m09:16:24.796011 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:16:24.796999 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_market"
[0m09:16:24.798657 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:16:24.799166 [debug] [Thread-2 (]: On model.growth.dim_market: COMMIT
[0m09:16:24.800222 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:16:24.802187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.802698 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:24.806690 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."dim_market__dbt_backup"
[0m09:16:24.819091 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:16:24.820145 [debug] [Thread-1 (]: SQL status: SELECT 97 in 0.027 seconds
[0m09:16:24.821742 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_market"
[0m09:16:24.823860 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:16:24.831130 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.834183 [debug] [Thread-2 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."marts"."dim_market__dbt_backup" cascade
[0m09:16:24.834183 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:16:24.834183 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition" rename to "fct_users_acquisition__dbt_backup"
[0m09:16:24.834183 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:16:24.834183 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:16:24.841281 [debug] [Thread-2 (]: On model.growth.dim_market: Close
[0m09:16:24.841812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:24.845771 [debug] [Thread-3 (]: On model.growth.dim_users: Close
[0m09:16:24.846820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D705CA8760>]}
[0m09:16:24.929686 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.929686 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708285A20>]}
[0m09:16:24.929686 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m09:16:24.929686 [info ] [Thread-2 (]: 9 of 21 OK created sql view model marts.dim_market ............................. [[32mCREATE VIEW[0m in 0.28s]
[0m09:16:24.929686 [info ] [Thread-3 (]: 10 of 21 OK created sql view model marts.dim_users ............................. [[32mCREATE VIEW[0m in 0.36s]
[0m09:16:24.942700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:24.942700 [debug] [Thread-2 (]: Finished running node model.growth.dim_market
[0m09:16:24.942700 [debug] [Thread-3 (]: Finished running node model.growth.dim_users
[0m09:16:24.942700 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:16:24.942700 [debug] [Thread-4 (]: Began running node model.growth.int_enriched_transactions
[0m09:16:24.942700 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_users
[0m09:16:24.942700 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.942700 [info ] [Thread-4 (]: 12 of 21 START sql view model marts.int_enriched_transactions .................. [RUN]
[0m09:16:24.957417 [info ] [Thread-2 (]: 13 of 21 START sql view model marts.int_enriched_users ......................... [RUN]
[0m09:16:24.958833 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:16:24.961898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.int_enriched_transactions)
[0m09:16:24.964142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.int_enriched_users)
[0m09:16:24.967775 [debug] [Thread-4 (]: Began compiling node model.growth.int_enriched_transactions
[0m09:16:24.968771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:16:24.969773 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_users
[0m09:16:24.971772 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m09:16:24.979125 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_users_acquisition__dbt_backup"
[0m09:16:24.979125 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m09:16:24.994756 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:16:24.995932 [debug] [Thread-4 (]: Began executing node model.growth.int_enriched_transactions
[0m09:16:24.995932 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."marts"."fct_users_acquisition__dbt_backup" cascade
[0m09:16:24.995932 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m09:16:24.995932 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_users
[0m09:16:25.012160 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m09:16:25.012160 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:16:25.012160 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:16:25.012160 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: Close
[0m09:16:25.012160 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:16:25.012160 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: BEGIN
[0m09:16:25.029051 [debug] [Thread-2 (]: On model.growth.int_enriched_users: BEGIN
[0m09:16:25.012160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7080D1FF0>]}
[0m09:16:25.031050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:16:25.033051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:25.034050 [info ] [Thread-1 (]: 11 of 21 OK created sql table model marts.fct_users_acquisition ................ [[32mSELECT 97[0m in 0.37s]
[0m09:16:25.037052 [debug] [Thread-1 (]: Finished running node model.growth.fct_users_acquisition
[0m09:16:25.096696 [debug] [Thread-4 (]: SQL status: BEGIN in 0.066 seconds
[0m09:16:25.098695 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:16:25.099694 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."marts"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."marts"."dim_transactions" t
    LEFT JOIN "nca"."marts"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m09:16:25.100789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m09:16:25.102692 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:16:25.103687 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."marts"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."marts"."dim_users" u
    LEFT JOIN "nca"."marts"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m09:16:25.106686 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:16:25.112964 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:16:25.112964 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:16:25.113964 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."marts"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m09:16:25.117962 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:16:25.118962 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."marts"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m09:16:25.119966 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:25.121962 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:16:25.121962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:25.122964 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:16:25.123963 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m09:16:25.124972 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:16:25.125962 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:16:25.126963 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m09:16:25.126963 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:16:25.126963 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."int_enriched_transactions__dbt_backup"
[0m09:16:25.126963 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m09:16:25.126963 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:16:25.126963 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."int_enriched_users__dbt_backup"
[0m09:16:25.126963 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."marts"."int_enriched_transactions__dbt_backup" cascade
[0m09:16:25.126963 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:16:25.126963 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."marts"."int_enriched_users__dbt_backup" cascade
[0m09:16:25.126963 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:16:25.142622 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: Close
[0m09:16:25.142622 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:16:25.142622 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708287280>]}
[0m09:16:25.142622 [debug] [Thread-2 (]: On model.growth.int_enriched_users: Close
[0m09:16:25.142622 [info ] [Thread-4 (]: 12 of 21 OK created sql view model marts.int_enriched_transactions ............. [[32mCREATE VIEW[0m in 0.18s]
[0m09:16:25.142622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708151510>]}
[0m09:16:25.142622 [debug] [Thread-4 (]: Finished running node model.growth.int_enriched_transactions
[0m09:16:25.142622 [info ] [Thread-2 (]: 13 of 21 OK created sql view model marts.int_enriched_users .................... [[32mCREATE VIEW[0m in 0.18s]
[0m09:16:25.158648 [debug] [Thread-3 (]: Began running node model.growth.fct_referrals_performance
[0m09:16:25.159647 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m09:16:25.162973 [debug] [Thread-4 (]: Began running node model.growth.fct_transaction_metrics
[0m09:16:25.164406 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_users
[0m09:16:25.164406 [info ] [Thread-3 (]: 14 of 21 START sql table model marts.fct_referrals_performance ................. [RUN]
[0m09:16:25.164406 [info ] [Thread-1 (]: 15 of 21 START sql table model marts.fct_token_metrics ......................... [RUN]
[0m09:16:25.164406 [info ] [Thread-4 (]: 16 of 21 START sql table model marts.fct_transaction_metrics ................... [RUN]
[0m09:16:25.170133 [debug] [Thread-2 (]: Began running node model.growth.fct_referral_metrics
[0m09:16:25.170133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.fct_referrals_performance)
[0m09:16:25.171131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_token_metrics)
[0m09:16:25.172131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_transaction_metrics)
[0m09:16:25.177908 [debug] [Thread-4 (]: Began compiling node model.growth.fct_transaction_metrics
[0m09:16:25.173144 [debug] [Thread-3 (]: Began compiling node model.growth.fct_referrals_performance
[0m09:16:25.174417 [debug] [Thread-1 (]: Began compiling node model.growth.fct_token_metrics
[0m09:16:25.173144 [info ] [Thread-2 (]: 17 of 21 START sql table model marts.fct_referral_metrics ...................... [RUN]
[0m09:16:25.185679 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_transaction_metrics"
[0m09:16:25.190675 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_referrals_performance"
[0m09:16:25.195499 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m09:16:25.195499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_users, now model.growth.fct_referral_metrics)
[0m09:16:25.195499 [debug] [Thread-2 (]: Began compiling node model.growth.fct_referral_metrics
[0m09:16:25.195499 [debug] [Thread-4 (]: Began executing node model.growth.fct_transaction_metrics
[0m09:16:25.195499 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m09:16:25.195499 [debug] [Thread-1 (]: Began executing node model.growth.fct_token_metrics
[0m09:16:25.195499 [debug] [Thread-3 (]: Began executing node model.growth.fct_referrals_performance
[0m09:16:25.211551 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_transaction_metrics"
[0m09:16:25.211551 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m09:16:25.211551 [debug] [Thread-2 (]: Began executing node model.growth.fct_referral_metrics
[0m09:16:25.228613 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_referrals_performance"
[0m09:16:25.228613 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:16:25.228613 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m09:16:25.228613 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.228613 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: BEGIN
[0m09:16:25.228613 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:16:25.245747 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:16:25.228613 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: BEGIN
[0m09:16:25.246744 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: BEGIN
[0m09:16:25.247744 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.248743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:25.249746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:16:25.250745 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: BEGIN
[0m09:16:25.253744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:25.325844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m09:16:25.325844 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.325844 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."marts"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m09:16:25.325844 [debug] [Thread-4 (]: SQL status: BEGIN in 0.092 seconds
[0m09:16:25.325844 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:16:25.325844 [debug] [Thread-3 (]: SQL status: BEGIN in 0.090 seconds
[0m09:16:25.341469 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */

  
    

  create  table "nca"."marts"."fct_transaction_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_transactions AS (
    SELECT
        DATE_TRUNC('day', transaction_date) as date,
        token,
        transaction_type,
        COUNT(DISTINCT transaction_id) as transaction_count,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END) as new_user_transactions
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1, 2, 3
)
SELECT 
    *,
    SUM(transaction_count) OVER (PARTITION BY token ORDER BY date) as cumulative_transactions,
    SUM(total_volume) OVER (PARTITION BY token ORDER BY date) as cumulative_volume,
    LAG(transaction_count) OVER (PARTITION BY token ORDER BY date) as prev_day_transactions,
    ROUND(100.0 * (transaction_count - LAG(transaction_count) OVER (PARTITION BY token ORDER BY date)) 
        / NULLIF(LAG(transaction_count) OVER (PARTITION BY token ORDER BY date), 0), 2) as daily_growth_rate
FROM daily_transactions
  );
  
[0m09:16:25.341469 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:16:25.341469 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */

  
    

  create  table "nca"."marts"."fct_referrals_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH referrer_stats AS (
    SELECT 
        r.referrer_user_id,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT CASE WHEN t.transaction_id IS NOT NULL THEN r.referred_user_id END) as activated_referrals,
        SUM(t.amount) as referred_user_volume,
        AVG(t.amount) as avg_referred_transaction_size
    FROM "nca"."marts"."dim_referrals" r
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1
)
SELECT 
    *,
    ROUND(100.0 * activated_referrals / NULLIF(total_referrals, 0), 2) as referral_activation_rate,
    ROUND(referred_user_volume / NULLIF(activated_referrals, 0), 2) as volume_per_activated_referral
FROM referrer_stats
  );
  
[0m09:16:25.341469 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "is_first_transaction" does not exist
LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                               ^

[0m09:16:25.341469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m09:16:25.341469 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: ROLLBACK
[0m09:16:25.341469 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.341469 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: Close
[0m09:16:25.341469 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."marts"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."marts"."dim_referrals" r
    JOIN "nca"."marts"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m09:16:25.357092 [debug] [Thread-4 (]: Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql
[0m09:16:25.357092 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708286710>]}
[0m09:16:25.357092 [error] [Thread-4 (]: 16 of 21 ERROR creating sql table model marts.fct_transaction_metrics .......... [[31mERROR[0m in 0.18s]
[0m09:16:25.357092 [debug] [Thread-4 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:16:25.372737 [debug] [Thread-4 (]: Began running node model.growth.fct_user_acquisition
[0m09:16:25.372737 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_transaction_metrics' to be skipped because of status 'error'.  Reason: Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql.
[0m09:16:25.372737 [info ] [Thread-4 (]: 18 of 21 START sql table model marts.fct_user_acquisition ...................... [RUN]
[0m09:16:25.397654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_transaction_metrics, now model.growth.fct_user_acquisition)
[0m09:16:25.397654 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_acquisition
[0m09:16:25.416162 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_acquisition"
[0m09:16:25.417086 [debug] [Thread-3 (]: SQL status: SELECT 77 in 0.069 seconds
[0m09:16:25.419135 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:16:25.419135 [debug] [Thread-2 (]: SQL status: SELECT 77 in 0.072 seconds
[0m09:16:25.429644 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance__dbt_tmp" rename to "fct_referrals_performance"
[0m09:16:25.430983 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.430983 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_acquisition
[0m09:16:25.430983 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.103 seconds
[0m09:16:25.430983 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics" rename to "fct_referral_metrics__dbt_backup"
[0m09:16:25.430983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:25.448830 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_acquisition"
[0m09:16:25.453829 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.455830 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:16:25.455830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:16:25.456829 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m09:16:25.457832 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:16:25.458831 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:16:25.464290 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.466289 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:16:25.466289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:25.467290 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: BEGIN
[0m09:16:25.467290 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m09:16:25.472286 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.472286 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:16:25.473289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:16:25.474293 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m09:16:25.474293 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:25.478294 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."fct_referrals_performance__dbt_backup"
[0m09:16:25.478294 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:16:25.478294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:25.478294 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:16:25.478294 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.478294 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:16:25.493970 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
drop table if exists "nca"."marts"."fct_referrals_performance__dbt_backup" cascade
[0m09:16:25.493970 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:16:25.493970 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.493970 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:16:25.493970 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:16:25.493970 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:16:25.493970 [debug] [Thread-3 (]: On model.growth.fct_referrals_performance: Close
[0m09:16:25.509593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:16:25.509593 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708265B70>]}
[0m09:16:25.509593 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_referral_metrics__dbt_backup"
[0m09:16:25.509593 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_token_metrics__dbt_backup"
[0m09:16:25.509593 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:16:25.509593 [info ] [Thread-3 (]: 14 of 21 OK created sql table model marts.fct_referrals_performance ............ [[32mSELECT 77[0m in 0.34s]
[0m09:16:25.509593 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:16:25.525218 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."marts"."fct_referral_metrics__dbt_backup" cascade
[0m09:16:25.525218 [debug] [Thread-3 (]: Finished running node model.growth.fct_referrals_performance
[0m09:16:25.525218 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."marts"."fct_token_metrics__dbt_backup" cascade
[0m09:16:25.525218 [debug] [Thread-3 (]: Began running node model.growth.fct_user_engagement
[0m09:16:25.525218 [info ] [Thread-3 (]: 19 of 21 START sql table model marts.fct_user_engagement ....................... [RUN]
[0m09:16:25.535435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.fct_referrals_performance, now model.growth.fct_user_engagement)
[0m09:16:25.536854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:16:25.537948 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:16:25.539328 [debug] [Thread-3 (]: Began compiling node model.growth.fct_user_engagement
[0m09:16:25.540403 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: Close
[0m09:16:25.547389 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m09:16:25.547389 [debug] [Thread-2 (]: On model.growth.fct_referral_metrics: Close
[0m09:16:25.554129 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_user_engagement"
[0m09:16:25.555130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7080BD390>]}
[0m09:16:25.555130 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:16:25.555130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7080AFE20>]}
[0m09:16:25.565044 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */

  
    

  create  table "nca"."marts"."fct_user_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_acquisition AS (
    SELECT 
        DATE_TRUNC('day', signup_date) as acquisition_date,
        country,
        COUNT(DISTINCT user_id) as new_users,
        COUNT(DISTINCT CASE WHEN is_referred_user THEN user_id END) as referred_users,
        COUNT(DISTINCT CASE WHEN NOT is_referred_user THEN user_id END) as organic_users
    FROM "nca"."marts"."int_enriched_users"
    GROUP BY 1, 2
)
SELECT 
    *,
    SUM(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as cumulative_users,
    ROUND(100.0 * referred_users / NULLIF(new_users, 0), 2) as referral_rate,
    LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as prev_day_users,
    ROUND(100.0 * (new_users - LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date)) 
        / NULLIF(LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date), 0), 2) as daily_growth_rate
FROM user_acquisition
  );
  
[0m09:16:25.565044 [info ] [Thread-2 (]: 17 of 21 OK created sql table model marts.fct_referral_metrics ................. [[32mSELECT 77[0m in 0.36s]
[0m09:16:25.565044 [debug] [Thread-2 (]: Finished running node model.growth.fct_referral_metrics
[0m09:16:25.565044 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m09:16:25.565044 [debug] [Thread-3 (]: Began executing node model.growth.fct_user_engagement
[0m09:16:25.563964 [info ] [Thread-1 (]: 15 of 21 OK created sql table model marts.fct_token_metrics .................... [[32mSELECT 4[0m in 0.38s]
[0m09:16:25.574559 [info ] [Thread-2 (]: 20 of 21 START sql table model marts.fct_user_metrics .......................... [RUN]
[0m09:16:25.582319 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m09:16:25.590471 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_user_engagement"
[0m09:16:25.591469 [debug] [Thread-4 (]: SQL status: SELECT 172 in 0.021 seconds
[0m09:16:25.591469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.fct_referral_metrics, now model.growth.fct_user_metrics)
[0m09:16:25.596349 [debug] [Thread-1 (]: Began running node model.growth.fct_user_retention
[0m09:16:25.601897 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:16:25.601897 [debug] [Thread-2 (]: Began compiling node model.growth.fct_user_metrics
[0m09:16:25.601897 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:16:25.601897 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
alter table "nca"."marts"."fct_user_acquisition__dbt_tmp" rename to "fct_user_acquisition"
[0m09:16:25.601897 [info ] [Thread-1 (]: 21 of 21 START sql table model marts.fct_user_retention ........................ [RUN]
[0m09:16:25.618711 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m09:16:25.619711 [debug] [Thread-3 (]: On model.growth.fct_user_engagement: BEGIN
[0m09:16:25.620713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_token_metrics, now model.growth.fct_user_retention)
[0m09:16:25.620713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:25.620713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:16:25.620713 [debug] [Thread-1 (]: Began compiling node model.growth.fct_user_retention
[0m09:16:25.620713 [debug] [Thread-2 (]: Began executing node model.growth.fct_user_metrics
[0m09:16:25.628607 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:16:25.631415 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_user_retention"
[0m09:16:25.647679 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:16:25.647830 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m09:16:25.647830 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:16:25.647830 [debug] [Thread-1 (]: Began executing node model.growth.fct_user_retention
[0m09:16:25.662378 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m09:16:25.665366 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_user_retention"
[0m09:16:25.668367 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_user_acquisition__dbt_backup"
[0m09:16:25.669367 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.671370 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:16:25.673370 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: BEGIN
[0m09:16:25.674371 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:16:25.675369 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
drop table if exists "nca"."marts"."fct_user_acquisition__dbt_backup" cascade
[0m09:16:25.676368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:25.679165 [debug] [Thread-1 (]: On model.growth.fct_user_retention: BEGIN
[0m09:16:25.681165 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:16:25.682162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:25.685162 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: Close
[0m09:16:25.689164 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7069BD960>]}
[0m09:16:25.692166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m09:16:25.691164 [info ] [Thread-4 (]: 18 of 21 OK created sql table model marts.fct_user_acquisition ................. [[32mSELECT 172[0m in 0.29s]
[0m09:16:25.694163 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:16:25.695214 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_acquisition
[0m09:16:25.695214 [debug] [Thread-3 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */

  
    

  create  table "nca"."marts"."fct_user_engagement__dbt_tmp"
  
  
    as
  
  (
    

WITH user_activity AS (
    SELECT
        u.user_id,
        u.signup_date,
        MIN(t.transaction_date) as first_activity_date,
        MAX(t.transaction_date) as last_activity_date,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        COUNT(DISTINCT t.token) as unique_tokens_used,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2
)
SELECT 
    *,
    DATEDIFF('day', signup_date, first_activity_date) as days_to_activate,
    DATEDIFF('day', signup_date, last_activity_date) as days_since_signup,
    DATEDIFF('day', last_activity_date, CURRENT_DATE) as days_since_last_activity,
    CASE 
        WHEN total_transactions = 0 THEN 'never_active'
        WHEN DATEDIFF('day', last_activity_date, CURRENT_DATE) <= 7 THEN 'active_7d'
        WHEN DATEDIFF('day', last_activity_date, CURRENT_DATE) <= 30 THEN 'active_30d'
        ELSE 'inactive'
    END as activity_status
FROM user_activity
  );
  
[0m09:16:25.695214 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function datediff(unknown, date, timestamp without time zone) does not exist
LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:16:25.695214 [debug] [Thread-3 (]: On model.growth.fct_user_engagement: ROLLBACK
[0m09:16:25.695214 [debug] [Thread-3 (]: On model.growth.fct_user_engagement: Close
[0m09:16:25.695214 [debug] [Thread-3 (]: Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql
[0m09:16:25.710844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7081176A0>]}
[0m09:16:25.710844 [error] [Thread-3 (]: 19 of 21 ERROR creating sql table model marts.fct_user_engagement .............. [[31mERROR[0m in 0.19s]
[0m09:16:25.717016 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_engagement
[0m09:16:25.720500 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_engagement' to be skipped because of status 'error'.  Reason: Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql.
[0m09:16:25.786677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m09:16:25.787677 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.788678 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."marts"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m09:16:25.789677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m09:16:25.790673 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:16:25.791676 [debug] [Thread-1 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */

  
    

  create  table "nca"."marts"."fct_user_retention__dbt_tmp"
  
  
    as
  
  (
    

WITH user_cohorts AS (
    SELECT
        user_id,
        DATE_TRUNC('month', signup_date) as cohort_month,
        DATE_TRUNC('month', transaction_date) as activity_month,
        COUNT(DISTINCT transaction_id) as transactions,
        SUM(amount) as volume
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3
),

cohort_sizes AS (
    SELECT
        cohort_month,
        COUNT(DISTINCT user_id) as cohort_size
    FROM user_cohorts
    GROUP BY 1
),

retention_data AS (
    SELECT
        c.cohort_month,
        c.activity_month,
        COUNT(DISTINCT c.user_id) as active_users,
        cs.cohort_size,
        DATEDIFF('month', c.cohort_month, c.activity_month) as months_since_signup
    FROM user_cohorts c
    JOIN cohort_sizes cs ON c.cohort_month = cs.cohort_month
    GROUP BY 1, 2, 4, 5
)
SELECT 
    *,
    ROUND(100.0 * active_users / cohort_size, 2) as retention_rate
FROM retention_data

-- models/marts/transaction_metrics/fct_transaction_metrics.sql
WITH daily_transactions AS (
    SELECT
        DATE_TRUNC('day', transaction_date) as date,
        token,
        transaction_type,
        COUNT(DISTINCT transaction_id) as transaction_count,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END) as new_user_transactions
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1, 2, 3
)
SELECT 
    *,
    SUM(transaction_count) OVER (PARTITION BY token ORDER BY date) as cumulative_transactions,
    SUM(total_volume) OVER (PARTITION BY token ORDER BY date) as cumulative_volume,
    LAG(transaction_count) OVER (PARTITION BY token ORDER BY date) as prev_day_transactions,
    ROUND(100.0 * (transaction_count - LAG(transaction_count) OVER (PARTITION BY token ORDER BY date)) 
        / NULLIF(LAG(transaction_count) OVER (PARTITION BY token ORDER BY date), 0), 2) as daily_growth_rate
FROM daily_transactions
  );
  
[0m09:16:25.794677 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WITH"
LINE 52: WITH daily_transactions AS (
         ^

[0m09:16:25.796479 [debug] [Thread-1 (]: On model.growth.fct_user_retention: ROLLBACK
[0m09:16:25.798476 [debug] [Thread-1 (]: On model.growth.fct_user_retention: Close
[0m09:16:25.802476 [debug] [Thread-1 (]: Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  syntax error at or near "WITH"
  LINE 52: WITH daily_transactions AS (
           ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql
[0m09:16:25.804478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70816BE20>]}
[0m09:16:25.805478 [error] [Thread-1 (]: 21 of 21 ERROR creating sql table model marts.fct_user_retention ............... [[31mERROR[0m in 0.18s]
[0m09:16:25.808475 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_retention
[0m09:16:25.811543 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_retention' to be skipped because of status 'error'.  Reason: Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  syntax error at or near "WITH"
  LINE 52: WITH daily_transactions AS (
           ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql.
[0m09:16:25.846713 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.067 seconds
[0m09:16:25.864106 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.865102 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m09:16:25.866102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:16:25.870098 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.870098 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m09:16:25.872100 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:16:25.874098 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:16:25.874098 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.875099 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:16:25.876102 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:16:25.881307 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_user_metrics__dbt_backup"
[0m09:16:25.883309 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:16:25.883309 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."marts"."fct_user_metrics__dbt_backup" cascade
[0m09:16:25.887308 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:16:25.889308 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: Close
[0m09:16:25.890309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af26acea-dc24-46db-a139-3c0105735960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D708287160>]}
[0m09:16:25.891309 [info ] [Thread-2 (]: 20 of 21 OK created sql table model marts.fct_user_metrics ..................... [[32mSELECT 200[0m in 0.30s]
[0m09:16:25.895401 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m09:16:25.895401 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:25.895401 [debug] [MainThread]: On master: BEGIN
[0m09:16:25.895401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:25.949236 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m09:16:25.950236 [debug] [MainThread]: On master: COMMIT
[0m09:16:25.950236 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:25.951237 [debug] [MainThread]: On master: COMMIT
[0m09:16:25.952236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:16:25.952236 [debug] [MainThread]: On master: Close
[0m09:16:25.953237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:25.954238 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:16:25.955239 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:16:25.956241 [debug] [MainThread]: Connection 'model.growth.fct_user_retention' was properly closed.
[0m09:16:25.957242 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m09:16:25.958239 [debug] [MainThread]: Connection 'model.growth.fct_user_engagement' was properly closed.
[0m09:16:25.959236 [debug] [MainThread]: Connection 'model.growth.fct_user_acquisition' was properly closed.
[0m09:16:25.959236 [info ] [MainThread]: 
[0m09:16:25.961238 [info ] [MainThread]: Finished running 11 table models, 10 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m09:16:25.967416 [debug] [MainThread]: Command end result
[0m09:16:26.013535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:16:26.013535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:16:26.034540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:16:26.035541 [info ] [MainThread]: 
[0m09:16:26.036540 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:16:26.038542 [info ] [MainThread]: 
[0m09:16:26.039542 [error] [MainThread]:   Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql
[0m09:16:26.041543 [info ] [MainThread]: 
[0m09:16:26.043542 [error] [MainThread]:   Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql
[0m09:16:26.048545 [info ] [MainThread]: 
[0m09:16:26.049543 [error] [MainThread]:   Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  syntax error at or near "WITH"
  LINE 52: WITH daily_transactions AS (
           ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql
[0m09:16:26.052866 [info ] [MainThread]: 
[0m09:16:26.056518 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=3 SKIP=0 TOTAL=21
[0m09:16:26.059517 [debug] [MainThread]: Command `dbt run` failed at 09:16:26.059517 after 4.86 seconds
[0m09:16:26.063553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7042FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706C13490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D706B94310>]}
[0m09:16:26.063553 [debug] [MainThread]: Flushing usage events
[0m09:16:32.555829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:41.462743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656A3FD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C2AD660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C2AD450>]}


============================== 09:17:41.462743 | 9d342782-1cb8-4c06-b431-6a89fa3a2d5c ==============================
[0m09:17:41.462743 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:17:41.462743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:17:41.772233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C3D86D0>]}
[0m09:17:41.856026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656B73C8B0>]}
[0m09:17:41.857025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:42.281286 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:17:42.638796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:17:42.638796 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_user_retention.sql
[0m09:17:43.097355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.intermediate
- models.growth_metrics.marts
[0m09:17:43.124915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DCDC130>]}
[0m09:17:43.298472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:17:43.298472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:17:43.376638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CC87F40>]}
[0m09:17:43.376638 [info ] [MainThread]: Found 21 models, 29 data tests, 4 sources, 548 macros
[0m09:17:43.376638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165689ED6C0>]}
[0m09:17:43.392221 [info ] [MainThread]: 
[0m09:17:43.392221 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:17:43.397624 [info ] [MainThread]: 
[0m09:17:43.398486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:17:43.412735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:17:43.567032 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:17:43.567032 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:17:43.567032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:43.629529 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m09:17:43.629529 [debug] [ThreadPool]: On list_nca: Close
[0m09:17:43.645151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:17:43.645151 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:17:43.645151 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:17:43.645151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:43.692025 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m09:17:43.692025 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:17:43.692025 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:17:43.707651 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m09:17:43.707651 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:17:43.707651 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:17:43.723282 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:43.723282 [debug] [MainThread]: On master: BEGIN
[0m09:17:43.723282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:17:43.770150 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:17:43.770150 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:43.770150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:17:43.785779 [debug] [MainThread]: SQL status: SELECT 12 in 0.012 seconds
[0m09:17:43.785779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CC848E0>]}
[0m09:17:43.801405 [debug] [MainThread]: On master: ROLLBACK
[0m09:17:43.801405 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:43.801405 [debug] [MainThread]: On master: BEGIN
[0m09:17:43.801405 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:17:43.801405 [debug] [MainThread]: On master: COMMIT
[0m09:17:43.801405 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:43.801405 [debug] [MainThread]: On master: COMMIT
[0m09:17:43.801405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:17:43.801405 [debug] [MainThread]: On master: Close
[0m09:17:43.817026 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m09:17:43.817026 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m09:17:43.817026 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m09:17:43.817026 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m09:17:43.817026 [info ] [Thread-1 (]: 1 of 21 START sql view model marts.stg_market .................................. [RUN]
[0m09:17:43.817026 [info ] [Thread-2 (]: 2 of 21 START sql view model marts.stg_referrals ............................... [RUN]
[0m09:17:43.817026 [info ] [Thread-3 (]: 3 of 21 START sql view model marts.stg_transactions ............................ [RUN]
[0m09:17:43.817026 [info ] [Thread-4 (]: 4 of 21 START sql view model marts.stg_users ................................... [RUN]
[0m09:17:43.830370 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m09:17:43.831378 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m09:17:43.833340 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m09:17:43.835339 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m09:17:43.836133 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m09:17:43.841238 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m09:17:43.843509 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m09:17:43.845506 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m09:17:43.862763 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m09:17:43.862763 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m09:17:43.876183 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m09:17:43.891508 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:17:43.894502 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m09:17:43.895500 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m09:17:43.897500 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m09:17:43.907732 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m09:17:43.976767 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m09:17:43.979766 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m09:17:43.984764 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m09:17:43.989317 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:17:43.989317 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:43.989317 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:43.989317 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:43.989317 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m09:17:43.989317 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:43.989317 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m09:17:43.989317 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m09:17:43.989317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:17:43.989317 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m09:17:43.989317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:17:43.989317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:17:43.989317 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:17:44.098699 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m09:17:44.098699 [debug] [Thread-2 (]: SQL status: BEGIN in 0.099 seconds
[0m09:17:44.098699 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:44.098699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m09:17:44.098699 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:44.098699 [debug] [Thread-4 (]: SQL status: BEGIN in 0.102 seconds
[0m09:17:44.098699 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."marts"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m09:17:44.098699 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:44.098699 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."marts"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m09:17:44.098699 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:44.098699 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."marts"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m09:17:44.098699 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:17:44.114323 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:17:44.114323 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:17:44.129949 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:44.129949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m09:17:44.129949 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:17:44.129949 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:44.129949 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m09:17:44.129949 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:44.145579 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:44.145579 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m09:17:44.145579 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market" rename to "stg_market__dbt_backup"
[0m09:17:44.145579 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.145579 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:17:44.161198 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:44.161198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:17:44.161198 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:17:44.161198 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m09:17:44.161198 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.161198 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:44.176822 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:44.176822 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:44.176822 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:17:44.192444 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market__dbt_tmp" rename to "stg_market"
[0m09:17:44.192444 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m09:17:44.192444 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:17:44.223698 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:17:44.223698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.223698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.223698 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:44.223698 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.223698 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:17:44.223698 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:17:44.223698 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:17:44.223698 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:17:44.223698 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:44.223698 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:44.223698 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:44.223698 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:17:44.223698 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:17:44.239321 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:17:44.239321 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:17:44.239321 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_transactions__dbt_backup"
[0m09:17:44.239321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m09:17:44.254944 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:17:44.254944 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m09:17:44.254944 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m09:17:44.254944 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_market__dbt_backup"
[0m09:17:44.254944 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."marts"."stg_transactions__dbt_backup" cascade
[0m09:17:44.254944 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:17:44.270574 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."stg_referrals__dbt_backup"
[0m09:17:44.270574 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:17:44.270574 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:17:44.270574 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:17:44.270574 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:17:44.270574 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."marts"."stg_market__dbt_backup" cascade
[0m09:17:44.270574 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:17:44.270574 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."marts"."stg_referrals__dbt_backup" cascade
[0m09:17:44.286195 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m09:17:44.286195 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:17:44.286195 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:17:44.286195 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m09:17:44.286195 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m09:17:44.286195 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C237D30>]}
[0m09:17:44.286195 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m09:17:44.301817 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m09:17:44.301817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165696E03D0>]}
[0m09:17:44.301817 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C9CFAC0>]}
[0m09:17:44.301817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DD2E710>]}
[0m09:17:44.301817 [info ] [Thread-3 (]: 3 of 21 OK created sql view model marts.stg_transactions ....................... [[32mCREATE VIEW[0m in 0.45s]
[0m09:17:44.301817 [info ] [Thread-1 (]: 1 of 21 OK created sql view model marts.stg_market ............................. [[32mCREATE VIEW[0m in 0.48s]
[0m09:17:44.301817 [info ] [Thread-4 (]: 4 of 21 OK created sql view model marts.stg_users .............................. [[32mCREATE VIEW[0m in 0.47s]
[0m09:17:44.301817 [info ] [Thread-2 (]: 2 of 21 OK created sql view model marts.stg_referrals .......................... [[32mCREATE VIEW[0m in 0.47s]
[0m09:17:44.317406 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m09:17:44.319401 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m09:17:44.320404 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m09:17:44.325895 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m09:17:44.326448 [debug] [Thread-3 (]: Began running node model.growth.dim_market
[0m09:17:44.326448 [debug] [Thread-1 (]: Began running node model.growth.dim_transactions
[0m09:17:44.326448 [debug] [Thread-4 (]: Began running node model.growth.mart_daily_transactions
[0m09:17:44.326448 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m09:17:44.326448 [info ] [Thread-3 (]: 5 of 21 START sql view model marts.dim_market .................................. [RUN]
[0m09:17:44.326448 [info ] [Thread-1 (]: 6 of 21 START sql view model marts.dim_transactions ............................ [RUN]
[0m09:17:44.335703 [info ] [Thread-4 (]: 7 of 21 START sql table model marts.mart_daily_transactions .................... [RUN]
[0m09:17:44.336699 [info ] [Thread-2 (]: 8 of 21 START sql table model marts.mart_transaction_summary ................... [RUN]
[0m09:17:44.337701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_market)
[0m09:17:44.338700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_transactions)
[0m09:17:44.341443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.mart_daily_transactions)
[0m09:17:44.341443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.mart_transaction_summary)
[0m09:17:44.345810 [debug] [Thread-3 (]: Began compiling node model.growth.dim_market
[0m09:17:44.346811 [debug] [Thread-1 (]: Began compiling node model.growth.dim_transactions
[0m09:17:44.347809 [debug] [Thread-4 (]: Began compiling node model.growth.mart_daily_transactions
[0m09:17:44.347809 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m09:17:44.350822 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_market"
[0m09:17:44.358884 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m09:17:44.358884 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m09:17:44.358884 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m09:17:44.375470 [debug] [Thread-3 (]: Began executing node model.growth.dim_market
[0m09:17:44.375470 [debug] [Thread-1 (]: Began executing node model.growth.dim_transactions
[0m09:17:44.375470 [debug] [Thread-4 (]: Began executing node model.growth.mart_daily_transactions
[0m09:17:44.375470 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_market"
[0m09:17:44.375470 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m09:17:44.390987 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m09:17:44.420732 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m09:17:44.429903 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m09:17:44.430920 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:17:44.431900 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:17:44.432903 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.433901 [debug] [Thread-3 (]: On model.growth.dim_market: BEGIN
[0m09:17:44.435907 [debug] [Thread-1 (]: On model.growth.dim_transactions: BEGIN
[0m09:17:44.435907 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.436900 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: BEGIN
[0m09:17:44.437898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:44.437898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:44.439900 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m09:17:44.439900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:17:44.439900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:17:44.522156 [debug] [Thread-3 (]: SQL status: BEGIN in 0.084 seconds
[0m09:17:44.523156 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:17:44.524159 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."marts"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."marts"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m09:17:44.524159 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:17:44.524159 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:17:44.539836 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."marts"."dim_market__dbt_tmp" rename to "dim_market"
[0m09:17:44.541536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m09:17:44.542539 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:17:44.544535 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:17:44.544535 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m09:17:44.545533 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."marts"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."marts"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m09:17:44.546532 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m09:17:44.547534 [debug] [Thread-3 (]: On model.growth.dim_market: COMMIT
[0m09:17:44.548535 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.549532 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.550533 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:17:44.551533 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."marts"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."marts"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m09:17:44.552532 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."marts"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."marts"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m09:17:44.553533 [debug] [Thread-3 (]: On model.growth.dim_market: COMMIT
[0m09:17:44.553533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:17:44.558163 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:17:44.558163 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m09:17:44.558163 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.014 seconds
[0m09:17:44.558163 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."marts"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m09:17:44.573787 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.573787 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_market__dbt_backup"
[0m09:17:44.573787 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.027 seconds
[0m09:17:44.573787 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions" rename to "mart_daily_transactions__dbt_backup"
[0m09:17:44.573787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.573787 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:17:44.573787 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.589411 [debug] [Thread-1 (]: On model.growth.dim_transactions: COMMIT
[0m09:17:44.589411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:44.589411 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."marts"."dim_market__dbt_backup" cascade
[0m09:17:44.589411 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary" rename to "mart_transaction_summary__dbt_backup"
[0m09:17:44.589411 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:17:44.589411 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.589411 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:17:44.589411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.589411 [debug] [Thread-1 (]: On model.growth.dim_transactions: COMMIT
[0m09:17:44.589411 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m09:17:44.589411 [debug] [Thread-3 (]: On model.growth.dim_market: Close
[0m09:17:44.605035 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.605035 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CB2EE00>]}
[0m09:17:44.605035 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:17:44.605035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:17:44.605035 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m09:17:44.605035 [info ] [Thread-3 (]: 5 of 21 OK created sql view model marts.dim_market ............................. [[32mCREATE VIEW[0m in 0.27s]
[0m09:17:44.620667 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:17:44.620667 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_transactions__dbt_backup"
[0m09:17:44.620667 [debug] [Thread-3 (]: Finished running node model.growth.dim_market
[0m09:17:44.620667 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:44.637282 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.639420 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:17:44.641658 [debug] [Thread-3 (]: Began running node model.growth.dim_users
[0m09:17:44.644758 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:17:44.644758 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:17:44.644758 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."marts"."dim_transactions__dbt_backup" cascade
[0m09:17:44.644758 [info ] [Thread-3 (]: 9 of 21 START sql view model marts.dim_users ................................... [RUN]
[0m09:17:44.644758 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.644758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.dim_users)
[0m09:17:44.644758 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:44.644758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:17:44.644758 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:17:44.656569 [debug] [Thread-3 (]: Began compiling node model.growth.dim_users
[0m09:17:44.664361 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."mart_daily_transactions__dbt_backup"
[0m09:17:44.667355 [debug] [Thread-1 (]: On model.growth.dim_transactions: Close
[0m09:17:44.667355 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:17:44.678387 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:17:44.678387 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:17:44.678387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DD4E380>]}
[0m09:17:44.678387 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."marts"."mart_daily_transactions__dbt_backup" cascade
[0m09:17:44.693854 [debug] [Thread-3 (]: Began executing node model.growth.dim_users
[0m09:17:44.693854 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."mart_transaction_summary__dbt_backup"
[0m09:17:44.693854 [info ] [Thread-1 (]: 6 of 21 OK created sql view model marts.dim_transactions ....................... [[32mCREATE VIEW[0m in 0.34s]
[0m09:17:44.693854 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:17:44.693854 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:17:44.708947 [debug] [Thread-1 (]: Finished running node model.growth.dim_transactions
[0m09:17:44.693854 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:17:44.714022 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: Close
[0m09:17:44.715009 [debug] [Thread-1 (]: Began running node model.growth.dim_referrals
[0m09:17:44.716009 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:17:44.716009 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."marts"."mart_transaction_summary__dbt_backup" cascade
[0m09:17:44.716009 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CB3CCA0>]}
[0m09:17:44.716009 [info ] [Thread-1 (]: 10 of 21 START sql view model marts.dim_referrals .............................. [RUN]
[0m09:17:44.716009 [debug] [Thread-3 (]: On model.growth.dim_users: BEGIN
[0m09:17:44.728343 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:17:44.724338 [info ] [Thread-4 (]: 7 of 21 OK created sql table model marts.mart_daily_transactions ............... [[32mSELECT 1000[0m in 0.37s]
[0m09:17:44.731929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.dim_referrals)
[0m09:17:44.733927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:44.736928 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m09:17:44.736928 [debug] [Thread-4 (]: Finished running node model.growth.mart_daily_transactions
[0m09:17:44.736928 [debug] [Thread-1 (]: Began compiling node model.growth.dim_referrals
[0m09:17:44.747635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DD2E710>]}
[0m09:17:44.748634 [debug] [Thread-4 (]: Began running node model.growth.fct_users_acquisition
[0m09:17:44.761105 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m09:17:44.761105 [info ] [Thread-2 (]: 8 of 21 OK created sql table model marts.mart_transaction_summary .............. [[32mSELECT 8[0m in 0.41s]
[0m09:17:44.761105 [info ] [Thread-4 (]: 11 of 21 START sql table model marts.fct_users_acquisition ..................... [RUN]
[0m09:17:44.761105 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m09:17:44.761105 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_transactions
[0m09:17:44.761105 [debug] [Thread-1 (]: Began executing node model.growth.dim_referrals
[0m09:17:44.761105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.fct_users_acquisition)
[0m09:17:44.775521 [info ] [Thread-2 (]: 12 of 21 START sql view model marts.int_enriched_transactions .................. [RUN]
[0m09:17:44.783872 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m09:17:44.784872 [debug] [Thread-4 (]: Began compiling node model.growth.fct_users_acquisition
[0m09:17:44.785924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.int_enriched_transactions)
[0m09:17:44.800245 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m09:17:44.801302 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_transactions
[0m09:17:44.801302 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:17:44.811153 [debug] [Thread-1 (]: On model.growth.dim_referrals: BEGIN
[0m09:17:44.811153 [debug] [Thread-4 (]: Began executing node model.growth.fct_users_acquisition
[0m09:17:44.811153 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m09:17:44.811153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:44.811153 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m09:17:44.811153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m09:17:44.826808 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:17:44.826808 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:17:44.826808 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_transactions
[0m09:17:44.826808 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:44.840544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:17:44.845535 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m09:17:44.846537 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: BEGIN
[0m09:17:44.854531 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:17:44.857534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:17:44.859575 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:17:44.860574 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:17:44.862576 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: BEGIN
[0m09:17:44.863573 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:17:44.865576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:17:44.868650 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:17:44.870575 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:17:44.871576 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:17:44.875190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:44.875190 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:17:44.875190 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:17:44.875190 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:17:44.875190 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:17:44.890817 [debug] [Thread-3 (]: On model.growth.dim_users: Close
[0m09:17:44.890817 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E23D450>]}
[0m09:17:44.890817 [info ] [Thread-3 (]: 9 of 21 OK created sql view model marts.dim_users .............................. [[32mCREATE VIEW[0m in 0.25s]
[0m09:17:44.890817 [debug] [Thread-3 (]: Finished running node model.growth.dim_users
[0m09:17:44.917097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m09:17:44.917097 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:17:44.917097 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."marts"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."marts"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m09:17:44.928557 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:17:45.020618 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:17:45.020618 [debug] [Thread-2 (]: SQL status: BEGIN in 0.164 seconds
[0m09:17:45.020618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.172 seconds
[0m09:17:45.020618 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."marts"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m09:17:45.020618 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:17:45.020618 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:45.036607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.036997 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."marts"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."marts"."dim_transactions" t
    LEFT JOIN "nca"."marts"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m09:17:45.038847 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."marts"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."marts"."stg_users" u
    LEFT JOIN "nca"."marts"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."marts"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m09:17:45.042752 [debug] [Thread-1 (]: On model.growth.dim_referrals: COMMIT
[0m09:17:45.044334 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:17:45.046346 [debug] [Thread-1 (]: On model.growth.dim_referrals: COMMIT
[0m09:17:45.048409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:45.049423 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:17:45.057069 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_referrals__dbt_backup"
[0m09:17:45.065944 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:17:45.066659 [debug] [Thread-4 (]: SQL status: SELECT 97 in 0.022 seconds
[0m09:17:45.068427 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:17:45.069620 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."marts"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m09:17:45.076965 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:45.078499 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."marts"."dim_referrals__dbt_backup" cascade
[0m09:17:45.080076 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition" rename to "fct_users_acquisition__dbt_backup"
[0m09:17:45.081147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.082837 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:17:45.083878 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.086542 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:17:45.089476 [debug] [Thread-1 (]: On model.growth.dim_referrals: Close
[0m09:17:45.098255 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:45.099619 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:17:45.101409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E3AF160>]}
[0m09:17:45.102848 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m09:17:45.103359 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:17:45.107261 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.106212 [info ] [Thread-1 (]: 10 of 21 OK created sql view model marts.dim_referrals ......................... [[32mCREATE VIEW[0m in 0.37s]
[0m09:17:45.113951 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:17:45.115010 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:17:45.117144 [debug] [Thread-1 (]: Finished running node model.growth.dim_referrals
[0m09:17:45.118209 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:45.126863 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."int_enriched_transactions__dbt_backup"
[0m09:17:45.129233 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:17:45.129695 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:17:45.129695 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_users
[0m09:17:45.135146 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."marts"."int_enriched_transactions__dbt_backup" cascade
[0m09:17:45.135146 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:17:45.150111 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_users_acquisition__dbt_backup"
[0m09:17:45.151174 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:17:45.138399 [info ] [Thread-3 (]: 13 of 21 START sql view model marts.int_enriched_users ......................... [RUN]
[0m09:17:45.152240 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:17:45.156255 [debug] [Thread-2 (]: On model.growth.int_enriched_transactions: Close
[0m09:17:45.160504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.int_enriched_users)
[0m09:17:45.162512 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."marts"."fct_users_acquisition__dbt_backup" cascade
[0m09:17:45.164252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E1C29E0>]}
[0m09:17:45.166322 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_users
[0m09:17:45.172291 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:17:45.185359 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m09:17:45.169302 [info ] [Thread-2 (]: 12 of 21 OK created sql view model marts.int_enriched_transactions ............. [[32mCREATE VIEW[0m in 0.38s]
[0m09:17:45.192456 [debug] [Thread-4 (]: On model.growth.fct_users_acquisition: Close
[0m09:17:45.194547 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_transactions
[0m09:17:45.197366 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_users
[0m09:17:45.198877 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E1C3FA0>]}
[0m09:17:45.201968 [debug] [Thread-1 (]: Began running node model.growth.fct_referrals_performance
[0m09:17:45.209274 [debug] [Thread-2 (]: Began running node model.growth.fct_token_metrics
[0m09:17:45.216086 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m09:17:45.217137 [info ] [Thread-4 (]: 11 of 21 OK created sql table model marts.fct_users_acquisition ................ [[32mSELECT 97[0m in 0.44s]
[0m09:17:45.219182 [info ] [Thread-1 (]: 14 of 21 START sql table model marts.fct_referrals_performance ................. [RUN]
[0m09:17:45.220875 [info ] [Thread-2 (]: 15 of 21 START sql table model marts.fct_token_metrics ......................... [RUN]
[0m09:17:45.223187 [debug] [Thread-4 (]: Finished running node model.growth.fct_users_acquisition
[0m09:17:45.227110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.fct_referrals_performance)
[0m09:17:45.228523 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:17:45.229531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_token_metrics)
[0m09:17:45.231290 [debug] [Thread-4 (]: Began running node model.growth.fct_transaction_metrics
[0m09:17:45.232966 [debug] [Thread-1 (]: Began compiling node model.growth.fct_referrals_performance
[0m09:17:45.234055 [debug] [Thread-3 (]: On model.growth.int_enriched_users: BEGIN
[0m09:17:45.234055 [debug] [Thread-2 (]: Began compiling node model.growth.fct_token_metrics
[0m09:17:45.236391 [info ] [Thread-4 (]: 16 of 21 START sql table model marts.fct_transaction_metrics ................... [RUN]
[0m09:17:45.246372 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_referrals_performance"
[0m09:17:45.247682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:45.250414 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m09:17:45.250414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_transaction_metrics)
[0m09:17:45.250414 [debug] [Thread-1 (]: Began executing node model.growth.fct_referrals_performance
[0m09:17:45.262254 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_referrals_performance"
[0m09:17:45.250414 [debug] [Thread-4 (]: Began compiling node model.growth.fct_transaction_metrics
[0m09:17:45.262254 [debug] [Thread-2 (]: Began executing node model.growth.fct_token_metrics
[0m09:17:45.274830 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.277108 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_transaction_metrics"
[0m09:17:45.297861 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m09:17:45.298859 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: BEGIN
[0m09:17:45.300858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:45.301861 [debug] [Thread-4 (]: Began executing node model.growth.fct_transaction_metrics
[0m09:17:45.302858 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.319815 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_transaction_metrics"
[0m09:17:45.321813 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: BEGIN
[0m09:17:45.323876 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:17:45.323876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:17:45.323876 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: BEGIN
[0m09:17:45.323876 [debug] [Thread-3 (]: SQL status: BEGIN in 0.082 seconds
[0m09:17:45.323876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:17:45.323876 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:17:45.323876 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."marts"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."marts"."dim_users" u
    LEFT JOIN "nca"."marts"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m09:17:45.339507 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:17:45.355146 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:17:45.355146 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."marts"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m09:17:45.355146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.355146 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m09:17:45.355146 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:17:45.355146 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m09:17:45.355146 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:45.370759 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."int_enriched_users__dbt_backup"
[0m09:17:45.370759 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:17:45.370759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m09:17:45.370759 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."marts"."int_enriched_users__dbt_backup" cascade
[0m09:17:45.370759 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.370759 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */

  
    

  create  table "nca"."marts"."fct_referrals_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH referrer_stats AS (
    SELECT 
        r.referrer_user_id,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT CASE WHEN t.transaction_id IS NOT NULL THEN r.referred_user_id END) as activated_referrals,
        SUM(t.amount) as referred_user_volume,
        AVG(t.amount) as avg_referred_transaction_size
    FROM "nca"."marts"."dim_referrals" r
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1
)
SELECT 
    *,
    ROUND(100.0 * activated_referrals / NULLIF(total_referrals, 0), 2) as referral_activation_rate,
    ROUND(referred_user_volume / NULLIF(activated_referrals, 0), 2) as volume_per_activated_referral
FROM referrer_stats
  );
  
[0m09:17:45.370759 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:17:45.386380 [debug] [Thread-3 (]: On model.growth.int_enriched_users: Close
[0m09:17:45.386380 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E1C0AC0>]}
[0m09:17:45.386380 [info ] [Thread-3 (]: 13 of 21 OK created sql view model marts.int_enriched_users .................... [[32mCREATE VIEW[0m in 0.23s]
[0m09:17:45.386380 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_users
[0m09:17:45.402006 [debug] [Thread-3 (]: Began running node model.growth.fct_referral_metrics
[0m09:17:45.402006 [info ] [Thread-3 (]: 17 of 21 START sql table model marts.fct_referral_metrics ...................... [RUN]
[0m09:17:45.402006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_users, now model.growth.fct_referral_metrics)
[0m09:17:45.407761 [debug] [Thread-3 (]: Began compiling node model.growth.fct_referral_metrics
[0m09:17:45.419757 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m09:17:45.421756 [debug] [Thread-3 (]: Began executing node model.growth.fct_referral_metrics
[0m09:17:45.424759 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m09:17:45.440431 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m09:17:45.442953 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.424759 [debug] [Thread-4 (]: SQL status: BEGIN in 0.109 seconds
[0m09:17:45.445601 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."marts"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m09:17:45.446600 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:17:45.447599 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.449600 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */

  
    

  create  table "nca"."marts"."fct_transaction_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_transactions AS (
    SELECT
        DATE_TRUNC('day', transaction_date) as date,
        token,
        transaction_type,
        COUNT(DISTINCT transaction_id) as transaction_count,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END) as new_user_transactions
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1, 2, 3
)
SELECT 
    *,
    SUM(transaction_count) OVER (PARTITION BY token ORDER BY date) as cumulative_transactions,
    SUM(total_volume) OVER (PARTITION BY token ORDER BY date) as cumulative_volume,
    LAG(transaction_count) OVER (PARTITION BY token ORDER BY date) as prev_day_transactions,
    ROUND(100.0 * (transaction_count - LAG(transaction_count) OVER (PARTITION BY token ORDER BY date)) 
        / NULLIF(LAG(transaction_count) OVER (PARTITION BY token ORDER BY date), 0), 2) as daily_growth_rate
FROM daily_transactions
  );
  
[0m09:17:45.449600 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: BEGIN
[0m09:17:45.451600 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:45.451600 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "is_first_transaction" does not exist
LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                               ^

[0m09:17:45.451600 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: ROLLBACK
[0m09:17:45.451600 [debug] [Thread-4 (]: On model.growth.fct_transaction_metrics: Close
[0m09:17:45.464495 [debug] [Thread-4 (]: Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql
[0m09:17:45.465447 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E354730>]}
[0m09:17:45.465447 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.083 seconds
[0m09:17:45.465447 [error] [Thread-4 (]: 16 of 21 ERROR creating sql table model marts.fct_transaction_metrics .......... [[31mERROR[0m in 0.22s]
[0m09:17:45.479180 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.482215 [debug] [Thread-4 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:17:45.484210 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance" rename to "fct_referrals_performance__dbt_backup"
[0m09:17:45.485212 [debug] [Thread-4 (]: Began running node model.growth.fct_user_acquisition
[0m09:17:45.486210 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_transaction_metrics' to be skipped because of status 'error'.  Reason: Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql.
[0m09:17:45.487263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:17:45.503780 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.487263 [info ] [Thread-4 (]: 18 of 21 START sql table model marts.fct_user_acquisition ...................... [RUN]
[0m09:17:45.503780 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance__dbt_tmp" rename to "fct_referrals_performance"
[0m09:17:45.511692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.503780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_transaction_metrics, now model.growth.fct_user_acquisition)
[0m09:17:45.515183 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:17:45.516181 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_acquisition
[0m09:17:45.517180 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.529146 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:17:45.527148 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_acquisition"
[0m09:17:45.532111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:45.532111 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_acquisition
[0m09:17:45.543857 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.095 seconds
[0m09:17:45.544362 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_referrals_performance__dbt_backup"
[0m09:17:45.544362 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_acquisition"
[0m09:17:45.559542 [debug] [Thread-3 (]: SQL status: BEGIN in 0.108 seconds
[0m09:17:45.561540 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.562540 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:17:45.563538 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.564552 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m09:17:45.565539 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.566537 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
drop table if exists "nca"."marts"."fct_referrals_performance__dbt_backup" cascade
[0m09:17:45.566537 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."marts"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."marts"."dim_referrals" r
    JOIN "nca"."marts"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m09:17:45.567539 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: BEGIN
[0m09:17:45.568540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.569544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:17:45.578753 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.579734 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:17:45.580733 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m09:17:45.584736 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: Close
[0m09:17:45.586735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CA3AF80>]}
[0m09:17:45.587735 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:17:45.591602 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:17:45.589736 [info ] [Thread-1 (]: 14 of 21 OK created sql table model marts.fct_referrals_performance ............ [[32mSELECT 77[0m in 0.36s]
[0m09:17:45.591602 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.591602 [debug] [Thread-1 (]: Finished running node model.growth.fct_referrals_performance
[0m09:17:45.591602 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:17:45.591602 [debug] [Thread-1 (]: Began running node model.growth.fct_user_engagement
[0m09:17:45.591602 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:45.591602 [info ] [Thread-1 (]: 19 of 21 START sql table model marts.fct_user_engagement ....................... [RUN]
[0m09:17:45.611934 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_token_metrics__dbt_backup"
[0m09:17:45.611934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_referrals_performance, now model.growth.fct_user_engagement)
[0m09:17:45.611934 [debug] [Thread-1 (]: Began compiling node model.growth.fct_user_engagement
[0m09:17:45.611934 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:17:45.631591 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_user_engagement"
[0m09:17:45.632592 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."marts"."fct_token_metrics__dbt_backup" cascade
[0m09:17:45.634598 [debug] [Thread-1 (]: Began executing node model.growth.fct_user_engagement
[0m09:17:45.642953 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:17:45.645196 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_user_engagement"
[0m09:17:45.645196 [debug] [Thread-3 (]: SQL status: SELECT 77 in 0.082 seconds
[0m09:17:45.645196 [debug] [Thread-2 (]: On model.growth.fct_token_metrics: Close
[0m09:17:45.662826 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.662826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E14BBB0>]}
[0m09:17:45.662826 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:17:45.662826 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics" rename to "fct_referral_metrics__dbt_backup"
[0m09:17:45.677722 [debug] [Thread-4 (]: SQL status: BEGIN in 0.108 seconds
[0m09:17:45.662826 [info ] [Thread-2 (]: 15 of 21 OK created sql table model marts.fct_token_metrics .................... [[32mSELECT 4[0m in 0.43s]
[0m09:17:45.678717 [debug] [Thread-1 (]: On model.growth.fct_user_engagement: BEGIN
[0m09:17:45.680719 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.681722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.682716 [debug] [Thread-2 (]: Finished running node model.growth.fct_token_metrics
[0m09:17:45.683717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:45.684716 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */

  
    

  create  table "nca"."marts"."fct_user_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_acquisition AS (
    SELECT 
        DATE_TRUNC('day', signup_date) as acquisition_date,
        country,
        COUNT(DISTINCT user_id) as new_users,
        COUNT(DISTINCT CASE WHEN is_referred_user THEN user_id END) as referred_users,
        COUNT(DISTINCT CASE WHEN NOT is_referred_user THEN user_id END) as organic_users
    FROM "nca"."marts"."int_enriched_users"
    GROUP BY 1, 2
)
SELECT 
    *,
    SUM(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as cumulative_users,
    ROUND(100.0 * referred_users / NULLIF(new_users, 0), 2) as referral_rate,
    LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as prev_day_users,
    ROUND(100.0 * (new_users - LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date)) 
        / NULLIF(LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date), 0), 2) as daily_growth_rate
FROM user_acquisition
  );
  
[0m09:17:45.693723 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.695573 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m09:17:45.696705 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m09:17:45.696705 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.696705 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:17:45.696705 [info ] [Thread-2 (]: 20 of 21 START sql table model marts.fct_user_metrics .......................... [RUN]
[0m09:17:45.709269 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.713364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.fct_token_metrics, now model.growth.fct_user_metrics)
[0m09:17:45.714360 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:17:45.716371 [debug] [Thread-2 (]: Began compiling node model.growth.fct_user_metrics
[0m09:17:45.717362 [debug] [Thread-4 (]: SQL status: SELECT 172 in 0.019 seconds
[0m09:17:45.727324 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m09:17:45.729422 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.742217 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
alter table "nca"."marts"."fct_user_acquisition" rename to "fct_user_acquisition__dbt_backup"
[0m09:17:45.729422 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m09:17:45.746970 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."fct_referral_metrics__dbt_backup"
[0m09:17:45.746970 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:17:45.746970 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:17:45.760040 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.762040 [debug] [Thread-2 (]: Began executing node model.growth.fct_user_metrics
[0m09:17:45.763039 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."marts"."fct_referral_metrics__dbt_backup" cascade
[0m09:17:45.764039 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
alter table "nca"."marts"."fct_user_acquisition__dbt_tmp" rename to "fct_user_acquisition"
[0m09:17:45.771037 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m09:17:45.773044 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:45.778123 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:17:45.779123 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:17:45.780124 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.782120 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:45.785118 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: Close
[0m09:17:45.786120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m09:17:45.787119 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:17:45.789121 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: BEGIN
[0m09:17:45.791118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C9CCA90>]}
[0m09:17:45.791118 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:17:45.791118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:17:45.791118 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:45.791118 [info ] [Thread-3 (]: 17 of 21 OK created sql table model marts.fct_referral_metrics ................. [[32mSELECT 77[0m in 0.39s]
[0m09:17:45.791118 [debug] [Thread-1 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */

  
    

  create  table "nca"."marts"."fct_user_engagement__dbt_tmp"
  
  
    as
  
  (
    

WITH user_activity AS (
    SELECT
        u.user_id,
        u.signup_date,
        MIN(t.transaction_date) as first_activity_date,
        MAX(t.transaction_date) as last_activity_date,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        COUNT(DISTINCT t.token) as unique_tokens_used,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2
)
SELECT 
    *,
    DATEDIFF('day', signup_date, first_activity_date) as days_to_activate,
    DATEDIFF('day', signup_date, last_activity_date) as days_since_signup,
    DATEDIFF('day', last_activity_date, CURRENT_DATE) as days_since_last_activity,
    CASE 
        WHEN total_transactions = 0 THEN 'never_active'
        WHEN DATEDIFF('day', last_activity_date, CURRENT_DATE) <= 7 THEN 'active_7d'
        WHEN DATEDIFF('day', last_activity_date, CURRENT_DATE) <= 30 THEN 'active_30d'
        ELSE 'inactive'
    END as activity_status
FROM user_activity
  );
  
[0m09:17:45.806791 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_user_acquisition__dbt_backup"
[0m09:17:45.810799 [debug] [Thread-3 (]: Finished running node model.growth.fct_referral_metrics
[0m09:17:45.813225 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:17:45.814732 [debug] [Thread-3 (]: Began running node model.growth.fct_user_retention
[0m09:17:45.815874 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function datediff(unknown, date, timestamp without time zone) does not exist
LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:17:45.815874 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
drop table if exists "nca"."marts"."fct_user_acquisition__dbt_backup" cascade
[0m09:17:45.815874 [info ] [Thread-3 (]: 21 of 21 START sql table model marts.fct_user_retention ........................ [RUN]
[0m09:17:45.815874 [debug] [Thread-1 (]: On model.growth.fct_user_engagement: ROLLBACK
[0m09:17:45.828492 [debug] [Thread-1 (]: On model.growth.fct_user_engagement: Close
[0m09:17:45.815874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.fct_referral_metrics, now model.growth.fct_user_retention)
[0m09:17:45.832267 [debug] [Thread-3 (]: Began compiling node model.growth.fct_user_retention
[0m09:17:45.833277 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:17:45.847029 [debug] [Thread-4 (]: On model.growth.fct_user_acquisition: Close
[0m09:17:45.849033 [debug] [Thread-1 (]: Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql
[0m09:17:45.851031 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_user_retention"
[0m09:17:45.851031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E354730>]}
[0m09:17:45.851031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656975BAC0>]}
[0m09:17:45.861840 [debug] [Thread-3 (]: Began executing node model.growth.fct_user_retention
[0m09:17:45.862937 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_user_retention"
[0m09:17:45.877558 [error] [Thread-1 (]: 19 of 21 ERROR creating sql table model marts.fct_user_engagement .............. [[31mERROR[0m in 0.24s]
[0m09:17:45.878149 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:17:45.878149 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_engagement
[0m09:17:45.878149 [debug] [Thread-3 (]: On model.growth.fct_user_retention: BEGIN
[0m09:17:45.878149 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_engagement' to be skipped because of status 'error'.  Reason: Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql.
[0m09:17:45.878149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:45.897192 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:17:45.898194 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:45.900417 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."marts"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m09:17:45.862937 [info ] [Thread-4 (]: 18 of 21 OK created sql table model marts.fct_user_acquisition ................. [[32mSELECT 172[0m in 0.35s]
[0m09:17:45.902785 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_acquisition
[0m09:17:45.980020 [debug] [Thread-3 (]: SQL status: BEGIN in 0.093 seconds
[0m09:17:45.981015 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:17:45.982018 [debug] [Thread-3 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */

  
    

  create  table "nca"."marts"."fct_user_retention__dbt_tmp"
  
  
    as
  
  (
    

WITH user_cohorts AS (
    SELECT
        user_id,
        DATE_TRUNC('month', signup_date) as cohort_month,
        DATE_TRUNC('month', transaction_date) as activity_month,
        COUNT(DISTINCT transaction_id) as transactions,
        SUM(amount) as volume
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3
),

cohort_sizes AS (
    SELECT
        cohort_month,
        COUNT(DISTINCT user_id) as cohort_size
    FROM user_cohorts
    GROUP BY 1
),

retention_data AS (
    SELECT
        c.cohort_month,
        c.activity_month,
        COUNT(DISTINCT c.user_id) as active_users,
        cs.cohort_size,
        DATEDIFF('month', c.cohort_month, c.activity_month) as months_since_signup
    FROM user_cohorts c
    JOIN cohort_sizes cs ON c.cohort_month = cs.cohort_month
    GROUP BY 1, 2, 4, 5
)
SELECT 
    *,
    ROUND(100.0 * active_users / cohort_size, 2) as retention_rate
FROM retention_data
  );
  
[0m09:17:45.985016 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column reference "user_id" is ambiguous
LINE 16:         user_id,
                 ^

[0m09:17:45.986019 [debug] [Thread-3 (]: On model.growth.fct_user_retention: ROLLBACK
[0m09:17:45.988018 [debug] [Thread-3 (]: On model.growth.fct_user_retention: Close
[0m09:17:45.992021 [debug] [Thread-3 (]: Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  column reference "user_id" is ambiguous
  LINE 16:         user_id,
                   ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql
[0m09:17:45.992021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C9CCA90>]}
[0m09:17:45.992021 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.093 seconds
[0m09:17:45.992021 [error] [Thread-3 (]: 21 of 21 ERROR creating sql table model marts.fct_user_retention ............... [[31mERROR[0m in 0.18s]
[0m09:17:45.992021 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:45.992021 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_retention
[0m09:17:45.992021 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m09:17:45.992021 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_retention' to be skipped because of status 'error'.  Reason: Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  column reference "user_id" is ambiguous
  LINE 16:         user_id,
                   ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql.
[0m09:17:45.992021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:46.017192 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:46.017192 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m09:17:46.017192 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:17:46.024689 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:17:46.026708 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:46.028766 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:17:46.028766 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:17:46.028766 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_user_metrics__dbt_backup"
[0m09:17:46.028766 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:17:46.028766 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."marts"."fct_user_metrics__dbt_backup" cascade
[0m09:17:46.043647 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:17:46.046649 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: Close
[0m09:17:46.048646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d342782-1cb8-4c06-b431-6a89fa3a2d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656A1D1990>]}
[0m09:17:46.049645 [info ] [Thread-2 (]: 20 of 21 OK created sql table model marts.fct_user_metrics ..................... [[32mSELECT 200[0m in 0.33s]
[0m09:17:46.052644 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m09:17:46.054642 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:46.055653 [debug] [MainThread]: On master: BEGIN
[0m09:17:46.055653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:17:46.113209 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m09:17:46.114208 [debug] [MainThread]: On master: COMMIT
[0m09:17:46.115204 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:46.115204 [debug] [MainThread]: On master: COMMIT
[0m09:17:46.116207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:17:46.117207 [debug] [MainThread]: On master: Close
[0m09:17:46.118207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:46.119208 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:17:46.120208 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:17:46.121210 [debug] [MainThread]: Connection 'model.growth.fct_user_engagement' was properly closed.
[0m09:17:46.122208 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m09:17:46.123205 [debug] [MainThread]: Connection 'model.growth.fct_user_retention' was properly closed.
[0m09:17:46.123205 [debug] [MainThread]: Connection 'model.growth.fct_user_acquisition' was properly closed.
[0m09:17:46.125291 [info ] [MainThread]: 
[0m09:17:46.127327 [info ] [MainThread]: Finished running 11 table models, 10 view models in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m09:17:46.132321 [debug] [MainThread]: Command end result
[0m09:17:46.177993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:17:46.194789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:17:46.204781 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:17:46.204781 [info ] [MainThread]: 
[0m09:17:46.205784 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:17:46.209582 [info ] [MainThread]: 
[0m09:17:46.210577 [error] [MainThread]:   Database Error in model fct_transaction_metrics (models\marts\fct_transaction_metrics.sql)
  column "is_first_transaction" does not exist
  LINE 23:         SUM(CASE WHEN is_first_transaction THEN 1 ELSE 0 END...
                                 ^
  compiled code at target\run\growth\models\marts\fct_transaction_metrics.sql
[0m09:17:46.212886 [info ] [MainThread]: 
[0m09:17:46.213890 [error] [MainThread]:   Database Error in model fct_user_engagement (models\marts\fct_user_engagement.sql)
  function datediff(unknown, date, timestamp without time zone) does not exist
  LINE 31:     DATEDIFF('day', signup_date, first_activity_date) as day...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\growth\models\marts\fct_user_engagement.sql
[0m09:17:46.215885 [info ] [MainThread]: 
[0m09:17:46.216887 [error] [MainThread]:   Database Error in model fct_user_retention (models\marts\fct_user_retention.sql)
  column reference "user_id" is ambiguous
  LINE 16:         user_id,
                   ^
  compiled code at target\run\growth\models\marts\fct_user_retention.sql
[0m09:17:46.218889 [info ] [MainThread]: 
[0m09:17:46.232948 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=3 SKIP=0 TOTAL=21
[0m09:17:46.277891 [debug] [MainThread]: Command `dbt run` failed at 09:17:46.277891 after 4.95 seconds
[0m09:17:46.279887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656A3FD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CBB9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656CBB9EA0>]}
[0m09:17:46.280887 [debug] [MainThread]: Flushing usage events
[0m09:18:00.442214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:15.822011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605EF4D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026060DFD570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026060DFD360>]}


============================== 09:32:15.822011 | 1957658c-0b9d-4f52-ab58-fc84552896cf ==============================
[0m09:32:15.822011 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:32:15.822011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:32:16.162280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605D7135E0>]}
[0m09:32:16.255351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260608BB5E0>]}
[0m09:32:16.257393 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:16.688946 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:32:17.092618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:32:17.092618 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_transaction_metrics.sql
[0m09:32:17.092618 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_user_retention.sql
[0m09:32:17.092618 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_user_engagement.sql
[0m09:32:17.471411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.marts
- models.growth_metrics.intermediate
[0m09:32:17.515388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062820130>]}
[0m09:32:17.672435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:32:17.672435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:32:17.781811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026060EEF160>]}
[0m09:32:17.781811 [info ] [MainThread]: Found 21 models, 29 data tests, 4 sources, 548 macros
[0m09:32:17.781811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606159D450>]}
[0m09:32:17.781811 [info ] [MainThread]: 
[0m09:32:17.781811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:32:17.781811 [info ] [MainThread]: 
[0m09:32:17.797545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:32:17.808869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:32:17.958417 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:32:17.958417 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:32:17.958417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:18.020942 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.062 seconds
[0m09:32:18.020942 [debug] [ThreadPool]: On list_nca: Close
[0m09:32:18.036538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:32:18.036538 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:32:18.036538 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:32:18.036538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:18.083410 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:32:18.083410 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:32:18.083410 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:32:18.099081 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m09:32:18.099081 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:32:18.099081 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:32:18.114703 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:18.114703 [debug] [MainThread]: On master: BEGIN
[0m09:32:18.114703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:18.161535 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:32:18.161535 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:18.161535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:32:18.177207 [debug] [MainThread]: SQL status: SELECT 12 in 0.012 seconds
[0m09:32:18.177207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606168A500>]}
[0m09:32:18.177207 [debug] [MainThread]: On master: ROLLBACK
[0m09:32:18.177207 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:18.177207 [debug] [MainThread]: On master: BEGIN
[0m09:32:18.177207 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:32:18.177207 [debug] [MainThread]: On master: COMMIT
[0m09:32:18.177207 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:18.177207 [debug] [MainThread]: On master: COMMIT
[0m09:32:18.177207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:18.177207 [debug] [MainThread]: On master: Close
[0m09:32:18.192788 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m09:32:18.192788 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m09:32:18.192788 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m09:32:18.192788 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m09:32:18.192788 [info ] [Thread-1 (]: 1 of 21 START sql view model marts.stg_market .................................. [RUN]
[0m09:32:18.192788 [info ] [Thread-2 (]: 2 of 21 START sql view model marts.stg_referrals ............................... [RUN]
[0m09:32:18.192788 [info ] [Thread-3 (]: 3 of 21 START sql view model marts.stg_transactions ............................ [RUN]
[0m09:32:18.192788 [info ] [Thread-4 (]: 4 of 21 START sql view model marts.stg_users ................................... [RUN]
[0m09:32:18.192788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m09:32:18.208416 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m09:32:18.211243 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m09:32:18.214055 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m09:32:18.216052 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m09:32:18.216052 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m09:32:18.217056 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m09:32:18.218243 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m09:32:18.231741 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m09:32:18.231741 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m09:32:18.247356 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m09:32:18.247356 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:32:18.264065 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m09:32:18.264065 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m09:32:18.264065 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m09:32:18.264065 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m09:32:18.313663 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m09:32:18.313663 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m09:32:18.329328 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m09:32:18.329328 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:32:18.329328 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.329328 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.329328 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.329328 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m09:32:18.329328 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.329328 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m09:32:18.344953 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m09:32:18.344953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:18.344953 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m09:32:18.344953 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:32:18.344953 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:32:18.344953 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:32:18.426619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m09:32:18.426619 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.426619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m09:32:18.426619 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."marts"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m09:32:18.442242 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.442242 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."marts"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m09:32:18.442242 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:32:18.442242 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m09:32:18.442242 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.442242 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.442242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:32:18.442242 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:32:18.442242 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."marts"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m09:32:18.442242 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:32:18.457866 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.457866 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.457866 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market" rename to "stg_market__dbt_backup"
[0m09:32:18.473497 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m09:32:18.473497 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:32:18.473497 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:32:18.473497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:18.473497 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:18.473497 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.473497 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.489118 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.489118 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.489118 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:32:18.489118 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m09:32:18.489118 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market__dbt_tmp" rename to "stg_market"
[0m09:32:18.489118 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m09:32:18.489118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.489118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.489118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.504739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:18.504739 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.504739 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.520369 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:32:18.520369 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:32:18.520369 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:32:18.520369 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m09:32:18.535990 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.535990 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.535990 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:32:18.535990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.535990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:18.535990 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:32:18.535990 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:32:18.535990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:32:18.535990 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:32:18.535990 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.535990 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:18.551619 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_market__dbt_backup"
[0m09:32:18.551619 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.551619 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:32:18.551619 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_transactions__dbt_backup"
[0m09:32:18.567243 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:32:18.567243 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:32:18.567243 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:32:18.567243 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:18.567243 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."marts"."stg_market__dbt_backup" cascade
[0m09:32:18.567243 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."marts"."stg_transactions__dbt_backup" cascade
[0m09:32:18.567243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:18.582866 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:32:18.582866 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."stg_referrals__dbt_backup"
[0m09:32:18.582866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:32:18.582866 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:32:18.582866 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:18.582866 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:32:18.598492 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m09:32:18.598492 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m09:32:18.598492 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:32:18.598492 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."marts"."stg_referrals__dbt_backup" cascade
[0m09:32:18.598492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260627F1EA0>]}
[0m09:32:18.598492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260628AED10>]}
[0m09:32:18.614120 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:32:18.614120 [info ] [Thread-1 (]: 1 of 21 OK created sql view model marts.stg_market ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m09:32:18.614120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:32:18.614120 [info ] [Thread-3 (]: 3 of 21 OK created sql view model marts.stg_transactions ....................... [[32mCREATE VIEW[0m in 0.39s]
[0m09:32:18.614120 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m09:32:18.614120 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m09:32:18.614120 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m09:32:18.614120 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m09:32:18.614120 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062C93A90>]}
[0m09:32:18.633822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062C92890>]}
[0m09:32:18.636779 [debug] [Thread-3 (]: Began running node model.growth.dim_market
[0m09:32:18.637778 [debug] [Thread-1 (]: Began running node model.growth.dim_transactions
[0m09:32:18.639918 [info ] [Thread-4 (]: 4 of 21 OK created sql view model marts.stg_users .............................. [[32mCREATE VIEW[0m in 0.40s]
[0m09:32:18.640456 [info ] [Thread-2 (]: 2 of 21 OK created sql view model marts.stg_referrals .......................... [[32mCREATE VIEW[0m in 0.43s]
[0m09:32:18.640456 [info ] [Thread-3 (]: 5 of 21 START sql view model marts.dim_market .................................. [RUN]
[0m09:32:18.649689 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m09:32:18.650536 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m09:32:18.650536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_market)
[0m09:32:18.640456 [info ] [Thread-1 (]: 6 of 21 START sql view model marts.dim_transactions ............................ [RUN]
[0m09:32:18.650536 [debug] [Thread-4 (]: Began running node model.growth.mart_daily_transactions
[0m09:32:18.650536 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m09:32:18.650536 [debug] [Thread-3 (]: Began compiling node model.growth.dim_market
[0m09:32:18.650536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_transactions)
[0m09:32:18.650536 [info ] [Thread-4 (]: 7 of 21 START sql table model marts.mart_daily_transactions .................... [RUN]
[0m09:32:18.671253 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_market"
[0m09:32:18.650536 [info ] [Thread-2 (]: 8 of 21 START sql table model marts.mart_transaction_summary ................... [RUN]
[0m09:32:18.673255 [debug] [Thread-1 (]: Began compiling node model.growth.dim_transactions
[0m09:32:18.674254 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.mart_daily_transactions)
[0m09:32:18.676252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.mart_transaction_summary)
[0m09:32:18.685289 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m09:32:18.686291 [debug] [Thread-3 (]: Began executing node model.growth.dim_market
[0m09:32:18.687288 [debug] [Thread-4 (]: Began compiling node model.growth.mart_daily_transactions
[0m09:32:18.688286 [debug] [Thread-2 (]: Began compiling node model.growth.mart_transaction_summary
[0m09:32:18.697660 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_market"
[0m09:32:18.697660 [debug] [Thread-1 (]: Began executing node model.growth.dim_transactions
[0m09:32:18.697660 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.mart_daily_transactions"
[0m09:32:18.714886 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.mart_transaction_summary"
[0m09:32:18.714886 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m09:32:18.714886 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:32:18.714886 [debug] [Thread-4 (]: Began executing node model.growth.mart_daily_transactions
[0m09:32:18.714886 [debug] [Thread-2 (]: Began executing node model.growth.mart_transaction_summary
[0m09:32:18.714886 [debug] [Thread-3 (]: On model.growth.dim_market: BEGIN
[0m09:32:18.714886 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:32:18.769923 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.mart_daily_transactions"
[0m09:32:18.769923 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.mart_transaction_summary"
[0m09:32:18.770924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:18.771922 [debug] [Thread-1 (]: On model.growth.dim_transactions: BEGIN
[0m09:32:18.773931 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:18.774926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:18.775926 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:18.777925 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: BEGIN
[0m09:32:18.780982 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: BEGIN
[0m09:32:18.780982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:18.780982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:18.843487 [debug] [Thread-3 (]: SQL status: BEGIN in 0.082 seconds
[0m09:32:18.843487 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:32:18.843487 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."marts"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."marts"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m09:32:18.859109 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:32:18.859109 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:32:18.859109 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."marts"."dim_market__dbt_tmp" rename to "dim_market"
[0m09:32:18.859109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m09:32:18.874736 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:32:18.874736 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.874736 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."marts"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."marts"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m09:32:18.874736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m09:32:18.874736 [debug] [Thread-3 (]: On model.growth.dim_market: COMMIT
[0m09:32:18.874736 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:18.874736 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:32:18.874736 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */

  
    

  create  table "nca"."marts"."mart_transaction_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH transaction_type_summary AS (
    SELECT
        transaction_type,
        COUNT(*) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as transaction_type_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY transaction_type
),

token_summary AS (
    SELECT
        token,
        COUNT(*) as total_transactions,
        SUM(amount) as total_volume,
        AVG(amount) as avg_transaction_size,
        COUNT(DISTINCT user_id) as unique_users,
        COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () as token_percentage
    FROM "nca"."marts"."stg_transactions"
    GROUP BY token
),

time_trends AS (
    SELECT
        DATE_TRUNC('day', timestamp) as day,
        COUNT(*) as daily_transactions,
        SUM(amount) as daily_volume,
        COUNT(DISTINCT user_id) as daily_active_users
    FROM "nca"."marts"."stg_transactions"
    GROUP BY DATE_TRUNC('day', timestamp)
)

SELECT
    'transaction_type' as metric_type,
    transaction_type as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    transaction_type_percentage as percentage
FROM transaction_type_summary

UNION ALL

SELECT
    'token' as metric_type,
    token as category,
    total_transactions,
    total_volume,
    avg_transaction_size,
    unique_users,
    token_percentage as percentage
FROM token_summary
  );
  
[0m09:32:18.874736 [debug] [Thread-3 (]: On model.growth.dim_market: COMMIT
[0m09:32:18.874736 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:18.890762 [debug] [Thread-4 (]: SQL status: BEGIN in 0.107 seconds
[0m09:32:18.891264 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_market__dbt_backup"
[0m09:32:18.891264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:32:18.891264 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:18.891264 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_market"
[0m09:32:18.902476 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:32:18.903477 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */

  
    

  create  table "nca"."marts"."mart_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    timestamp,
    token,
    transaction_type,
    COUNT(*) as daily_transaction_count,
    SUM(amount) as daily_volume,
    AVG(amount) as avg_transaction_size
FROM "nca"."marts"."stg_transactions"
GROUP BY 
    timestamp,
    token,
    transaction_type
  );
  
[0m09:32:18.904475 [debug] [Thread-3 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."marts"."dim_market__dbt_backup" cascade
[0m09:32:18.905476 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."marts"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m09:32:18.907479 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:32:18.908478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.911476 [debug] [Thread-3 (]: On model.growth.dim_market: Close
[0m09:32:18.912479 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.025 seconds
[0m09:32:18.913588 [debug] [Thread-1 (]: On model.growth.dim_transactions: COMMIT
[0m09:32:18.913588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CB15D0>]}
[0m09:32:18.913588 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:18.913588 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.017 seconds
[0m09:32:18.913588 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:32:18.913588 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary" rename to "mart_transaction_summary__dbt_backup"
[0m09:32:18.913588 [info ] [Thread-3 (]: 5 of 21 OK created sql view model marts.dim_market ............................. [[32mCREATE VIEW[0m in 0.26s]
[0m09:32:18.929217 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:18.929217 [debug] [Thread-1 (]: On model.growth.dim_transactions: COMMIT
[0m09:32:18.929217 [debug] [Thread-3 (]: Finished running node model.growth.dim_market
[0m09:32:18.929217 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.929217 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions" rename to "mart_daily_transactions__dbt_backup"
[0m09:32:18.929217 [debug] [Thread-3 (]: Began running node model.growth.dim_users
[0m09:32:18.929217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:18.929217 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:18.929217 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.929217 [info ] [Thread-3 (]: 9 of 21 START sql view model marts.dim_users ................................... [RUN]
[0m09:32:18.950826 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_transactions__dbt_backup"
[0m09:32:18.950826 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
alter table "nca"."marts"."mart_transaction_summary__dbt_tmp" rename to "mart_transaction_summary"
[0m09:32:18.950826 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:18.950826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.dim_users)
[0m09:32:18.950826 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:32:18.950826 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
alter table "nca"."marts"."mart_daily_transactions__dbt_tmp" rename to "mart_daily_transactions"
[0m09:32:18.950826 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:18.950826 [debug] [Thread-3 (]: Began compiling node model.growth.dim_users
[0m09:32:18.950826 [debug] [Thread-1 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."marts"."dim_transactions__dbt_backup" cascade
[0m09:32:18.971914 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:32:18.972914 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:32:18.972914 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:32:18.972914 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:18.972914 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:32:18.983140 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:32:18.983140 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: COMMIT
[0m09:32:18.983140 [debug] [Thread-1 (]: On model.growth.dim_transactions: Close
[0m09:32:18.983140 [debug] [Thread-3 (]: Began executing node model.growth.dim_users
[0m09:32:18.983140 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:18.983140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260627F2230>]}
[0m09:32:18.983140 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:32:19.000352 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:32:19.001349 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: COMMIT
[0m09:32:19.005347 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."mart_transaction_summary__dbt_backup"
[0m09:32:19.002357 [info ] [Thread-1 (]: 6 of 21 OK created sql view model marts.dim_transactions ....................... [[32mCREATE VIEW[0m in 0.33s]
[0m09:32:19.009348 [debug] [Thread-2 (]: Using postgres connection "model.growth.mart_transaction_summary"
[0m09:32:19.010348 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:32:19.011350 [debug] [Thread-1 (]: Finished running node model.growth.dim_transactions
[0m09:32:19.012352 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:19.012352 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_transaction_summary"} */
drop table if exists "nca"."marts"."mart_transaction_summary__dbt_backup" cascade
[0m09:32:19.018936 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."mart_daily_transactions__dbt_backup"
[0m09:32:19.019936 [debug] [Thread-1 (]: Began running node model.growth.dim_referrals
[0m09:32:19.019936 [debug] [Thread-3 (]: On model.growth.dim_users: BEGIN
[0m09:32:19.021939 [debug] [Thread-4 (]: Using postgres connection "model.growth.mart_daily_transactions"
[0m09:32:19.023939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:19.022938 [info ] [Thread-1 (]: 10 of 21 START sql view model marts.dim_referrals .............................. [RUN]
[0m09:32:19.024938 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:32:19.025938 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.mart_daily_transactions"} */
drop table if exists "nca"."marts"."mart_daily_transactions__dbt_backup" cascade
[0m09:32:19.026939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.dim_referrals)
[0m09:32:19.030390 [debug] [Thread-2 (]: On model.growth.mart_transaction_summary: Close
[0m09:32:19.032393 [debug] [Thread-1 (]: Began compiling node model.growth.dim_referrals
[0m09:32:19.039964 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m09:32:19.039964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062DA8A60>]}
[0m09:32:19.039964 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:32:19.049045 [debug] [Thread-1 (]: Began executing node model.growth.dim_referrals
[0m09:32:19.051043 [info ] [Thread-2 (]: 8 of 21 OK created sql table model marts.mart_transaction_summary .............. [[32mSELECT 8[0m in 0.36s]
[0m09:32:19.053199 [debug] [Thread-4 (]: On model.growth.mart_daily_transactions: Close
[0m09:32:19.066974 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m09:32:19.070963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CEC340>]}
[0m09:32:19.071968 [debug] [Thread-2 (]: Began running node model.growth.fct_users_acquisition
[0m09:32:19.080363 [info ] [Thread-2 (]: 11 of 21 START sql table model marts.fct_users_acquisition ..................... [RUN]
[0m09:32:19.074963 [info ] [Thread-4 (]: 7 of 21 OK created sql table model marts.mart_daily_transactions ............... [[32mSELECT 1000[0m in 0.40s]
[0m09:32:19.074963 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m09:32:19.083363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.mart_transaction_summary, now model.growth.fct_users_acquisition)
[0m09:32:19.084800 [debug] [Thread-4 (]: Finished running node model.growth.mart_daily_transactions
[0m09:32:19.084800 [debug] [Thread-2 (]: Began compiling node model.growth.fct_users_acquisition
[0m09:32:19.084800 [debug] [Thread-4 (]: Began running node model.growth.int_enriched_transactions
[0m09:32:19.084800 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:32:19.100038 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m09:32:19.102782 [info ] [Thread-4 (]: 12 of 21 START sql view model marts.int_enriched_transactions .................. [RUN]
[0m09:32:19.103769 [debug] [Thread-1 (]: On model.growth.dim_referrals: BEGIN
[0m09:32:19.105767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.mart_daily_transactions, now model.growth.int_enriched_transactions)
[0m09:32:19.106770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:19.106770 [debug] [Thread-2 (]: Began executing node model.growth.fct_users_acquisition
[0m09:32:19.106770 [debug] [Thread-4 (]: Began compiling node model.growth.int_enriched_transactions
[0m09:32:19.125257 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m09:32:19.134920 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m09:32:19.134920 [debug] [Thread-3 (]: SQL status: BEGIN in 0.117 seconds
[0m09:32:19.142781 [debug] [Thread-4 (]: Began executing node model.growth.int_enriched_transactions
[0m09:32:19.143913 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:19.144950 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.157346 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m09:32:19.158856 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:32:19.159892 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: BEGIN
[0m09:32:19.161716 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:32:19.166128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:19.167718 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: BEGIN
[0m09:32:19.168226 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:32:19.170559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:19.178668 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:19.182187 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:32:19.184189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:19.189193 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:32:19.191189 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:19.192190 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:32:19.193190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:19.282040 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:32:19.283086 [debug] [Thread-2 (]: SQL status: BEGIN in 0.117 seconds
[0m09:32:19.283928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.177 seconds
[0m09:32:19.284455 [debug] [Thread-4 (]: SQL status: BEGIN in 0.114 seconds
[0m09:32:19.286017 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:19.286541 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.287597 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:32:19.288123 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:32:19.288645 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:32:19.288645 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."marts"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."marts"."stg_users" u
    LEFT JOIN "nca"."marts"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."marts"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m09:32:19.292271 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."marts"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."marts"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m09:32:19.293371 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."marts"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."marts"."dim_transactions" t
    LEFT JOIN "nca"."marts"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m09:32:19.294933 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:32:19.297116 [debug] [Thread-3 (]: On model.growth.dim_users: Close
[0m09:32:19.297116 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062F5BFD0>]}
[0m09:32:19.297116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:32:19.304798 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:32:19.312198 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:32:19.306163 [info ] [Thread-3 (]: 9 of 21 OK created sql view model marts.dim_users .............................. [[32mCREATE VIEW[0m in 0.35s]
[0m09:32:19.324164 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.029 seconds
[0m09:32:19.323212 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:32:19.325425 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."marts"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m09:32:19.327565 [debug] [Thread-3 (]: Finished running node model.growth.dim_users
[0m09:32:19.339180 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.340244 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."marts"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m09:32:19.342992 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition" rename to "fct_users_acquisition__dbt_backup"
[0m09:32:19.344049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:19.347529 [debug] [Thread-1 (]: On model.growth.dim_referrals: COMMIT
[0m09:32:19.349570 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:32:19.351574 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:32:19.352480 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:32:19.360130 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.361534 [debug] [Thread-1 (]: On model.growth.dim_referrals: COMMIT
[0m09:32:19.366399 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:32:19.367926 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m09:32:19.369705 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:32:19.370762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:32:19.372373 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:32:19.373616 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:19.380982 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_referrals__dbt_backup"
[0m09:32:19.384962 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:32:19.385475 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:32:19.386495 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:32:19.388745 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.390118 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."int_enriched_transactions__dbt_backup"
[0m09:32:19.390118 [debug] [Thread-1 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."marts"."dim_referrals__dbt_backup" cascade
[0m09:32:19.390118 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:32:19.397502 [debug] [Thread-4 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:32:19.399676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:32:19.399676 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:19.399676 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."marts"."int_enriched_transactions__dbt_backup" cascade
[0m09:32:19.399676 [debug] [Thread-1 (]: On model.growth.dim_referrals: Close
[0m09:32:19.399676 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_users_acquisition__dbt_backup"
[0m09:32:19.413187 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:32:19.413187 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:32:19.413187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062F24850>]}
[0m09:32:19.413187 [debug] [Thread-4 (]: On model.growth.int_enriched_transactions: Close
[0m09:32:19.413187 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."marts"."fct_users_acquisition__dbt_backup" cascade
[0m09:32:19.413187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062D886A0>]}
[0m09:32:19.413187 [info ] [Thread-1 (]: 10 of 21 OK created sql view model marts.dim_referrals ......................... [[32mCREATE VIEW[0m in 0.39s]
[0m09:32:19.413187 [debug] [Thread-1 (]: Finished running node model.growth.dim_referrals
[0m09:32:19.430937 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:32:19.434765 [debug] [Thread-2 (]: On model.growth.fct_users_acquisition: Close
[0m09:32:19.436057 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_users
[0m09:32:19.413187 [info ] [Thread-4 (]: 12 of 21 OK created sql view model marts.int_enriched_transactions ............. [[32mCREATE VIEW[0m in 0.31s]
[0m09:32:19.436057 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062DA8A60>]}
[0m09:32:19.436057 [debug] [Thread-4 (]: Finished running node model.growth.int_enriched_transactions
[0m09:32:19.436057 [info ] [Thread-3 (]: 13 of 21 START sql view model marts.int_enriched_users ......................... [RUN]
[0m09:32:19.436057 [info ] [Thread-2 (]: 11 of 21 OK created sql table model marts.fct_users_acquisition ................ [[32mSELECT 97[0m in 0.35s]
[0m09:32:19.445928 [debug] [Thread-1 (]: Began running node model.growth.fct_referrals_performance
[0m09:32:19.449946 [debug] [Thread-4 (]: Began running node model.growth.fct_token_metrics
[0m09:32:19.452438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.int_enriched_users)
[0m09:32:19.455013 [debug] [Thread-2 (]: Finished running node model.growth.fct_users_acquisition
[0m09:32:19.457016 [info ] [Thread-1 (]: 14 of 21 START sql table model marts.fct_referrals_performance ................. [RUN]
[0m09:32:19.460014 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_users
[0m09:32:19.459012 [info ] [Thread-4 (]: 15 of 21 START sql table model marts.fct_token_metrics ......................... [RUN]
[0m09:32:19.462163 [debug] [Thread-2 (]: Began running node model.growth.fct_transaction_metrics
[0m09:32:19.462163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.fct_referrals_performance)
[0m09:32:19.467788 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m09:32:19.467788 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_token_metrics)
[0m09:32:19.467788 [debug] [Thread-1 (]: Began compiling node model.growth.fct_referrals_performance
[0m09:32:19.467788 [info ] [Thread-2 (]: 16 of 21 START sql table model marts.fct_transaction_metrics ................... [RUN]
[0m09:32:19.479623 [debug] [Thread-4 (]: Began compiling node model.growth.fct_token_metrics
[0m09:32:19.485626 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_users
[0m09:32:19.485626 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_referrals_performance"
[0m09:32:19.485626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_transaction_metrics)
[0m09:32:19.485626 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m09:32:19.509518 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m09:32:19.509518 [debug] [Thread-2 (]: Began compiling node model.growth.fct_transaction_metrics
[0m09:32:19.518728 [debug] [Thread-1 (]: Began executing node model.growth.fct_referrals_performance
[0m09:32:19.518728 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_transaction_metrics"
[0m09:32:19.518728 [debug] [Thread-4 (]: Began executing node model.growth.fct_token_metrics
[0m09:32:19.533339 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_referrals_performance"
[0m09:32:19.518728 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:32:19.533339 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m09:32:19.533339 [debug] [Thread-2 (]: Began executing node model.growth.fct_transaction_metrics
[0m09:32:19.549818 [debug] [Thread-3 (]: On model.growth.int_enriched_users: BEGIN
[0m09:32:19.550807 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.556804 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_transaction_metrics"
[0m09:32:19.557805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:19.558807 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.558807 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: BEGIN
[0m09:32:19.560807 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: BEGIN
[0m09:32:19.561808 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:32:19.562807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:19.565955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:19.567957 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: BEGIN
[0m09:32:19.569959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:19.643497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.085 seconds
[0m09:32:19.643497 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:32:19.643497 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."marts"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."marts"."dim_users" u
    LEFT JOIN "nca"."marts"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m09:32:19.643497 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:32:19.659126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m09:32:19.659126 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:32:19.659126 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.659126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m09:32:19.659126 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."marts"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m09:32:19.659126 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */

  
    

  create  table "nca"."marts"."fct_referrals_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH referrer_stats AS (
    SELECT 
        r.referrer_user_id,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT CASE WHEN t.transaction_id IS NOT NULL THEN r.referred_user_id END) as activated_referrals,
        SUM(t.amount) as referred_user_volume,
        AVG(t.amount) as avg_referred_transaction_size
    FROM "nca"."marts"."dim_referrals" r
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1
)
SELECT 
    *,
    ROUND(100.0 * activated_referrals / NULLIF(total_referrals, 0), 2) as referral_activation_rate,
    ROUND(referred_user_volume / NULLIF(activated_referrals, 0), 2) as volume_per_activated_referral
FROM referrer_stats
  );
  
[0m09:32:19.659126 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.659126 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."marts"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m09:32:19.659126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:32:19.659126 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:19.659126 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:32:19.674749 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m09:32:19.674749 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */

  
    

  create  table "nca"."marts"."fct_transaction_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH first_transactions AS (
    SELECT 
        user_id,
        MIN(timestamp) as first_transaction_date
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
),

daily_transactions AS (
    SELECT
        DATE_TRUNC('day', t.timestamp) as date,
        t.token,
        t.transaction_type,
        COUNT(DISTINCT t.transaction_id) as transaction_count,
        COUNT(DISTINCT t.user_id) as unique_users,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size,
        SUM(CASE WHEN t.transaction_date = ft.first_transaction_date THEN 1 ELSE 0 END) as new_user_transactions
    FROM "nca"."marts"."int_enriched_transactions" t
    LEFT JOIN first_transactions ft ON t.user_id = ft.user_id
    GROUP BY 1, 2, 3

)
SELECT 
    *,
    SUM(transaction_count) OVER (PARTITION BY token ORDER BY date) as cumulative_transactions,
    SUM(total_volume) OVER (PARTITION BY token ORDER BY date) as cumulative_volume,
    LAG(transaction_count) OVER (PARTITION BY token ORDER BY date) as prev_day_transactions,
    ROUND(100.0 * (transaction_count - LAG(transaction_count) OVER (PARTITION BY token ORDER BY date)) 
        / NULLIF(LAG(transaction_count) OVER (PARTITION BY token ORDER BY date), 0), 2) as daily_growth_rate
FROM daily_transactions
  );
  
[0m09:32:19.674749 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:32:19.674749 [debug] [Thread-3 (]: On model.growth.int_enriched_users: COMMIT
[0m09:32:19.674749 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:19.690385 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."int_enriched_users__dbt_backup"
[0m09:32:19.690385 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:32:19.690385 [debug] [Thread-3 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."marts"."int_enriched_users__dbt_backup" cascade
[0m09:32:19.690385 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:32:19.690385 [debug] [Thread-3 (]: On model.growth.int_enriched_users: Close
[0m09:32:19.690385 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CEFD30>]}
[0m09:32:19.705997 [info ] [Thread-3 (]: 13 of 21 OK created sql view model marts.int_enriched_users .................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:32:19.705997 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_users
[0m09:32:19.705997 [debug] [Thread-3 (]: Began running node model.growth.fct_referral_metrics
[0m09:32:19.705997 [info ] [Thread-3 (]: 17 of 21 START sql table model marts.fct_referral_metrics ...................... [RUN]
[0m09:32:19.705997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_users, now model.growth.fct_referral_metrics)
[0m09:32:19.705997 [debug] [Thread-3 (]: Began compiling node model.growth.fct_referral_metrics
[0m09:32:19.735093 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_referral_metrics"
[0m09:32:19.736182 [debug] [Thread-1 (]: SQL status: SELECT 77 in 0.066 seconds
[0m09:32:19.747680 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.749423 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance" rename to "fct_referrals_performance__dbt_backup"
[0m09:32:19.749423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:19.749423 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.749423 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.088 seconds
[0m09:32:19.749423 [debug] [Thread-3 (]: Began executing node model.growth.fct_referral_metrics
[0m09:32:19.749423 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance__dbt_tmp" rename to "fct_referrals_performance"
[0m09:32:19.766738 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.783248 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_referral_metrics"
[0m09:32:19.783248 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m09:32:19.783248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:19.783248 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:32:19.783248 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:32:19.783248 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:19.783248 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.806019 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.807019 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: BEGIN
[0m09:32:19.809021 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:32:19.810021 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m09:32:19.811023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:19.813021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:19.821823 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_referrals_performance__dbt_backup"
[0m09:32:19.822824 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:32:19.824841 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:32:19.828822 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:32:19.829828 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
drop table if exists "nca"."marts"."fct_referrals_performance__dbt_backup" cascade
[0m09:32:19.831824 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.831824 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:32:19.831824 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:19.831824 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_token_metrics__dbt_backup"
[0m09:32:19.831824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:32:19.831824 [debug] [Thread-2 (]: SQL status: SELECT 713 in 0.166 seconds
[0m09:32:19.847490 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:32:19.847490 [debug] [Thread-1 (]: On model.growth.fct_referrals_performance: Close
[0m09:32:19.847490 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:32:19.847490 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."marts"."fct_token_metrics__dbt_backup" cascade
[0m09:32:19.847490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E2CF3D0>]}
[0m09:32:19.847490 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */
alter table "nca"."marts"."fct_transaction_metrics__dbt_tmp" rename to "fct_transaction_metrics"
[0m09:32:19.863115 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:19.863115 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: COMMIT
[0m09:32:19.863115 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:32:19.863115 [info ] [Thread-1 (]: 14 of 21 OK created sql table model marts.fct_referrals_performance ............ [[32mSELECT 77[0m in 0.39s]
[0m09:32:19.863115 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:32:19.863115 [debug] [Thread-4 (]: On model.growth.fct_token_metrics: Close
[0m09:32:19.863115 [debug] [Thread-1 (]: Finished running node model.growth.fct_referrals_performance
[0m09:32:19.863115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.067 seconds
[0m09:32:19.878738 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: COMMIT
[0m09:32:19.881935 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062E0D840>]}
[0m09:32:19.883934 [debug] [Thread-1 (]: Began running node model.growth.fct_user_acquisition
[0m09:32:19.885567 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:19.885567 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:32:19.885567 [info ] [Thread-4 (]: 15 of 21 OK created sql table model marts.fct_token_metrics .................... [[32mSELECT 4[0m in 0.41s]
[0m09:32:19.885567 [info ] [Thread-1 (]: 18 of 21 START sql table model marts.fct_user_acquisition ...................... [RUN]
[0m09:32:19.885567 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */

  
    

  create  table "nca"."marts"."fct_referral_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH referral_metrics AS (
    SELECT
        r.referrer_user_id,
        u.signup_date as referrer_signup_date,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT t.transaction_id) as referred_user_transactions,
        SUM(t.usd_value) as referred_user_volume_usd,
        AVG(t.usd_value) as avg_referred_transaction_value
    FROM "nca"."marts"."dim_referrals" r
    JOIN "nca"."marts"."int_enriched_users" u
        ON r.referrer_user_id = u.user_id
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1, 2
)
SELECT * FROM referral_metrics
  );
  
[0m09:32:19.885567 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_transaction_metrics__dbt_backup"
[0m09:32:19.898838 [debug] [Thread-4 (]: Finished running node model.growth.fct_token_metrics
[0m09:32:19.900143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_referrals_performance, now model.growth.fct_user_acquisition)
[0m09:32:19.903139 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:32:19.904137 [debug] [Thread-4 (]: Began running node model.growth.fct_user_engagement
[0m09:32:19.905136 [debug] [Thread-1 (]: Began compiling node model.growth.fct_user_acquisition
[0m09:32:19.906136 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */
drop table if exists "nca"."marts"."fct_transaction_metrics__dbt_backup" cascade
[0m09:32:19.907136 [info ] [Thread-4 (]: 19 of 21 START sql table model marts.fct_user_engagement ....................... [RUN]
[0m09:32:19.918813 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_user_acquisition"
[0m09:32:19.919814 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:32:19.919814 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_token_metrics, now model.growth.fct_user_engagement)
[0m09:32:19.919814 [debug] [Thread-2 (]: On model.growth.fct_transaction_metrics: Close
[0m09:32:19.919814 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_engagement
[0m09:32:19.919814 [debug] [Thread-1 (]: Began executing node model.growth.fct_user_acquisition
[0m09:32:19.919814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062F421D0>]}
[0m09:32:19.941301 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_user_acquisition"
[0m09:32:19.952088 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_engagement"
[0m09:32:19.948998 [info ] [Thread-2 (]: 16 of 21 OK created sql table model marts.fct_transaction_metrics .............. [[32mSELECT 713[0m in 0.43s]
[0m09:32:19.952088 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:19.952088 [debug] [Thread-2 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:32:19.952088 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_engagement
[0m09:32:19.952088 [debug] [Thread-3 (]: SQL status: SELECT 77 in 0.058 seconds
[0m09:32:19.952088 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: BEGIN
[0m09:32:19.952088 [debug] [Thread-2 (]: Began running node model.growth.fct_user_metrics
[0m09:32:19.974249 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:19.974249 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_engagement"
[0m09:32:19.983306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:19.985305 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics" rename to "fct_referral_metrics__dbt_backup"
[0m09:32:19.985305 [info ] [Thread-2 (]: 20 of 21 START sql table model marts.fct_user_metrics .......................... [RUN]
[0m09:32:19.985305 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:32:19.985305 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:19.985305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.fct_transaction_metrics, now model.growth.fct_user_metrics)
[0m09:32:19.985305 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: BEGIN
[0m09:32:20.003609 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:20.005586 [debug] [Thread-2 (]: Began compiling node model.growth.fct_user_metrics
[0m09:32:20.006585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:20.007589 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
alter table "nca"."marts"."fct_referral_metrics__dbt_tmp" rename to "fct_referral_metrics"
[0m09:32:20.018777 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m09:32:20.018777 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:20.018777 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:32:20.018777 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:20.018777 [debug] [Thread-2 (]: Began executing node model.growth.fct_user_metrics
[0m09:32:20.018777 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: COMMIT
[0m09:32:20.034856 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:20.057019 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."fct_referral_metrics__dbt_backup"
[0m09:32:20.034856 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m09:32:20.058024 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_referral_metrics"
[0m09:32:20.060021 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referral_metrics"} */
drop table if exists "nca"."marts"."fct_referral_metrics__dbt_backup" cascade
[0m09:32:20.062024 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.064023 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: BEGIN
[0m09:32:20.067412 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:32:20.068411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m09:32:20.069411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:20.073433 [debug] [Thread-3 (]: On model.growth.fct_referral_metrics: Close
[0m09:32:20.074412 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:20.077411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CB2590>]}
[0m09:32:20.078424 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */

  
    

  create  table "nca"."marts"."fct_user_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_acquisition AS (
    SELECT 
        DATE_TRUNC('day', signup_date) as acquisition_date,
        country,
        COUNT(DISTINCT user_id) as new_users,
        COUNT(DISTINCT CASE WHEN is_referred_user THEN user_id END) as referred_users,
        COUNT(DISTINCT CASE WHEN NOT is_referred_user THEN user_id END) as organic_users
    FROM "nca"."marts"."int_enriched_users"
    GROUP BY 1, 2
)
SELECT 
    *,
    SUM(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as cumulative_users,
    ROUND(100.0 * referred_users / NULLIF(new_users, 0), 2) as referral_rate,
    LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date) as prev_day_users,
    ROUND(100.0 * (new_users - LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date)) 
        / NULLIF(LAG(new_users) OVER (PARTITION BY country ORDER BY acquisition_date), 0), 2) as daily_growth_rate
FROM user_acquisition
  );
  
[0m09:32:20.081480 [info ] [Thread-3 (]: 17 of 21 OK created sql table model marts.fct_referral_metrics ................. [[32mSELECT 77[0m in 0.37s]
[0m09:32:20.081480 [debug] [Thread-3 (]: Finished running node model.growth.fct_referral_metrics
[0m09:32:20.081480 [debug] [Thread-3 (]: Began running node model.growth.fct_user_retention
[0m09:32:20.081480 [info ] [Thread-3 (]: 21 of 21 START sql table model marts.fct_user_retention ........................ [RUN]
[0m09:32:20.081480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.fct_referral_metrics, now model.growth.fct_user_retention)
[0m09:32:20.090683 [debug] [Thread-3 (]: Began compiling node model.growth.fct_user_retention
[0m09:32:20.105180 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_user_retention"
[0m09:32:20.106181 [debug] [Thread-1 (]: SQL status: SELECT 172 in 0.023 seconds
[0m09:32:20.115788 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:20.117789 [debug] [Thread-4 (]: SQL status: BEGIN in 0.111 seconds
[0m09:32:20.119600 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
alter table "nca"."marts"."fct_user_acquisition" rename to "fct_user_acquisition__dbt_backup"
[0m09:32:20.119600 [debug] [Thread-3 (]: Began executing node model.growth.fct_user_retention
[0m09:32:20.119600 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:32:20.134457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:32:20.135220 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */

  
    

  create  table "nca"."marts"."fct_user_engagement__dbt_tmp"
  
  
    as
  
  (
    

WITH user_activity AS (
    SELECT
        u.user_id,
        u.signup_date,
        MIN(t.timestamp) as first_activity_date,
        MAX(t.timestamp) as last_activity_date,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        COUNT(DISTINCT t.token) as unique_tokens_used,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2
)
SELECT 
    *,
    EXTRACT(DAY FROM (first_activity_date - signup_date)) as days_to_activate,
    EXTRACT(DAY FROM (last_activity_date - signup_date)) as days_since_signup,
    EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) as days_since_last_activity,
    CASE 
        WHEN total_transactions = 0 THEN 'never_active'
        WHEN EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) <= 7 THEN 'active_7d'
        WHEN EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) <= 30 THEN 'active_30d'
        ELSE 'inactive'
    END as activity_status
FROM user_activity
  );
  
[0m09:32:20.135220 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_user_retention"
[0m09:32:20.153428 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:20.155427 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
alter table "nca"."marts"."fct_user_acquisition__dbt_tmp" rename to "fct_user_acquisition"
[0m09:32:20.157428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:20.161427 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:32:20.162427 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:20.164426 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: COMMIT
[0m09:32:20.169187 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:32:20.171191 [debug] [Thread-3 (]: On model.growth.fct_user_retention: BEGIN
[0m09:32:20.172192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:20.176191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m09:32:20.182933 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_user_acquisition__dbt_backup"
[0m09:32:20.182933 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_acquisition"
[0m09:32:20.182933 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_acquisition"} */
drop table if exists "nca"."marts"."fct_user_acquisition__dbt_backup" cascade
[0m09:32:20.182933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:32:20.182933 [debug] [Thread-1 (]: On model.growth.fct_user_acquisition: Close
[0m09:32:20.182933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062F5BB80>]}
[0m09:32:20.198559 [info ] [Thread-1 (]: 18 of 21 OK created sql table model marts.fct_user_acquisition ................. [[32mSELECT 172[0m in 0.28s]
[0m09:32:20.198559 [debug] [Thread-2 (]: SQL status: BEGIN in 0.133 seconds
[0m09:32:20.198559 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_acquisition
[0m09:32:20.198559 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.198559 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."marts"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m09:32:20.235630 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.084 seconds
[0m09:32:20.235630 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:32:20.248272 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */
alter table "nca"."marts"."fct_user_engagement__dbt_tmp" rename to "fct_user_engagement"
[0m09:32:20.252346 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:32:20.255352 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: COMMIT
[0m09:32:20.256359 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:32:20.257344 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: COMMIT
[0m09:32:20.260346 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:20.268581 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_user_engagement__dbt_backup"
[0m09:32:20.270582 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:32:20.270582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m09:32:20.272581 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */
drop table if exists "nca"."marts"."fct_user_engagement__dbt_backup" cascade
[0m09:32:20.273590 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:32:20.275585 [debug] [Thread-3 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */

  
    

  create  table "nca"."marts"."fct_user_retention__dbt_tmp"
  
  
    as
  
  (
    

WITH user_cohorts AS (
    SELECT
        u.user_id,  -- Specify the table alias
        DATE_TRUNC('month', u.signup_date) as cohort_month,
        DATE_TRUNC('month', t.timestamp) as activity_month,
        COUNT(DISTINCT t.transaction_id) as transactions,
        SUM(t.amount) as volume
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3
),

cohort_sizes AS (
    SELECT
        cohort_month,
        COUNT(DISTINCT user_id) as cohort_size
    FROM user_cohorts
    GROUP BY 1
),

retention_data AS (
    SELECT
        c.cohort_month,
        c.activity_month,
        COUNT(DISTINCT c.user_id) as active_users,
        cs.cohort_size,
        EXTRACT(MONTH FROM (c.activity_month - c.cohort_month)) as months_since_signup
    FROM user_cohorts c
    JOIN cohort_sizes cs ON c.cohort_month = cs.cohort_month
    GROUP BY 1, 2, 4, 5
)
SELECT 
    *,
    ROUND(100.0 * active_users / cohort_size, 2) as retention_rate
FROM retention_data
  );
  
[0m09:32:20.276582 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:32:20.279585 [debug] [Thread-4 (]: On model.growth.fct_user_engagement: Close
[0m09:32:20.282586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CC70A0>]}
[0m09:32:20.283212 [info ] [Thread-4 (]: 19 of 21 OK created sql table model marts.fct_user_engagement .................. [[32mSELECT 200[0m in 0.36s]
[0m09:32:20.283212 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_engagement
[0m09:32:20.283212 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.084 seconds
[0m09:32:20.302631 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.304024 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m09:32:20.306475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:20.314949 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.315958 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m09:32:20.319262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:20.319262 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:32:20.319262 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.319262 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:32:20.319262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:20.336904 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_user_metrics__dbt_backup"
[0m09:32:20.338908 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:32:20.339905 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."marts"."fct_user_metrics__dbt_backup" cascade
[0m09:32:20.343907 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:32:20.345910 [debug] [Thread-2 (]: On model.growth.fct_user_metrics: Close
[0m09:32:20.347909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062F421D0>]}
[0m09:32:20.351722 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.074 seconds
[0m09:32:20.350722 [info ] [Thread-2 (]: 20 of 21 OK created sql table model marts.fct_user_metrics ..................... [[32mSELECT 200[0m in 0.36s]
[0m09:32:20.357720 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:32:20.358719 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_metrics
[0m09:32:20.359721 [debug] [Thread-3 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */
alter table "nca"."marts"."fct_user_retention__dbt_tmp" rename to "fct_user_retention"
[0m09:32:20.361721 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:20.365683 [debug] [Thread-3 (]: On model.growth.fct_user_retention: COMMIT
[0m09:32:20.367744 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:32:20.369067 [debug] [Thread-3 (]: On model.growth.fct_user_retention: COMMIT
[0m09:32:20.370209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:20.370209 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."fct_user_retention__dbt_backup"
[0m09:32:20.370209 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:32:20.370209 [debug] [Thread-3 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */
drop table if exists "nca"."marts"."fct_user_retention__dbt_backup" cascade
[0m09:32:20.370209 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:32:20.383698 [debug] [Thread-3 (]: On model.growth.fct_user_retention: Close
[0m09:32:20.384877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1957658c-0b9d-4f52-ab58-fc84552896cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026062CEFD30>]}
[0m09:32:20.384877 [info ] [Thread-3 (]: 21 of 21 OK created sql table model marts.fct_user_retention ................... [[32mSELECT 17[0m in 0.30s]
[0m09:32:20.384877 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_retention
[0m09:32:20.384877 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:20.384877 [debug] [MainThread]: On master: BEGIN
[0m09:32:20.384877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:20.456803 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m09:32:20.457802 [debug] [MainThread]: On master: COMMIT
[0m09:32:20.458809 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:20.459802 [debug] [MainThread]: On master: COMMIT
[0m09:32:20.460803 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:20.461804 [debug] [MainThread]: On master: Close
[0m09:32:20.462802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:20.463804 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:32:20.465861 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:32:20.465861 [debug] [MainThread]: Connection 'model.growth.fct_user_acquisition' was properly closed.
[0m09:32:20.465861 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m09:32:20.465861 [debug] [MainThread]: Connection 'model.growth.fct_user_retention' was properly closed.
[0m09:32:20.465861 [debug] [MainThread]: Connection 'model.growth.fct_user_engagement' was properly closed.
[0m09:32:20.465861 [info ] [MainThread]: 
[0m09:32:20.465861 [info ] [MainThread]: Finished running 11 table models, 10 view models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m09:32:20.484938 [debug] [MainThread]: Command end result
[0m09:32:20.557930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:32:20.561932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:32:20.566893 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:32:20.566893 [info ] [MainThread]: 
[0m09:32:20.566893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:32:20.566893 [info ] [MainThread]: 
[0m09:32:20.566893 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m09:32:20.582521 [debug] [MainThread]: Command `dbt run` succeeded at 09:32:20.582521 after 4.91 seconds
[0m09:32:20.584497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605EF4D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E3CA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260616AF6A0>]}
[0m09:32:20.585499 [debug] [MainThread]: Flushing usage events
[0m09:32:22.919391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:30.495031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753249D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175343517B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175343515A0>]}


============================== 09:32:30.495031 | 73b0f6de-6e0c-423c-80b4-0130bb4ea968 ==============================
[0m09:32:30.495031 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:32:30.495031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:30.796765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017530C6F6D0>]}
[0m09:32:30.859224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017533E0B940>]}
[0m09:32:30.874905 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:31.296693 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:32:31.635447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:32:31.635447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:32:31.643005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.intermediate
- models.growth_metrics.marts
- models.growth_metrics.staging
[0m09:32:31.727190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017534BF0130>]}
[0m09:32:31.899069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:32:31.899069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:32:31.961566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175317AF250>]}
[0m09:32:31.961566 [info ] [MainThread]: Found 21 models, 29 data tests, 4 sources, 548 macros
[0m09:32:31.961566 [info ] [MainThread]: 
[0m09:32:31.961566 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:32:31.979305 [info ] [MainThread]: 
[0m09:32:31.981346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:32:31.991641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:32:32.191450 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:32:32.191450 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:32:32.191450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:32.238317 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m09:32:32.238317 [debug] [ThreadPool]: On list_nca: Close
[0m09:32:32.238317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:32:32.253941 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:32:32.253941 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:32:32.253941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:32.300774 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:32:32.300774 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:32:32.300774 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:32:32.300774 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.005 seconds
[0m09:32:32.316402 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:32:32.316402 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:32:32.332032 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:32.332032 [debug] [MainThread]: On master: BEGIN
[0m09:32:32.332032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:32.378898 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m09:32:32.378898 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:32.378898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:32:32.378898 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m09:32:32.394526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175318087C0>]}
[0m09:32:32.394526 [debug] [MainThread]: On master: ROLLBACK
[0m09:32:32.394526 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:32.394526 [debug] [MainThread]: On master: BEGIN
[0m09:32:32.394526 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:32:32.394526 [debug] [MainThread]: On master: COMMIT
[0m09:32:32.394526 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:32.394526 [debug] [MainThread]: On master: COMMIT
[0m09:32:32.394526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:32.394526 [debug] [MainThread]: On master: Close
[0m09:32:32.410159 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:32:32.410159 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:32:32.410159 [debug] [Thread-3 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:32:32.410159 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:32:32.410159 [info ] [Thread-1 (]: 1 of 50 START test dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [RUN]
[0m09:32:32.410159 [info ] [Thread-2 (]: 2 of 50 START test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [RUN]
[0m09:32:32.410159 [info ] [Thread-3 (]: 3 of 50 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m09:32:32.410159 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80'
[0m09:32:32.410159 [info ] [Thread-4 (]: 4 of 50 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m09:32:32.410159 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700'
[0m09:32:32.410159 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m09:32:32.410159 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:32:32.410159 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m09:32:32.410159 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:32:32.425775 [debug] [Thread-3 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:32:32.446476 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:32:32.454258 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:32:32.464528 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:32:32.479788 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:32:32.479788 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:32:32.496090 [debug] [Thread-1 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:32:32.509086 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:32:32.527851 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:32:32.527851 [debug] [Thread-2 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:32:32.527851 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:32:32.527851 [debug] [Thread-3 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:32:32.542751 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:32:32.549793 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:32:32.551005 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:32:32.552042 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:32:32.553300 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m09:32:32.554885 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:32:32.556074 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:32:32.557140 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: BEGIN
[0m09:32:32.558200 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:32:32.558897 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: BEGIN
[0m09:32:32.559935 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m09:32:32.562331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:32.564039 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:32:32.564548 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:32:32.637958 [debug] [Thread-4 (]: SQL status: BEGIN in 0.083 seconds
[0m09:32:32.637958 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:32:32.637958 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m09:32:32.637958 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:32.658387 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m09:32:32.658898 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m09:32:32.658898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m09:32:32.658898 [info ] [Thread-4 (]: 4 of 50 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.25s]
[0m09:32:32.666143 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:32:32.666143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m09:32:32.669590 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:32:32.670266 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        referred_user_id
    from "nca"."staging"."referrals"
    group by referred_user_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m09:32:32.671523 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:32:32.673521 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:32:32.675524 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date, token
    from "nca"."staging"."market"
    group by date, token
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m09:32:32.679832 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:32:32.683637 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: ROLLBACK
[0m09:32:32.685181 [debug] [Thread-3 (]: SQL status: BEGIN in 0.120 seconds
[0m09:32:32.685181 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:32:32.676522 [info ] [Thread-4 (]: 5 of 50 START test source_not_null_staging_market_date ......................... [RUN]
[0m09:32:32.688779 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: Close
[0m09:32:32.689830 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:32:32.692899 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: ROLLBACK
[0m09:32:32.693572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m09:32:32.700566 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m09:32:32.697597 [error] [Thread-2 (]: 2 of 50 FAIL 15 dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [[31mFAIL 15[0m in 0.29s]
[0m09:32:32.702566 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: Close
[0m09:32:32.703566 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:32:32.705566 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:32:32.707313 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:32:32.707313 [error] [Thread-1 (]: 1 of 50 FAIL 156 dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [[31mFAIL 156[0m in 0.30s]
[0m09:32:32.719823 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:32:32.725083 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:32:32.725611 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:32:32.727218 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m09:32:32.731865 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:32:32.733687 [info ] [Thread-2 (]: 6 of 50 START test source_not_null_staging_market_price ........................ [RUN]
[0m09:32:32.737064 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:32:32.737575 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m09:32:32.737575 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:32:32.741030 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80' to be skipped because of status 'fail'.  Reason: Got 156 results, configured to fail if != 0.
[0m09:32:32.742076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m09:32:32.750583 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:32:32.752189 [info ] [Thread-3 (]: 3 of 50 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.34s]
[0m09:32:32.753202 [info ] [Thread-1 (]: 7 of 50 START test source_not_null_staging_market_token ........................ [RUN]
[0m09:32:32.754200 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:32:32.758877 [debug] [Thread-3 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:32:32.759937 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:32:32.760753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m09:32:32.772961 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:32:32.774020 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:32:32.775284 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m09:32:32.775791 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:32:32.780665 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:32:32.777362 [info ] [Thread-3 (]: 8 of 50 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m09:32:32.783090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:32.789511 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:32:32.801203 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:32:32.802782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m09:32:32.804647 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:32:32.814478 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:32:32.814909 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:32:32.831300 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:32:32.822176 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:32:32.831300 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m09:32:32.831300 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:32:32.831300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:32.831300 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:32:32.846109 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:32:32.850107 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m09:32:32.851105 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:32:32.853107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:32.854105 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m09:32:32.856106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:32.893978 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m09:32:32.893978 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:32:32.893978 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m09:32:32.893978 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:32.893978 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m09:32:32.909600 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m09:32:32.909600 [info ] [Thread-4 (]: 5 of 50 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.22s]
[0m09:32:32.925224 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:32:32.925224 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:32:32.925224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m09:32:32.925224 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:32:32.925224 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m09:32:32.940848 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:32.944929 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m09:32:32.946932 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m09:32:32.947872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m09:32:32.925224 [info ] [Thread-4 (]: 9 of 50 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m09:32:32.947872 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:32:32.947872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m09:32:32.947872 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m09:32:32.947872 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:32:32.963536 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:32:32.963536 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m09:32:32.947872 [error] [Thread-2 (]: 6 of 50 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.21s]
[0m09:32:32.977684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.125 seconds
[0m09:32:32.979315 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m09:32:32.983678 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:32:32.984681 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:32:32.986676 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:32:32.987677 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m09:32:32.988678 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:32:32.988678 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_market_price.7a0eea0e50' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m09:32:32.995081 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:32:32.995081 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m09:32:32.995081 [info ] [Thread-3 (]: 8 of 50 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.19s]
[0m09:32:32.995081 [info ] [Thread-2 (]: 10 of 50 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m09:32:32.995081 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:32:32.995081 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.011856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m09:32:33.015839 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:32:33.016836 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:32:33.020839 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m09:32:33.020839 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:32:33.020839 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m09:32:33.020839 [info ] [Thread-3 (]: 11 of 50 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m09:32:33.020839 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m09:32:33.029322 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:33.038550 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:32:33.038550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m09:32:33.038550 [info ] [Thread-1 (]: 7 of 50 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.28s]
[0m09:32:33.046546 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:32:33.046546 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:32:33.046546 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:32:33.068617 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:32:33.069615 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:32:33.079728 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:32:33.071616 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:32:33.079728 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:32:33.077729 [info ] [Thread-1 (]: 12 of 50 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m09:32:33.079728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m09:32:33.079728 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:32:33.095935 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:32:33.099468 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:32:33.105523 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:32:33.105523 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m09:32:33.105523 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m09:32:33.114020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:33.114020 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:32:33.114020 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:33.114020 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:32:33.128541 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m09:32:33.128541 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:32:33.128541 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m09:32:33.128541 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:32:33.128541 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:32:33.128541 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m09:32:33.144471 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m09:32:33.145193 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m09:32:33.145193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:33.145193 [info ] [Thread-4 (]: 9 of 50 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.20s]
[0m09:32:33.145193 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:32:33.145193 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:32:33.145193 [info ] [Thread-4 (]: 13 of 50 START test source_not_null_staging_transactions_token ................. [RUN]
[0m09:32:33.145193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m09:32:33.163706 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:32:33.180928 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:32:33.185012 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:32:33.187065 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:32:33.198152 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:32:33.198152 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m09:32:33.198152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:33.214522 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m09:32:33.214522 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:32:33.228881 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m09:32:33.231879 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.235882 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m09:32:33.237878 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m09:32:33.238876 [error] [Thread-2 (]: 10 of 50 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.23s]
[0m09:32:33.242879 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:32:33.244878 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:32:33.246009 [info ] [Thread-2 (]: 14 of 50 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m09:32:33.249061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m09:32:33.250058 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:32:33.252058 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964' to be skipped because of status 'fail'.  Reason: Got 5 results, configured to fail if != 0.
[0m09:32:33.261058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.114 seconds
[0m09:32:33.262116 [debug] [Thread-3 (]: SQL status: BEGIN in 0.145 seconds
[0m09:32:33.264601 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:32:33.268609 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:32:33.270660 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:32:33.270660 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m09:32:33.270660 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m09:32:33.270660 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:32:33.279990 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:32:33.277974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.281666 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:32:33.281666 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m09:32:33.281666 [debug] [Thread-4 (]: SQL status: BEGIN in 0.090 seconds
[0m09:32:33.294848 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m09:32:33.297221 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m09:32:33.299219 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:32:33.300220 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:32:33.301219 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m09:32:33.303220 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m09:32:33.302223 [error] [Thread-3 (]: 11 of 50 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.26s]
[0m09:32:33.309222 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:32:33.307223 [info ] [Thread-1 (]: 12 of 50 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.23s]
[0m09:32:33.305219 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m09:32:33.310222 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.313221 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:32:33.315438 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_transactions_amount.a378a55704' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:32:33.315438 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:32:33.315438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:33.315438 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m09:32:33.315438 [info ] [Thread-3 (]: 15 of 50 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m09:32:33.326372 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:32:33.329838 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m09:32:33.329838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m09:32:33.329838 [info ] [Thread-1 (]: 16 of 50 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m09:32:33.339597 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:32:33.338598 [info ] [Thread-4 (]: 13 of 50 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.18s]
[0m09:32:33.340597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m09:32:33.354804 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:32:33.356805 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:32:33.356805 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:32:33.361389 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:32:33.362083 [info ] [Thread-4 (]: 17 of 50 START test source_not_null_staging_users_country ...................... [RUN]
[0m09:32:33.362083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m09:32:33.377714 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:32:33.362083 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:32:33.396830 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:32:33.396830 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:32:33.396830 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:32:33.417406 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:32:33.419418 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:32:33.429610 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:32:33.446836 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:32:33.446836 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:32:33.446836 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:32:33.446836 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m09:32:33.446836 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:32:33.446836 [debug] [Thread-2 (]: SQL status: BEGIN in 0.139 seconds
[0m09:32:33.446836 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m09:32:33.462692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:33.464691 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m09:32:33.465693 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:32:33.470694 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m09:32:33.466691 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:33.468691 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:33.473693 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.476694 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m09:32:33.479837 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m09:32:33.481852 [info ] [Thread-2 (]: 14 of 50 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.23s]
[0m09:32:33.483840 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:32:33.485839 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:32:33.486840 [info ] [Thread-2 (]: 18 of 50 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m09:32:33.488842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m09:32:33.489585 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:32:33.502629 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:32:33.504629 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:32:33.514556 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:32:33.517557 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:32:33.518554 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m09:32:33.519554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:33.595598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m09:32:33.595598 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:32:33.595598 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m09:32:33.595598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.611271 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m09:32:33.611271 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m09:32:33.611271 [info ] [Thread-1 (]: 16 of 50 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.27s]
[0m09:32:33.611271 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:32:33.611271 [debug] [Thread-3 (]: SQL status: BEGIN in 0.153 seconds
[0m09:32:33.611271 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:32:33.611271 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:32:33.611271 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m09:32:33.611271 [info ] [Thread-1 (]: 19 of 50 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m09:32:33.611271 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m09:32:33.627119 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:32:33.630293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m09:32:33.632266 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m09:32:33.632266 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.632266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.116 seconds
[0m09:32:33.632266 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:32:33.632266 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m09:32:33.632266 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:32:33.632266 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:32:33.652313 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:32:33.653311 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m09:32:33.654316 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m09:32:33.654316 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m09:32:33.654316 [info ] [Thread-3 (]: 15 of 50 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.32s]
[0m09:32:33.654316 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m09:32:33.654316 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:32:33.666713 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:32:33.668717 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:32:33.671714 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:32:33.669715 [info ] [Thread-4 (]: 17 of 50 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.31s]
[0m09:32:33.671714 [debug] [Thread-3 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:32:33.681418 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m09:32:33.683422 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:32:33.686052 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:32:33.685031 [info ] [Thread-3 (]: 20 of 50 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m09:32:33.687034 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m09:32:33.688032 [debug] [Thread-4 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:32:33.689032 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m09:32:33.689032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m09:32:33.689032 [info ] [Thread-2 (]: 18 of 50 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.20s]
[0m09:32:33.692893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:33.689032 [info ] [Thread-4 (]: 21 of 50 START test source_positive_value_staging_market_price ................. [RUN]
[0m09:32:33.696904 [debug] [Thread-3 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:32:33.699486 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:32:33.702786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m09:32:33.716095 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:32:33.716095 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:32:33.716095 [debug] [Thread-4 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:32:33.716095 [info ] [Thread-2 (]: 22 of 50 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m09:32:33.733067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m09:32:33.737047 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:32:33.738046 [debug] [Thread-3 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:32:33.739049 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:32:33.749300 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:32:33.749300 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:32:33.749300 [debug] [Thread-4 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:32:33.765136 [debug] [Thread-2 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:32:33.765136 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:32:33.765136 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:32:33.765136 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:32:33.765136 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m09:32:33.765136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m09:32:33.765136 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:32:33.765136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:33.765136 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:32:33.780445 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:32:33.781442 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m09:32:33.782443 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:32:33.783443 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m09:32:33.785445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:33.786442 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:33.788444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:32:33.792444 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m09:32:33.794444 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m09:32:33.796596 [info ] [Thread-1 (]: 19 of 50 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.17s]
[0m09:32:33.799595 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:32:33.801593 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:32:33.802594 [info ] [Thread-1 (]: 23 of 50 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m09:32:33.805072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m09:32:33.806075 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:32:33.834721 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:32:33.837722 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:32:33.847235 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:32:33.849696 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:32:33.849696 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m09:32:33.849696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:33.890390 [debug] [Thread-2 (]: SQL status: BEGIN in 0.106 seconds
[0m09:32:33.892392 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:32:33.893391 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:32:33.894393 [debug] [Thread-4 (]: SQL status: BEGIN in 0.108 seconds
[0m09:32:33.896396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m09:32:33.897888 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:32:33.899891 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:32:33.900892 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:32:33.901889 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:32:33.902888 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:32:33.904891 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m09:32:33.906890 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m09:32:33.909890 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:32:33.910892 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:32:33.908901 [error] [Thread-2 (]: 22 of 50 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.18s]
[0m09:32:33.911948 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m09:32:33.911948 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m09:32:33.911948 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:32:33.911948 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m09:32:33.911948 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m09:32:33.911948 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:32:33.911948 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:32:33.928827 [info ] [Thread-3 (]: 20 of 50 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.24s]
[0m09:32:33.930829 [error] [Thread-4 (]: 21 of 50 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.23s]
[0m09:32:33.933863 [info ] [Thread-2 (]: 24 of 50 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m09:32:33.934821 [debug] [Thread-3 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:32:33.934821 [debug] [Thread-4 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:32:33.934821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m09:32:33.934821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m09:32:33.934821 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:32:33.947328 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:32:33.949769 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_price.1ee4a4b889' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m09:32:33.951012 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:32:33.952001 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:32:33.952999 [info ] [Thread-3 (]: 25 of 50 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m09:32:33.953999 [info ] [Thread-4 (]: 26 of 50 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m09:32:33.956693 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:32:33.971497 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:32:33.971497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m09:32:33.971497 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:32:33.971497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m09:32:33.982711 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m09:32:33.990989 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:32:33.990989 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:32:33.997303 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:32:33.999285 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m09:32:33.999285 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:32:33.999285 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:32:34.014791 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:32:34.014791 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m09:32:34.030942 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:32:34.031942 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:32:34.034941 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:32:34.033946 [info ] [Thread-1 (]: 23 of 50 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.23s]
[0m09:32:34.037943 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:32:34.038938 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m09:32:34.042943 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:32:34.044946 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:32:34.047944 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m09:32:34.049483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:32:34.050542 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:32:34.050542 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:34.050542 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:32:34.050542 [info ] [Thread-1 (]: 27 of 50 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m09:32:34.050542 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m09:32:34.050542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m09:32:34.064186 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:34.064186 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:32:34.083071 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:32:34.083071 [debug] [Thread-1 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:32:34.098552 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:32:34.098552 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:32:34.098552 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m09:32:34.098552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:34.146169 [debug] [Thread-3 (]: SQL status: BEGIN in 0.104 seconds
[0m09:32:34.146169 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:32:34.146169 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:32:34.161847 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:32:34.161847 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m09:32:34.161847 [debug] [Thread-4 (]: SQL status: BEGIN in 0.109 seconds
[0m09:32:34.161847 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m09:32:34.161847 [debug] [Thread-2 (]: SQL status: BEGIN in 0.124 seconds
[0m09:32:34.161847 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:32:34.177473 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:32:34.177473 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:32:34.177473 [info ] [Thread-3 (]: 25 of 50 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.19s]
[0m09:32:34.177473 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:32:34.177473 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:32:34.177473 [debug] [Thread-3 (]: Began running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:32:34.177473 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:32:34.177473 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:32:34.177473 [info ] [Thread-3 (]: 28 of 50 START test source_unique_staging_users_referral_code .................. [RUN]
[0m09:32:34.194190 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m09:32:34.197586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m09:32:34.200808 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m09:32:34.203145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be, now test.growth.source_unique_staging_users_referral_code.184becf50f)
[0m09:32:34.204234 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:32:34.205240 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m09:32:34.206236 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m09:32:34.206236 [debug] [Thread-3 (]: Began compiling node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:32:34.206236 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:32:34.214265 [info ] [Thread-4 (]: 26 of 50 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.23s]
[0m09:32:34.213265 [info ] [Thread-2 (]: 24 of 50 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.28s]
[0m09:32:34.218568 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:32:34.231782 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:32:34.235740 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:32:34.236754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:32:34.238740 [debug] [Thread-4 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:32:34.239739 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m09:32:34.240741 [debug] [Thread-3 (]: Began executing node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:32:34.245609 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m09:32:34.247626 [info ] [Thread-4 (]: 29 of 50 START test source_unique_staging_users_user_id ........................ [RUN]
[0m09:32:34.250231 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:32:34.249613 [info ] [Thread-2 (]: 30 of 50 SKIP relation marts.stg_referrals ..................................... [[33mSKIP[0m]
[0m09:32:34.250231 [debug] [Thread-1 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m09:32:34.250231 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m09:32:34.267585 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m09:32:34.268583 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:32:34.271583 [debug] [Thread-4 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:32:34.270583 [error] [Thread-1 (]: 27 of 50 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.22s]
[0m09:32:34.272650 [debug] [Thread-2 (]: Began running node model.growth.stg_market
[0m09:32:34.272650 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_referrals' to be skipped because of status 'skipped'. 
[0m09:32:34.272650 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: BEGIN
[0m09:32:34.288874 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:32:34.288874 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:32:34.288874 [info ] [Thread-2 (]: 31 of 50 SKIP relation marts.stg_market ........................................ [[33mSKIP[0m]
[0m09:32:34.297806 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:34.299481 [debug] [Thread-1 (]: Began running node model.growth.dim_referrals
[0m09:32:34.299481 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' to be skipped because of status 'fail'.  Reason: Got 10 results, configured to fail if != 0.
[0m09:32:34.299481 [debug] [Thread-2 (]: Finished running node model.growth.stg_market
[0m09:32:34.299481 [debug] [Thread-4 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:32:34.299481 [info ] [Thread-1 (]: 32 of 50 SKIP relation marts.dim_referrals ..................................... [[33mSKIP[0m]
[0m09:32:34.308871 [debug] [Thread-2 (]: Began running node model.growth.stg_transactions
[0m09:32:34.309871 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_market' to be skipped because of status 'skipped'. 
[0m09:32:34.316404 [info ] [Thread-2 (]: 33 of 50 SKIP relation marts.stg_transactions .................................. [[33mSKIP[0m]
[0m09:32:34.316404 [debug] [Thread-1 (]: Finished running node model.growth.dim_referrals
[0m09:32:34.316404 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:32:34.316404 [debug] [Thread-2 (]: Finished running node model.growth.stg_transactions
[0m09:32:34.331923 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m09:32:34.333856 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_referrals' to be skipped because of status 'skipped'. 
[0m09:32:34.333856 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_transactions' to be skipped because of status 'skipped'. 
[0m09:32:34.340871 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:32:34.333856 [info ] [Thread-1 (]: 34 of 50 SKIP relation marts.dim_market ........................................ [[33mSKIP[0m]
[0m09:32:34.342859 [debug] [Thread-2 (]: Began running node model.growth.dim_transactions
[0m09:32:34.343861 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m09:32:34.347675 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m09:32:34.350006 [info ] [Thread-2 (]: 35 of 50 SKIP relation marts.dim_transactions .................................. [[33mSKIP[0m]
[0m09:32:34.350006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:32:34.350006 [debug] [Thread-1 (]: Began running node model.growth.mart_daily_transactions
[0m09:32:34.350006 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_market' to be skipped because of status 'skipped'. 
[0m09:32:34.350006 [info ] [Thread-1 (]: 36 of 50 SKIP relation marts.mart_daily_transactions ........................... [[33mSKIP[0m]
[0m09:32:34.350006 [debug] [Thread-2 (]: Finished running node model.growth.dim_transactions
[0m09:32:34.361744 [debug] [Thread-1 (]: Finished running node model.growth.mart_daily_transactions
[0m09:32:34.366078 [debug] [Thread-2 (]: Began running node model.growth.mart_transaction_summary
[0m09:32:34.366078 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_transactions' to be skipped because of status 'skipped'. 
[0m09:32:34.366078 [info ] [Thread-2 (]: 37 of 50 SKIP relation marts.mart_transaction_summary .......................... [[33mSKIP[0m]
[0m09:32:34.372827 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_daily_transactions' to be skipped because of status 'skipped'. 
[0m09:32:34.374825 [debug] [Thread-2 (]: Finished running node model.growth.mart_transaction_summary
[0m09:32:34.376825 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_transactions
[0m09:32:34.382826 [debug] [Thread-7 (]: Marking all children of 'model.growth.mart_transaction_summary' to be skipped because of status 'skipped'. 
[0m09:32:34.383673 [info ] [Thread-1 (]: 38 of 50 SKIP relation marts.int_enriched_transactions ......................... [[33mSKIP[0m]
[0m09:32:34.383673 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_transactions
[0m09:32:34.383673 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_transactions' to be skipped because of status 'skipped'. 
[0m09:32:34.383673 [debug] [Thread-2 (]: Began running node model.growth.fct_referrals_performance
[0m09:32:34.383673 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m09:32:34.383673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m09:32:34.383673 [info ] [Thread-2 (]: 39 of 50 SKIP relation marts.fct_referrals_performance ......................... [[33mSKIP[0m]
[0m09:32:34.401930 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:32:34.399011 [info ] [Thread-1 (]: 40 of 50 SKIP relation marts.fct_token_metrics ................................. [[33mSKIP[0m]
[0m09:32:34.402921 [debug] [Thread-2 (]: Finished running node model.growth.fct_referrals_performance
[0m09:32:34.403920 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_referral_code.184becf50f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    referral_code as unique_field,
    count(*) as n_records

from (select * from "nca"."staging"."users" where referral_code is not null) dbt_subquery
where referral_code is not null
group by referral_code
having count(*) > 1



      
    ) dbt_internal_test
[0m09:32:34.404925 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m09:32:34.405920 [debug] [Thread-2 (]: Began running node model.growth.fct_transaction_metrics
[0m09:32:34.406920 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referrals_performance' to be skipped because of status 'skipped'. 
[0m09:32:34.406920 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_token_metrics' to be skipped because of status 'skipped'. 
[0m09:32:34.412760 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:32:34.406920 [info ] [Thread-2 (]: 41 of 50 SKIP relation marts.fct_transaction_metrics ........................... [[33mSKIP[0m]
[0m09:32:34.416850 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: ROLLBACK
[0m09:32:34.416850 [debug] [Thread-2 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:32:34.416850 [debug] [Thread-3 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: Close
[0m09:32:34.416850 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_transaction_metrics' to be skipped because of status 'skipped'. 
[0m09:32:34.416850 [info ] [Thread-3 (]: 28 of 50 PASS source_unique_staging_users_referral_code ........................ [[32mPASS[0m in 0.21s]
[0m09:32:34.416850 [debug] [Thread-3 (]: Finished running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:32:34.433542 [debug] [Thread-4 (]: SQL status: BEGIN in 0.087 seconds
[0m09:32:34.433542 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:32:34.433542 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:32:34.433542 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:32:34.433542 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m09:32:34.447837 [debug] [Thread-4 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m09:32:34.450130 [info ] [Thread-4 (]: 29 of 50 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.20s]
[0m09:32:34.452132 [debug] [Thread-4 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:32:34.454135 [debug] [Thread-1 (]: Began running node model.growth.stg_users
[0m09:32:34.455132 [info ] [Thread-1 (]: 42 of 50 START sql view model marts.stg_users .................................. [RUN]
[0m09:32:34.457740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1, now model.growth.stg_users)
[0m09:32:34.457740 [debug] [Thread-1 (]: Began compiling node model.growth.stg_users
[0m09:32:34.464740 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:32:34.465693 [debug] [Thread-1 (]: Began executing node model.growth.stg_users
[0m09:32:34.515874 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:32:34.515874 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.515874 [debug] [Thread-1 (]: On model.growth.stg_users: BEGIN
[0m09:32:34.515874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:34.563237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m09:32:34.563237 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.563237 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:32:34.563237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:32:34.625796 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.625796 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:32:34.625796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:34.641412 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.641412 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:32:34.641412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:34.657042 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m09:32:34.657042 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.657042 [debug] [Thread-1 (]: On model.growth.stg_users: COMMIT
[0m09:32:34.657042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:34.672666 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:32:34.672666 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_users"
[0m09:32:34.672666 [debug] [Thread-1 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:32:34.672666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:32:34.688287 [debug] [Thread-1 (]: On model.growth.stg_users: Close
[0m09:32:34.688287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753658FAC0>]}
[0m09:32:34.688287 [info ] [Thread-1 (]: 42 of 50 OK created sql view model marts.stg_users ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m09:32:34.688287 [debug] [Thread-1 (]: Finished running node model.growth.stg_users
[0m09:32:34.688287 [debug] [Thread-3 (]: Began running node model.growth.dim_users
[0m09:32:34.688287 [debug] [Thread-4 (]: Began running node model.growth.fct_users_acquisition
[0m09:32:34.688287 [info ] [Thread-3 (]: 43 of 50 START sql view model marts.dim_users .................................. [RUN]
[0m09:32:34.688287 [info ] [Thread-4 (]: 44 of 50 SKIP relation marts.fct_users_acquisition ............................. [[33mSKIP[0m]
[0m09:32:34.688287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_users_referral_code.184becf50f, now model.growth.dim_users)
[0m09:32:34.704528 [debug] [Thread-4 (]: Finished running node model.growth.fct_users_acquisition
[0m09:32:34.705960 [debug] [Thread-3 (]: Began compiling node model.growth.dim_users
[0m09:32:34.707796 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'skipped'. 
[0m09:32:34.715026 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:32:34.717544 [debug] [Thread-3 (]: Began executing node model.growth.dim_users
[0m09:32:34.722540 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:32:34.722540 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:34.722540 [debug] [Thread-3 (]: On model.growth.dim_users: BEGIN
[0m09:32:34.722540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:32:34.776086 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m09:32:34.777090 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:34.777090 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:32:34.781847 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:32:34.786848 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:34.787848 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:32:34.788848 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:32:34.790848 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:32:34.791849 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:34.791849 [debug] [Thread-3 (]: On model.growth.dim_users: COMMIT
[0m09:32:34.794126 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:32:34.798663 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:32:34.798663 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_users"
[0m09:32:34.798663 [debug] [Thread-3 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:32:34.798663 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:32:34.798663 [debug] [Thread-3 (]: On model.growth.dim_users: Close
[0m09:32:34.798663 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b0f6de-6e0c-423c-80b4-0130bb4ea968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175363988E0>]}
[0m09:32:34.798663 [info ] [Thread-3 (]: 43 of 50 OK created sql view model marts.dim_users ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m09:32:34.798663 [debug] [Thread-3 (]: Finished running node model.growth.dim_users
[0m09:32:34.798663 [debug] [Thread-1 (]: Began running node model.growth.int_enriched_users
[0m09:32:34.798663 [info ] [Thread-1 (]: 45 of 50 SKIP relation marts.int_enriched_users ................................ [[33mSKIP[0m]
[0m09:32:34.813897 [debug] [Thread-1 (]: Finished running node model.growth.int_enriched_users
[0m09:32:34.814957 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_users' to be skipped because of status 'skipped'. 
[0m09:32:34.818008 [debug] [Thread-4 (]: Began running node model.growth.fct_referral_metrics
[0m09:32:34.818008 [debug] [Thread-3 (]: Began running node model.growth.fct_user_acquisition
[0m09:32:34.820058 [debug] [Thread-2 (]: Began running node model.growth.fct_user_engagement
[0m09:32:34.820058 [debug] [Thread-1 (]: Began running node model.growth.fct_user_metrics
[0m09:32:34.821126 [info ] [Thread-4 (]: 46 of 50 SKIP relation marts.fct_referral_metrics .............................. [[33mSKIP[0m]
[0m09:32:34.821126 [info ] [Thread-3 (]: 47 of 50 SKIP relation marts.fct_user_acquisition .............................. [[33mSKIP[0m]
[0m09:32:34.822838 [info ] [Thread-2 (]: 48 of 50 SKIP relation marts.fct_user_engagement ............................... [[33mSKIP[0m]
[0m09:32:34.824837 [debug] [Thread-4 (]: Finished running node model.growth.fct_referral_metrics
[0m09:32:34.823838 [info ] [Thread-1 (]: 49 of 50 SKIP relation marts.fct_user_metrics .................................. [[33mSKIP[0m]
[0m09:32:34.825835 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_acquisition
[0m09:32:34.826835 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_engagement
[0m09:32:34.827834 [debug] [Thread-4 (]: Began running node model.growth.fct_user_retention
[0m09:32:34.827834 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referral_metrics' to be skipped because of status 'skipped'. 
[0m09:32:34.831600 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_metrics
[0m09:32:34.835956 [info ] [Thread-4 (]: 50 of 50 SKIP relation marts.fct_user_retention ................................ [[33mSKIP[0m]
[0m09:32:34.836957 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_acquisition' to be skipped because of status 'skipped'. 
[0m09:32:34.838957 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_retention
[0m09:32:34.839955 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_engagement' to be skipped because of status 'skipped'. 
[0m09:32:34.840954 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_metrics' to be skipped because of status 'skipped'. 
[0m09:32:34.840954 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_retention' to be skipped because of status 'skipped'. 
[0m09:32:34.840954 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:34.840954 [debug] [MainThread]: On master: BEGIN
[0m09:32:34.849158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:34.921698 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m09:32:34.922737 [debug] [MainThread]: On master: COMMIT
[0m09:32:34.923268 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:34.924331 [debug] [MainThread]: On master: COMMIT
[0m09:32:34.925406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:34.925937 [debug] [MainThread]: On master: Close
[0m09:32:34.927545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:34.928641 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:32:34.930658 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:32:34.931273 [debug] [MainThread]: Connection 'model.growth.stg_users' was properly closed.
[0m09:32:34.933278 [debug] [MainThread]: Connection 'test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e' was properly closed.
[0m09:32:34.934415 [debug] [MainThread]: Connection 'model.growth.dim_users' was properly closed.
[0m09:32:34.935870 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m09:32:34.936915 [info ] [MainThread]: 
[0m09:32:34.938299 [info ] [MainThread]: Finished running 11 table models, 29 data tests, 10 view models in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m09:32:34.953443 [debug] [MainThread]: Command end result
[0m09:32:35.041712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:32:35.048035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:32:35.067335 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:32:35.070089 [info ] [MainThread]: 
[0m09:32:35.070089 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m09:32:35.070089 [info ] [MainThread]: 
[0m09:32:35.070089 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id (models\staging\schema.yml)[0m
[0m09:32:35.070089 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:32:35.077148 [info ] [MainThread]: 
[0m09:32:35.086370 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_ce21451ab51663af294524ce4a7e56fa.sql
[0m09:32:35.088369 [info ] [MainThread]: 
[0m09:32:35.091341 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_market_date__token (models\staging\schema.yml)[0m
[0m09:32:35.092342 [error] [MainThread]:   Got 156 results, configured to fail if != 0
[0m09:32:35.094340 [info ] [MainThread]: 
[0m09:32:35.095341 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_3a255a5db84d348db66273d767faeca9.sql
[0m09:32:35.102320 [info ] [MainThread]: 
[0m09:32:35.103313 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m09:32:35.104313 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m09:32:35.105320 [info ] [MainThread]: 
[0m09:32:35.107283 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m09:32:35.108676 [info ] [MainThread]: 
[0m09:32:35.110678 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m09:32:35.111680 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m09:32:35.114791 [info ] [MainThread]: 
[0m09:32:35.119903 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m09:32:35.120904 [info ] [MainThread]: 
[0m09:32:35.121904 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m09:32:35.123905 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:32:35.126439 [info ] [MainThread]: 
[0m09:32:35.127438 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m09:32:35.130614 [info ] [MainThread]: 
[0m09:32:35.136143 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m09:32:35.137143 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:32:35.138142 [info ] [MainThread]: 
[0m09:32:35.140523 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m09:32:35.141523 [info ] [MainThread]: 
[0m09:32:35.141523 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m09:32:35.141523 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m09:32:35.141523 [info ] [MainThread]: 
[0m09:32:35.152146 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m09:32:35.154147 [info ] [MainThread]: 
[0m09:32:35.155141 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m09:32:35.156868 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m09:32:35.156868 [info ] [MainThread]: 
[0m09:32:35.156868 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m09:32:35.156868 [info ] [MainThread]: 
[0m09:32:35.156868 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=8 SKIP=19 TOTAL=50
[0m09:32:35.169583 [debug] [MainThread]: Command `dbt build` failed at 09:32:35.169583 after 4.84 seconds
[0m09:32:35.170587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753249D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753274A080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753521ACE0>]}
[0m09:32:35.171589 [debug] [MainThread]: Flushing usage events
[0m09:32:36.453544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:06.881862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D42CD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6181660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6181450>]}


============================== 09:59:06.897531 | 86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea ==============================
[0m09:59:06.897531 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:59:06.897531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:07.175265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D62A86D0>]}
[0m09:59:07.253391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D56088B0>]}
[0m09:59:07.253391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:07.715178 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 0 files added, 1 files changed.
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing: deleted file: growth://models\marts\fct_referral_metrics.sql
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing: deleted file: growth://models\marts\fct_user_acquisition.sql
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing: deleted file: growth://models\marts\mart_transaction_summary.sql
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing: deleted file: growth://models\marts\mart_daily_transactions.sql
[0m09:59:08.073516 [debug] [MainThread]: Partial parsing: updated file: growth://models\marts\fct_user_retention.sql
[0m09:59:08.435552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.staging
- models.growth_metrics.marts
- models.growth_metrics.intermediate
[0m09:59:08.473915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D7BA60E0>]}
[0m09:59:08.633167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:59:08.633167 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:59:08.711261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6AB9D80>]}
[0m09:59:08.711261 [info ] [MainThread]: Found 17 models, 29 data tests, 4 sources, 548 macros
[0m09:59:08.711261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3D9D330>]}
[0m09:59:08.726872 [info ] [MainThread]: 
[0m09:59:08.731443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:08.733117 [info ] [MainThread]: 
[0m09:59:08.734162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:08.748211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:59:08.905773 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:59:08.905773 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:59:08.905773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.952651 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m09:59:08.952651 [debug] [ThreadPool]: On list_nca: Close
[0m09:59:08.968276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:59:08.968276 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:59:08.968276 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:59:08.968276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:09.015151 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m09:59:09.015151 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:59:09.030777 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:59:09.030777 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m09:59:09.030777 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:59:09.030777 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:59:09.046403 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.046403 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.046403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:09.093275 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:59:09.093275 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.093275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:09.108900 [debug] [MainThread]: SQL status: SELECT 10 in 0.010 seconds
[0m09:59:09.108900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D60DB730>]}
[0m09:59:09.108900 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:09.108900 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.108900 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.108900 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:59:09.108900 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.108900 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.108900 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.108900 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:59:09.124527 [debug] [MainThread]: On master: Close
[0m09:59:09.124527 [debug] [Thread-1 (]: Began running node model.growth.stg_market
[0m09:59:09.124527 [debug] [Thread-2 (]: Began running node model.growth.stg_referrals
[0m09:59:09.124527 [debug] [Thread-3 (]: Began running node model.growth.stg_transactions
[0m09:59:09.124527 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m09:59:09.124527 [info ] [Thread-1 (]: 1 of 17 START sql view model marts.stg_market .................................. [RUN]
[0m09:59:09.124527 [info ] [Thread-2 (]: 2 of 17 START sql view model marts.stg_referrals ............................... [RUN]
[0m09:59:09.124527 [info ] [Thread-3 (]: 3 of 17 START sql view model marts.stg_transactions ............................ [RUN]
[0m09:59:09.124527 [info ] [Thread-4 (]: 4 of 17 START sql view model marts.stg_users ................................... [RUN]
[0m09:59:09.140154 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.growth.stg_market'
[0m09:59:09.141569 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.growth.stg_referrals'
[0m09:59:09.143391 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.growth.stg_transactions'
[0m09:59:09.144441 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.growth.stg_users'
[0m09:59:09.145633 [debug] [Thread-1 (]: Began compiling node model.growth.stg_market
[0m09:59:09.146877 [debug] [Thread-2 (]: Began compiling node model.growth.stg_referrals
[0m09:59:09.146877 [debug] [Thread-3 (]: Began compiling node model.growth.stg_transactions
[0m09:59:09.146877 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m09:59:09.163203 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.stg_market"
[0m09:59:09.166204 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.stg_referrals"
[0m09:59:09.166204 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.stg_transactions"
[0m09:59:09.179262 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:59:09.179262 [debug] [Thread-1 (]: Began executing node model.growth.stg_market
[0m09:59:09.179262 [debug] [Thread-2 (]: Began executing node model.growth.stg_referrals
[0m09:59:09.179262 [debug] [Thread-3 (]: Began executing node model.growth.stg_transactions
[0m09:59:09.192500 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m09:59:09.230965 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.stg_market"
[0m09:59:09.234967 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.stg_referrals"
[0m09:59:09.240023 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.stg_transactions"
[0m09:59:09.240023 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:59:09.240023 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.240023 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.240023 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.240023 [debug] [Thread-1 (]: On model.growth.stg_market: BEGIN
[0m09:59:09.240023 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.240023 [debug] [Thread-2 (]: On model.growth.stg_referrals: BEGIN
[0m09:59:09.240023 [debug] [Thread-3 (]: On model.growth.stg_transactions: BEGIN
[0m09:59:09.240023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:09.240023 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m09:59:09.255648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:59:09.255648 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:59:09.255648 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:59:09.333778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m09:59:09.333778 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.333778 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */

  create view "nca"."marts"."stg_market__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."market"
)
SELECT
    date,
    token,
    price,
    daily_volume
FROM source
  );
[0m09:59:09.333778 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:59:09.349405 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.349405 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m09:59:09.349405 [debug] [Thread-3 (]: SQL status: BEGIN in 0.100 seconds
[0m09:59:09.349405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m09:59:09.349405 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market" rename to "stg_market__dbt_backup"
[0m09:59:09.349405 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.349405 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.349405 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.349405 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */

  create view "nca"."marts"."stg_referrals__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."referrals"
)
SELECT
    referrer_user_id,
    referred_user_id,
    referral_date
FROM source
  );
[0m09:59:09.349405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.349405 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */

  create view "nca"."marts"."stg_transactions__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."transactions"
)
SELECT
    transaction_id,
    user_id,
    transaction_type,
    token,
    amount,
    timestamp
FROM source
  );
[0m09:59:09.365025 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:59:09.365025 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.365025 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:59:09.365025 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
alter table "nca"."marts"."stg_market__dbt_tmp" rename to "stg_market"
[0m09:59:09.365025 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.380652 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:59:09.380652 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:59:09.380652 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m09:59:09.380652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.380652 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.380652 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.396277 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:59:09.411902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m09:59:09.412699 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:59:09.412699 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m09:59:09.412699 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.412699 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.412699 [debug] [Thread-1 (]: On model.growth.stg_market: COMMIT
[0m09:59:09.412699 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.412699 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:59:09.412699 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
alter table "nca"."marts"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m09:59:09.428104 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.429100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:59:09.434098 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.435100 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:59:09.436143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.439635 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."stg_market__dbt_backup"
[0m09:59:09.439635 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
alter table "nca"."marts"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m09:59:09.439635 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:59:09.439635 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:59:09.439635 [debug] [Thread-1 (]: Using postgres connection "model.growth.stg_market"
[0m09:59:09.455264 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.455264 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.455264 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:59:09.455264 [debug] [Thread-1 (]: On model.growth.stg_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_market"} */
drop view if exists "nca"."marts"."stg_market__dbt_backup" cascade
[0m09:59:09.455264 [debug] [Thread-2 (]: On model.growth.stg_referrals: COMMIT
[0m09:59:09.455264 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:59:09.455264 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.455264 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.455264 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:09.455264 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:59:09.455264 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:59:09.455264 [debug] [Thread-3 (]: On model.growth.stg_transactions: COMMIT
[0m09:59:09.470888 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."stg_referrals__dbt_backup"
[0m09:59:09.470888 [debug] [Thread-1 (]: On model.growth.stg_market: Close
[0m09:59:09.470888 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m09:59:09.470888 [debug] [Thread-2 (]: Using postgres connection "model.growth.stg_referrals"
[0m09:59:09.470888 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:09.486514 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:59:09.486514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D615A0E0>]}
[0m09:59:09.486514 [debug] [Thread-2 (]: On model.growth.stg_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_referrals"} */
drop view if exists "nca"."marts"."stg_referrals__dbt_backup" cascade
[0m09:59:09.486514 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."stg_transactions__dbt_backup"
[0m09:59:09.486514 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:09.486514 [info ] [Thread-1 (]: 1 of 17 OK created sql view model marts.stg_market ............................. [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:09.486514 [debug] [Thread-3 (]: Using postgres connection "model.growth.stg_transactions"
[0m09:59:09.486514 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:59:09.486514 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:59:09.486514 [debug] [Thread-1 (]: Finished running node model.growth.stg_market
[0m09:59:09.486514 [debug] [Thread-3 (]: On model.growth.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_transactions"} */
drop view if exists "nca"."marts"."stg_transactions__dbt_backup" cascade
[0m09:59:09.503705 [debug] [Thread-2 (]: On model.growth.stg_referrals: Close
[0m09:59:09.504709 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:59:09.506647 [debug] [Thread-1 (]: Began running node model.growth.dim_market
[0m09:59:09.509650 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D615A770>]}
[0m09:59:09.511613 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m09:59:09.511613 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:59:09.511613 [info ] [Thread-1 (]: 5 of 17 START sql view model marts.dim_market .................................. [RUN]
[0m09:59:09.511613 [info ] [Thread-2 (]: 2 of 17 OK created sql view model marts.stg_referrals .......................... [[32mCREATE VIEW[0m in 0.37s]
[0m09:59:09.511613 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D615BDF0>]}
[0m09:59:09.511613 [debug] [Thread-3 (]: On model.growth.stg_transactions: Close
[0m09:59:09.511613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.stg_market, now model.growth.dim_market)
[0m09:59:09.527950 [debug] [Thread-2 (]: Finished running node model.growth.stg_referrals
[0m09:59:09.528951 [info ] [Thread-4 (]: 4 of 17 OK created sql view model marts.stg_users .............................. [[32mCREATE VIEW[0m in 0.37s]
[0m09:59:09.530950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D4070BE0>]}
[0m09:59:09.531950 [debug] [Thread-1 (]: Began compiling node model.growth.dim_market
[0m09:59:09.532953 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m09:59:09.532953 [debug] [Thread-2 (]: Began running node model.growth.dim_referrals
[0m09:59:09.532953 [info ] [Thread-3 (]: 3 of 17 OK created sql view model marts.stg_transactions ....................... [[32mCREATE VIEW[0m in 0.39s]
[0m09:59:09.543647 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_market"
[0m09:59:09.544642 [debug] [Thread-4 (]: Began running node model.growth.dim_users
[0m09:59:09.545540 [info ] [Thread-2 (]: 6 of 17 START sql view model marts.dim_referrals ............................... [RUN]
[0m09:59:09.548578 [debug] [Thread-3 (]: Finished running node model.growth.stg_transactions
[0m09:59:09.550574 [debug] [Thread-1 (]: Began executing node model.growth.dim_market
[0m09:59:09.549575 [info ] [Thread-4 (]: 7 of 17 START sql view model marts.dim_users ................................... [RUN]
[0m09:59:09.551576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.stg_referrals, now model.growth.dim_referrals)
[0m09:59:09.562696 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_market"
[0m09:59:09.563697 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m09:59:09.564694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.stg_users, now model.growth.dim_users)
[0m09:59:09.564694 [debug] [Thread-2 (]: Began compiling node model.growth.dim_referrals
[0m09:59:09.567701 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m09:59:09.567701 [debug] [Thread-4 (]: Began compiling node model.growth.dim_users
[0m09:59:09.566694 [info ] [Thread-3 (]: 8 of 17 START sql view model marts.dim_transactions ............................ [RUN]
[0m09:59:09.567701 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.dim_referrals"
[0m09:59:09.575180 [debug] [Thread-1 (]: On model.growth.dim_market: BEGIN
[0m09:59:09.581605 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:59:09.582613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.stg_transactions, now model.growth.dim_transactions)
[0m09:59:09.582613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:09.582613 [debug] [Thread-2 (]: Began executing node model.growth.dim_referrals
[0m09:59:09.582613 [debug] [Thread-3 (]: Began compiling node model.growth.dim_transactions
[0m09:59:09.582613 [debug] [Thread-4 (]: Began executing node model.growth.dim_users
[0m09:59:09.593583 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.dim_referrals"
[0m09:59:09.609772 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.dim_transactions"
[0m09:59:09.609772 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:59:09.609772 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:59:09.609772 [debug] [Thread-3 (]: Began executing node model.growth.dim_transactions
[0m09:59:09.609772 [debug] [Thread-2 (]: On model.growth.dim_referrals: BEGIN
[0m09:59:09.609772 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:09.629225 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.dim_transactions"
[0m09:59:09.630224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:09.631225 [debug] [Thread-4 (]: On model.growth.dim_users: BEGIN
[0m09:59:09.632225 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:09.634227 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:59:09.636229 [debug] [Thread-3 (]: On model.growth.dim_transactions: BEGIN
[0m09:59:09.637230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:09.657109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m09:59:09.657109 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m09:59:09.657109 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */

  create view "nca"."marts"."dim_market__dbt_tmp"
    
    
  as (
    


WITH cleaned_market AS (
    SELECT
        date,
        UPPER(token) as token,
        NULLIF(price, 0) as price,
        NULLIF(daily_volume, 0) as daily_volume
    FROM "nca"."marts"."stg_market"
    WHERE token IS NOT NULL
        AND date IS NOT NULL
)
SELECT * 
FROM cleaned_market
  );
[0m09:59:09.672786 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:59:09.672786 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m09:59:09.672786 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
alter table "nca"."marts"."dim_market__dbt_tmp" rename to "dim_market"
[0m09:59:09.672786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.688411 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m09:59:09.688411 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m09:59:09.688411 [debug] [Thread-1 (]: On model.growth.dim_market: COMMIT
[0m09:59:09.688411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:09.688411 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_market__dbt_backup"
[0m09:59:09.704034 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_market"
[0m09:59:09.704034 [debug] [Thread-1 (]: On model.growth.dim_market: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_market"} */
drop view if exists "nca"."marts"."dim_market__dbt_backup" cascade
[0m09:59:09.704034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:59:09.704034 [debug] [Thread-1 (]: On model.growth.dim_market: Close
[0m09:59:09.704034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6A3C0A0>]}
[0m09:59:09.704034 [info ] [Thread-1 (]: 5 of 17 OK created sql view model marts.dim_market ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m09:59:09.704034 [debug] [Thread-1 (]: Finished running node model.growth.dim_market
[0m09:59:09.719662 [debug] [Thread-3 (]: SQL status: BEGIN in 0.082 seconds
[0m09:59:09.704034 [debug] [Thread-1 (]: Began running node model.growth.fct_users_acquisition
[0m09:59:09.719662 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:59:09.719662 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */

  create view "nca"."marts"."dim_transactions__dbt_tmp"
    
    
  as (
    

WITH cleaned_transactions AS (
    SELECT DISTINCT
        transaction_id,
        user_id,
        LOWER(transaction_type) as transaction_type,
        UPPER(token) as token,
        CASE 
            WHEN amount <= 0 THEN NULL
            ELSE amount 
        END as amount,
        timestamp
    FROM "nca"."marts"."stg_transactions"
    WHERE transaction_id IS NOT NULL
        AND user_id IS NOT NULL
)
SELECT * FROM cleaned_transactions
  );
[0m09:59:09.719662 [info ] [Thread-1 (]: 9 of 17 START sql table model marts.fct_users_acquisition ...................... [RUN]
[0m09:59:09.719662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.dim_market, now model.growth.fct_users_acquisition)
[0m09:59:09.719662 [debug] [Thread-1 (]: Began compiling node model.growth.fct_users_acquisition
[0m09:59:09.730188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m09:59:09.739936 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:59:09.731738 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:59:09.741985 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */

  create view "nca"."marts"."dim_referrals__dbt_tmp"
    
    
  as (
    

WITH cleaned_referrals AS (
    SELECT DISTINCT
        referrer_user_id,
        referred_user_id,
        referral_date
    FROM "nca"."marts"."stg_referrals"
    WHERE referrer_user_id IS NOT NULL
        AND referred_user_id IS NOT NULL
        AND referrer_user_id != referred_user_id
)
SELECT * 
FROM cleaned_referrals
  );
[0m09:59:09.744080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.111 seconds
[0m09:59:09.744802 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_users_acquisition"
[0m09:59:09.748799 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:59:09.749799 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:09.750800 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
alter table "nca"."marts"."dim_transactions__dbt_tmp" rename to "dim_transactions"
[0m09:59:09.750800 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:59:09.750800 [debug] [Thread-1 (]: Began executing node model.growth.fct_users_acquisition
[0m09:59:09.750800 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:59:09.750800 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.775389 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m09:59:09.775870 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_users_acquisition"
[0m09:59:09.793368 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:59:09.795370 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m09:59:09.799366 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:09.800369 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
alter table "nca"."marts"."dim_referrals__dbt_tmp" rename to "dim_referrals"
[0m09:59:09.801370 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:09.802368 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:59:09.803368 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:59:09.805368 [debug] [Thread-3 (]: On model.growth.dim_transactions: COMMIT
[0m09:59:09.804369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.804369 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: BEGIN
[0m09:59:09.808049 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:09.811047 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m09:59:09.811047 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:59:09.812045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:09.813046 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m09:59:09.814045 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:59:09.817044 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."dim_transactions__dbt_backup"
[0m09:59:09.819046 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:09.820046 [debug] [Thread-2 (]: On model.growth.dim_referrals: COMMIT
[0m09:59:09.821046 [debug] [Thread-3 (]: Using postgres connection "model.growth.dim_transactions"
[0m09:59:09.822048 [debug] [Thread-4 (]: On model.growth.dim_users: COMMIT
[0m09:59:09.825050 [debug] [Thread-3 (]: On model.growth.dim_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_transactions"} */
drop view if exists "nca"."marts"."dim_transactions__dbt_backup" cascade
[0m09:59:09.826047 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:59:09.826965 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:09.826965 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:59:09.826965 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."dim_referrals__dbt_backup"
[0m09:59:09.842591 [debug] [Thread-2 (]: Using postgres connection "model.growth.dim_referrals"
[0m09:59:09.842591 [debug] [Thread-3 (]: On model.growth.dim_transactions: Close
[0m09:59:09.842591 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:59:09.842591 [debug] [Thread-2 (]: On model.growth.dim_referrals: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_referrals"} */
drop view if exists "nca"."marts"."dim_referrals__dbt_backup" cascade
[0m09:59:09.842591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3660820>]}
[0m09:59:09.842591 [debug] [Thread-4 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:09.858217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:59:09.858217 [info ] [Thread-3 (]: 8 of 17 OK created sql view model marts.dim_transactions ....................... [[32mCREATE VIEW[0m in 0.26s]
[0m09:59:09.858217 [debug] [Thread-4 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:59:09.858217 [debug] [Thread-2 (]: On model.growth.dim_referrals: Close
[0m09:59:09.858217 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m09:59:09.858217 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:59:09.858217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D8190A00>]}
[0m09:59:09.858217 [debug] [Thread-3 (]: Began running node model.growth.int_enriched_transactions
[0m09:59:09.877191 [debug] [Thread-4 (]: On model.growth.dim_users: Close
[0m09:59:09.882119 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D81909D0>]}
[0m09:59:09.878798 [info ] [Thread-2 (]: 6 of 17 OK created sql view model marts.dim_referrals .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:59:09.880004 [info ] [Thread-3 (]: 10 of 17 START sql view model marts.int_enriched_transactions .................. [RUN]
[0m09:59:09.882119 [info ] [Thread-4 (]: 7 of 17 OK created sql view model marts.dim_users .............................. [[32mCREATE VIEW[0m in 0.32s]
[0m09:59:09.892881 [debug] [Thread-2 (]: Finished running node model.growth.dim_referrals
[0m09:59:09.895048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.dim_transactions, now model.growth.int_enriched_transactions)
[0m09:59:09.896665 [debug] [Thread-4 (]: Finished running node model.growth.dim_users
[0m09:59:09.898664 [debug] [Thread-3 (]: Began compiling node model.growth.int_enriched_transactions
[0m09:59:09.900664 [debug] [Thread-2 (]: Began running node model.growth.int_enriched_users
[0m09:59:09.915154 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.int_enriched_transactions"
[0m09:59:09.916152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m09:59:09.910754 [info ] [Thread-2 (]: 11 of 17 START sql view model marts.int_enriched_users ......................... [RUN]
[0m09:59:09.916152 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:09.916152 [debug] [Thread-3 (]: Began executing node model.growth.int_enriched_transactions
[0m09:59:09.916152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.dim_referrals, now model.growth.int_enriched_users)
[0m09:59:09.923458 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */

  
    

  create  table "nca"."marts"."fct_users_acquisition__dbt_tmp"
  
  
    as
  
  (
    

WITH user_base AS (
    SELECT
        u.user_id,
        u.country,
        u.signup_date,
        DATE_TRUNC('week', u.signup_date) as signup_week,
        CASE WHEN r.referred_user_id IS NOT NULL THEN true ELSE false END as is_referred_user,
        -- Get first transaction details
        MIN(t.timestamp) as first_transaction_date,
        MIN(t.amount) as first_transaction_amount
    FROM "nca"."marts"."stg_users" u
    LEFT JOIN "nca"."marts"."stg_referrals" r 
        ON u.user_id = r.referred_user_id
    LEFT JOIN "nca"."marts"."stg_transactions" t 
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
),

user_acquisition AS (
    SELECT 
        country,
        signup_week,
        -- Basic signup metrics
        COUNT(DISTINCT user_id) as total_signups,
        SUM(CASE WHEN is_referred_user THEN 0 ELSE 1 END) as direct_signups,
        SUM(CASE WHEN is_referred_user THEN 1 ELSE 0 END) as referral_signups,
        
        -- Activation metrics
        COUNT(DISTINCT CASE 
            WHEN first_transaction_date IS NOT NULL THEN user_id 
        END) as activated_users,
        
        -- Time to activation
        AVG(CASE 
            WHEN first_transaction_date IS NOT NULL 
            THEN EXTRACT(EPOCH FROM (first_transaction_date - signup_date))/3600
        END) as avg_hours_to_first_transaction,
        
        -- First transaction value
        AVG(CASE 
            WHEN first_transaction_amount IS NOT NULL 
            THEN first_transaction_amount
        END) as avg_first_transaction_value
    FROM user_base
    WHERE country IS NOT NULL
    GROUP BY 1, 2
),

final AS (
    SELECT 
        *,
        -- Signup source percentages
        ROUND((direct_signups * 100.0 / NULLIF(total_signups, 0)), 2) as direct_signup_percentage,
        ROUND((referral_signups * 100.0 / NULLIF(total_signups, 0)), 2) as referral_signup_percentage,
        
        -- Activation rate
        ROUND((activated_users * 100.0 / NULLIF(total_signups, 0)), 2) as activation_rate,
        
        -- Weekly growth metrics
        LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week) as prev_week_signups,
        ROUND(
            ((total_signups * 1.0 / NULLIF(LAG(total_signups) OVER (PARTITION BY country ORDER BY signup_week), 0)) - 1) * 100,
            2
        ) as week_over_week_growth
    FROM user_acquisition
)

SELECT 
    country,
    signup_week,
    total_signups,
    direct_signups,
    referral_signups,
    direct_signup_percentage,
    referral_signup_percentage,
    activated_users,
    activation_rate,
    avg_hours_to_first_transaction,
    avg_first_transaction_value,
    week_over_week_growth
FROM final
ORDER BY 
signup_week DESC, 
total_signups DESC
  );
  
[0m09:59:09.934010 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.int_enriched_transactions"
[0m09:59:09.934010 [debug] [Thread-2 (]: Began compiling node model.growth.int_enriched_users
[0m09:59:09.945388 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:59:09.959758 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: BEGIN
[0m09:59:09.963997 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.int_enriched_users"
[0m09:59:09.965083 [debug] [Thread-1 (]: SQL status: SELECT 97 in 0.026 seconds
[0m09:59:09.965083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:09.976744 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:09.977806 [debug] [Thread-2 (]: Began executing node model.growth.int_enriched_users
[0m09:59:09.979818 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition" rename to "fct_users_acquisition__dbt_backup"
[0m09:59:09.992483 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.int_enriched_users"
[0m09:59:09.994487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.005061 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:10.007073 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
alter table "nca"."marts"."fct_users_acquisition__dbt_tmp" rename to "fct_users_acquisition"
[0m09:59:10.008148 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:59:10.008148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:59:10.008148 [debug] [Thread-2 (]: On model.growth.int_enriched_users: BEGIN
[0m09:59:10.021732 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:59:10.021732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:10.021732 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:10.021732 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: COMMIT
[0m09:59:10.021732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.035305 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_users_acquisition__dbt_backup"
[0m09:59:10.035305 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_users_acquisition"
[0m09:59:10.047685 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_users_acquisition"} */
drop table if exists "nca"."marts"."fct_users_acquisition__dbt_backup" cascade
[0m09:59:10.050695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:59:10.054840 [debug] [Thread-1 (]: On model.growth.fct_users_acquisition: Close
[0m09:59:10.054840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6A3C0A0>]}
[0m09:59:10.054840 [info ] [Thread-1 (]: 9 of 17 OK created sql table model marts.fct_users_acquisition ................. [[32mSELECT 97[0m in 0.34s]
[0m09:59:10.063112 [debug] [Thread-1 (]: Finished running node model.growth.fct_users_acquisition
[0m09:59:10.081013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m09:59:10.082090 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:59:10.084047 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */

  create view "nca"."marts"."int_enriched_transactions__dbt_tmp"
    
    
  as (
    

WITH transaction_enriched AS (
    SELECT
        t.*,
        m.price as token_price,
        m.daily_volume as market_daily_volume,
        t.amount * m.price as usd_value,
        DATE_TRUNC('day', t.timestamp) as transaction_date
    FROM "nca"."marts"."dim_transactions" t
    LEFT JOIN "nca"."marts"."dim_market" m
        ON t.token = m.token 
        AND DATE_TRUNC('day', t.timestamp) = m.date
)
SELECT * FROM transaction_enriched
  );
[0m09:59:10.092225 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:59:10.101520 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:59:10.103214 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
alter table "nca"."marts"."int_enriched_transactions__dbt_tmp" rename to "int_enriched_transactions"
[0m09:59:10.105119 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.105665 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:59:10.109892 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:59:10.110893 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: COMMIT
[0m09:59:10.112952 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.118971 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."int_enriched_transactions__dbt_backup"
[0m09:59:10.121160 [debug] [Thread-3 (]: Using postgres connection "model.growth.int_enriched_transactions"
[0m09:59:10.122208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.096 seconds
[0m09:59:10.122813 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_transactions"} */
drop view if exists "nca"."marts"."int_enriched_transactions__dbt_backup" cascade
[0m09:59:10.125056 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:59:10.126812 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */

  create view "nca"."marts"."int_enriched_users__dbt_tmp"
    
    
  as (
    

WITH user_enriched AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.referral_code,
        r.referrer_user_id,
        CASE 
            WHEN r.referred_user_id IS NOT NULL THEN true 
            ELSE false 
        END as is_referred_user,
        DATE_TRUNC('week', u.signup_date) as signup_week
    FROM "nca"."marts"."dim_users" u
    LEFT JOIN "nca"."marts"."dim_referrals" r
        ON u.user_id = r.referred_user_id
)
SELECT * FROM user_enriched
  );
[0m09:59:10.127870 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:59:10.131816 [debug] [Thread-3 (]: On model.growth.int_enriched_transactions: Close
[0m09:59:10.133870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D81DDA20>]}
[0m09:59:10.134880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:59:10.143838 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:59:10.136589 [info ] [Thread-3 (]: 10 of 17 OK created sql view model marts.int_enriched_transactions ............. [[32mCREATE VIEW[0m in 0.24s]
[0m09:59:10.144894 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
alter table "nca"."marts"."int_enriched_users__dbt_tmp" rename to "int_enriched_users"
[0m09:59:10.144894 [debug] [Thread-3 (]: Finished running node model.growth.int_enriched_transactions
[0m09:59:10.149759 [debug] [Thread-4 (]: Began running node model.growth.fct_referrals_performance
[0m09:59:10.150804 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.151336 [debug] [Thread-1 (]: Began running node model.growth.fct_token_metrics
[0m09:59:10.152405 [debug] [Thread-3 (]: Began running node model.growth.fct_transaction_metrics
[0m09:59:10.157181 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m09:59:10.154011 [info ] [Thread-4 (]: 12 of 17 START sql table model marts.fct_referrals_performance ................. [RUN]
[0m09:59:10.159800 [info ] [Thread-1 (]: 13 of 17 START sql table model marts.fct_token_metrics ......................... [RUN]
[0m09:59:10.162261 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:59:10.161381 [info ] [Thread-3 (]: 14 of 17 START sql table model marts.fct_transaction_metrics ................... [RUN]
[0m09:59:10.163756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.dim_users, now model.growth.fct_referrals_performance)
[0m09:59:10.165770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_users_acquisition, now model.growth.fct_token_metrics)
[0m09:59:10.171869 [debug] [Thread-1 (]: Began compiling node model.growth.fct_token_metrics
[0m09:59:10.168667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_transactions, now model.growth.fct_transaction_metrics)
[0m09:59:10.184481 [debug] [Thread-3 (]: Began compiling node model.growth.fct_transaction_metrics
[0m09:59:10.170343 [debug] [Thread-4 (]: Began compiling node model.growth.fct_referrals_performance
[0m09:59:10.183113 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_token_metrics"
[0m09:59:10.166654 [debug] [Thread-2 (]: On model.growth.int_enriched_users: COMMIT
[0m09:59:10.270834 [debug] [Thread-3 (]: Writing injected SQL for node "model.growth.fct_transaction_metrics"
[0m09:59:10.276168 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_referrals_performance"
[0m09:59:10.278169 [debug] [Thread-1 (]: Began executing node model.growth.fct_token_metrics
[0m09:59:10.279169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.280168 [debug] [Thread-3 (]: Began executing node model.growth.fct_transaction_metrics
[0m09:59:10.285166 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_token_metrics"
[0m09:59:10.286166 [debug] [Thread-4 (]: Began executing node model.growth.fct_referrals_performance
[0m09:59:10.289166 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."int_enriched_users__dbt_backup"
[0m09:59:10.292169 [debug] [Thread-3 (]: Writing runtime sql for node "model.growth.fct_transaction_metrics"
[0m09:59:10.292169 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_referrals_performance"
[0m09:59:10.292169 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.292169 [debug] [Thread-2 (]: Using postgres connection "model.growth.int_enriched_users"
[0m09:59:10.292169 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.292169 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: BEGIN
[0m09:59:10.292169 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.307827 [debug] [Thread-2 (]: On model.growth.int_enriched_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.int_enriched_users"} */
drop view if exists "nca"."marts"."int_enriched_users__dbt_backup" cascade
[0m09:59:10.307827 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: BEGIN
[0m09:59:10.307827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:10.307827 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: BEGIN
[0m09:59:10.307827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:10.307827 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:59:10.307827 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:10.307827 [debug] [Thread-2 (]: On model.growth.int_enriched_users: Close
[0m09:59:10.307827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D8263340>]}
[0m09:59:10.323452 [info ] [Thread-2 (]: 11 of 17 OK created sql view model marts.int_enriched_users .................... [[32mCREATE VIEW[0m in 0.39s]
[0m09:59:10.323452 [debug] [Thread-2 (]: Finished running node model.growth.int_enriched_users
[0m09:59:10.323452 [debug] [Thread-2 (]: Began running node model.growth.fct_user_engagement
[0m09:59:10.323452 [info ] [Thread-2 (]: 15 of 17 START sql table model marts.fct_user_engagement ....................... [RUN]
[0m09:59:10.332909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.growth.int_enriched_users, now model.growth.fct_user_engagement)
[0m09:59:10.333913 [debug] [Thread-2 (]: Began compiling node model.growth.fct_user_engagement
[0m09:59:10.345079 [debug] [Thread-2 (]: Writing injected SQL for node "model.growth.fct_user_engagement"
[0m09:59:10.347076 [debug] [Thread-2 (]: Began executing node model.growth.fct_user_engagement
[0m09:59:10.361083 [debug] [Thread-2 (]: Writing runtime sql for node "model.growth.fct_user_engagement"
[0m09:59:10.361083 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.361083 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: BEGIN
[0m09:59:10.361083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:10.424462 [debug] [Thread-4 (]: SQL status: BEGIN in 0.113 seconds
[0m09:59:10.424462 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.424462 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */

  
    

  create  table "nca"."marts"."fct_referrals_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH referrer_stats AS (
    SELECT 
        r.referrer_user_id,
        COUNT(DISTINCT r.referred_user_id) as total_referrals,
        COUNT(DISTINCT CASE WHEN t.transaction_id IS NOT NULL THEN r.referred_user_id END) as activated_referrals,
        SUM(t.amount) as referred_user_volume,
        AVG(t.amount) as avg_referred_transaction_size
    FROM "nca"."marts"."dim_referrals" r
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON r.referred_user_id = t.user_id
    GROUP BY 1
)
SELECT 
    *,
    ROUND(100.0 * activated_referrals / NULLIF(total_referrals, 0), 2) as referral_activation_rate,
    ROUND(referred_user_volume / NULLIF(activated_referrals, 0), 2) as volume_per_activated_referral
FROM referrer_stats
  );
  
[0m09:59:10.424462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.120 seconds
[0m09:59:10.424462 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.424462 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */

  
    

  create  table "nca"."marts"."fct_token_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH token_metrics AS (
    SELECT
        token,
        COUNT(DISTINCT transaction_id) as total_transactions,
        COUNT(DISTINCT user_id) as unique_users,
        SUM(usd_value) as total_volume_usd,
        AVG(usd_value) as avg_transaction_value_usd,
        MIN(token_price) as min_price,
        MAX(token_price) as max_price,
        AVG(token_price) as avg_price,
        AVG(market_daily_volume) as avg_daily_market_volume
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
)
SELECT * FROM token_metrics
  );
  
[0m09:59:10.424462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.124 seconds
[0m09:59:10.424462 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.424462 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */

  
    

  create  table "nca"."marts"."fct_transaction_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH first_transactions AS (
    SELECT 
        user_id,
        MIN(timestamp) as first_transaction_date
    FROM "nca"."marts"."int_enriched_transactions"
    GROUP BY 1
),

daily_transactions AS (
    SELECT
        DATE_TRUNC('day', t.timestamp) as date,
        t.token,
        t.transaction_type,
        COUNT(DISTINCT t.transaction_id) as transaction_count,
        COUNT(DISTINCT t.user_id) as unique_users,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size,
        SUM(CASE WHEN t.transaction_date = ft.first_transaction_date THEN 1 ELSE 0 END) as new_user_transactions
    FROM "nca"."marts"."int_enriched_transactions" t
    LEFT JOIN first_transactions ft ON t.user_id = ft.user_id
    GROUP BY 1, 2, 3

)
SELECT 
    *,
    SUM(transaction_count) OVER (PARTITION BY token ORDER BY date) as cumulative_transactions,
    SUM(total_volume) OVER (PARTITION BY token ORDER BY date) as cumulative_volume,
    LAG(transaction_count) OVER (PARTITION BY token ORDER BY date) as prev_day_transactions,
    ROUND(100.0 * (transaction_count - LAG(transaction_count) OVER (PARTITION BY token ORDER BY date)) 
        / NULLIF(LAG(transaction_count) OVER (PARTITION BY token ORDER BY date), 0), 2) as daily_growth_rate
FROM daily_transactions
  );
  
[0m09:59:10.440132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m09:59:10.440132 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.440132 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */

  
    

  create  table "nca"."marts"."fct_user_engagement__dbt_tmp"
  
  
    as
  
  (
    

WITH user_activity AS (
    SELECT
        u.user_id,
        u.signup_date,
        MIN(t.timestamp) as first_activity_date,
        MAX(t.timestamp) as last_activity_date,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        COUNT(DISTINCT t.token) as unique_tokens_used,
        SUM(t.amount) as total_volume,
        AVG(t.amount) as avg_transaction_size
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2
)
SELECT 
    *,
    EXTRACT(DAY FROM (first_activity_date - signup_date)) as days_to_activate,
    EXTRACT(DAY FROM (last_activity_date - signup_date)) as days_since_signup,
    EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) as days_since_last_activity,
    CASE 
        WHEN total_transactions = 0 THEN 'never_active'
        WHEN EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) <= 7 THEN 'active_7d'
        WHEN EXTRACT(DAY FROM (CURRENT_DATE - last_activity_date)) <= 30 THEN 'active_30d'
        ELSE 'inactive'
    END as activity_status
FROM user_activity
  );
  
[0m09:59:10.497749 [debug] [Thread-4 (]: SQL status: SELECT 77 in 0.065 seconds
[0m09:59:10.505748 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.506748 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance" rename to "fct_referrals_performance__dbt_backup"
[0m09:59:10.507411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:59:10.507411 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.507411 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.083 seconds
[0m09:59:10.507411 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.069 seconds
[0m09:59:10.507411 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
alter table "nca"."marts"."fct_referrals_performance__dbt_tmp" rename to "fct_referrals_performance"
[0m09:59:10.523041 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.523041 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.523041 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics" rename to "fct_token_metrics__dbt_backup"
[0m09:59:10.523041 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.523041 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */
alter table "nca"."marts"."fct_user_engagement" rename to "fct_user_engagement__dbt_backup"
[0m09:59:10.538664 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:59:10.538664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:59:10.538664 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.538664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.538664 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.538664 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: COMMIT
[0m09:59:10.554288 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.554288 [debug] [Thread-3 (]: SQL status: SELECT 713 in 0.118 seconds
[0m09:59:10.554288 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
alter table "nca"."marts"."fct_token_metrics__dbt_tmp" rename to "fct_token_metrics"
[0m09:59:10.554288 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */
alter table "nca"."marts"."fct_user_engagement__dbt_tmp" rename to "fct_user_engagement"
[0m09:59:10.554288 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.554288 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.554288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.569912 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:59:10.569912 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_referrals_performance__dbt_backup"
[0m09:59:10.569912 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */
alter table "nca"."marts"."fct_transaction_metrics" rename to "fct_transaction_metrics__dbt_backup"
[0m09:59:10.569912 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:59:10.569912 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: COMMIT
[0m09:59:10.569912 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_referrals_performance"
[0m09:59:10.569912 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.569912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.569912 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.569912 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_referrals_performance"} */
drop table if exists "nca"."marts"."fct_referrals_performance__dbt_backup" cascade
[0m09:59:10.569912 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: COMMIT
[0m09:59:10.585542 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.585542 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: COMMIT
[0m09:59:10.585542 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */
alter table "nca"."marts"."fct_transaction_metrics__dbt_tmp" rename to "fct_transaction_metrics"
[0m09:59:10.585542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.585542 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_token_metrics__dbt_backup"
[0m09:59:10.585542 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m09:59:10.585542 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:59:10.585542 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:59:10.585542 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_token_metrics"
[0m09:59:10.601164 [debug] [Thread-2 (]: Applying DROP to: "nca"."marts"."fct_user_engagement__dbt_backup"
[0m09:59:10.601164 [debug] [Thread-4 (]: On model.growth.fct_referrals_performance: Close
[0m09:59:10.601164 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: COMMIT
[0m09:59:10.601164 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_token_metrics"} */
drop table if exists "nca"."marts"."fct_token_metrics__dbt_backup" cascade
[0m09:59:10.601164 [debug] [Thread-2 (]: Using postgres connection "model.growth.fct_user_engagement"
[0m09:59:10.601164 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6A09A80>]}
[0m09:59:10.601164 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.601164 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_engagement"} */
drop table if exists "nca"."marts"."fct_user_engagement__dbt_backup" cascade
[0m09:59:10.616792 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: COMMIT
[0m09:59:10.616792 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:59:10.616792 [info ] [Thread-4 (]: 12 of 17 OK created sql table model marts.fct_referrals_performance ............ [[32mSELECT 77[0m in 0.44s]
[0m09:59:10.616792 [debug] [Thread-1 (]: On model.growth.fct_token_metrics: Close
[0m09:59:10.616792 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:59:10.616792 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:59:10.616792 [debug] [Thread-4 (]: Finished running node model.growth.fct_referrals_performance
[0m09:59:10.616792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D8122590>]}
[0m09:59:10.632419 [debug] [Thread-3 (]: Applying DROP to: "nca"."marts"."fct_transaction_metrics__dbt_backup"
[0m09:59:10.635806 [debug] [Thread-2 (]: On model.growth.fct_user_engagement: Close
[0m09:59:10.637750 [debug] [Thread-4 (]: Began running node model.growth.fct_user_metrics
[0m09:59:10.638800 [info ] [Thread-1 (]: 13 of 17 OK created sql table model marts.fct_token_metrics .................... [[32mSELECT 4[0m in 0.45s]
[0m09:59:10.644022 [debug] [Thread-3 (]: Using postgres connection "model.growth.fct_transaction_metrics"
[0m09:59:10.644022 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D673A6E0>]}
[0m09:59:10.644022 [info ] [Thread-4 (]: 16 of 17 START sql table model marts.fct_user_metrics .......................... [RUN]
[0m09:59:10.649356 [debug] [Thread-1 (]: Finished running node model.growth.fct_token_metrics
[0m09:59:10.651355 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_transaction_metrics"} */
drop table if exists "nca"."marts"."fct_transaction_metrics__dbt_backup" cascade
[0m09:59:10.652354 [info ] [Thread-2 (]: 15 of 17 OK created sql table model marts.fct_user_engagement .................. [[32mSELECT 200[0m in 0.32s]
[0m09:59:10.653355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.growth.fct_referrals_performance, now model.growth.fct_user_metrics)
[0m09:59:10.654353 [debug] [Thread-1 (]: Began running node model.growth.fct_user_retention
[0m09:59:10.659502 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_engagement
[0m09:59:10.661501 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:59:10.663208 [debug] [Thread-4 (]: Began compiling node model.growth.fct_user_metrics
[0m09:59:10.665263 [info ] [Thread-1 (]: 17 of 17 START sql table model marts.fct_user_retention ........................ [RUN]
[0m09:59:10.668262 [debug] [Thread-3 (]: On model.growth.fct_transaction_metrics: Close
[0m09:59:10.676262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.growth.fct_token_metrics, now model.growth.fct_user_retention)
[0m09:59:10.681232 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.fct_user_metrics"
[0m09:59:10.683235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D7FE8C10>]}
[0m09:59:10.684233 [debug] [Thread-1 (]: Began compiling node model.growth.fct_user_retention
[0m09:59:10.684233 [debug] [Thread-4 (]: Began executing node model.growth.fct_user_metrics
[0m09:59:10.684233 [info ] [Thread-3 (]: 14 of 17 OK created sql table model marts.fct_transaction_metrics .............. [[32mSELECT 713[0m in 0.51s]
[0m09:59:10.700738 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.fct_user_metrics"
[0m09:59:10.701737 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.fct_user_retention"
[0m09:59:10.701737 [debug] [Thread-3 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:59:10.710821 [debug] [Thread-1 (]: Began executing node model.growth.fct_user_retention
[0m09:59:10.711916 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.727424 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.fct_user_retention"
[0m09:59:10.727424 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: BEGIN
[0m09:59:10.727424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:10.727424 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.727424 [debug] [Thread-1 (]: On model.growth.fct_user_retention: BEGIN
[0m09:59:10.727424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:10.790661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.063 seconds
[0m09:59:10.790661 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.790661 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */

  
    

  create  table "nca"."marts"."fct_user_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH user_metrics AS (
    SELECT
        u.user_id,
        u.signup_date,
        u.country,
        u.is_referred_user,
        u.signup_week,
        COUNT(DISTINCT t.transaction_id) as total_transactions,
        SUM(t.usd_value) as total_volume_usd,
        COUNT(DISTINCT t.token) as unique_tokens_traded,
        MIN(t.timestamp) as first_transaction_date,
        MAX(t.timestamp) as last_transaction_date
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3, 4, 5
)
SELECT * FROM user_metrics
  );
  
[0m09:59:10.790661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m09:59:10.790661 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.790661 [debug] [Thread-1 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */

  
    

  create  table "nca"."marts"."fct_user_retention__dbt_tmp"
  
  
    as
  
  (
    

WITH user_cohorts AS (
    SELECT
        u.user_id,
        DATE_TRUNC('month', u.signup_date) as cohort_month,
        DATE_TRUNC('month', t.timestamp) as activity_month,
        COUNT(DISTINCT t.transaction_id) as transactions,
        SUM(t.amount) as volume
    FROM "nca"."marts"."int_enriched_users" u
    LEFT JOIN "nca"."marts"."int_enriched_transactions" t
        ON u.user_id = t.user_id
    GROUP BY 1, 2, 3
),

cohort_sizes AS (
    SELECT
        cohort_month,
        COUNT(DISTINCT user_id) as cohort_size
    FROM user_cohorts
    GROUP BY 1
),

retention_data AS (
    SELECT
        c.cohort_month,
        c.activity_month,
        COUNT(DISTINCT c.user_id) as active_users,
        cs.cohort_size,
        -- Fix for months_since_signup calculation
        (EXTRACT(YEAR FROM c.activity_month) - EXTRACT(YEAR FROM c.cohort_month)) * 12 +
        (EXTRACT(MONTH FROM c.activity_month) - EXTRACT(MONTH FROM c.cohort_month)) as months_since_signup
    FROM user_cohorts c
    JOIN cohort_sizes cs ON c.cohort_month = cs.cohort_month
    GROUP BY 1, 2, 4, 5
)
SELECT 
    *,
    ROUND(100.0 * active_users / cohort_size, 2) as retention_rate
FROM retention_data
  );
  
[0m09:59:10.853157 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.069 seconds
[0m09:59:10.868785 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.067 seconds
[0m09:59:10.868785 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.868785 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.868785 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics" rename to "fct_user_metrics__dbt_backup"
[0m09:59:10.868785 [debug] [Thread-1 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */
alter table "nca"."marts"."fct_user_retention" rename to "fct_user_retention__dbt_backup"
[0m09:59:10.884407 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.884407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.884407 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.884407 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.900031 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
alter table "nca"."marts"."fct_user_metrics__dbt_tmp" rename to "fct_user_metrics"
[0m09:59:10.900031 [debug] [Thread-1 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */
alter table "nca"."marts"."fct_user_retention__dbt_tmp" rename to "fct_user_retention"
[0m09:59:10.900031 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.900031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:10.900031 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:59:10.900031 [debug] [Thread-1 (]: On model.growth.fct_user_retention: COMMIT
[0m09:59:10.900031 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.900031 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.900031 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: COMMIT
[0m09:59:10.900031 [debug] [Thread-1 (]: On model.growth.fct_user_retention: COMMIT
[0m09:59:10.915655 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.915655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:10.915655 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."fct_user_metrics__dbt_backup"
[0m09:59:10.915655 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."fct_user_retention__dbt_backup"
[0m09:59:10.915655 [debug] [Thread-4 (]: Using postgres connection "model.growth.fct_user_metrics"
[0m09:59:10.931282 [debug] [Thread-1 (]: Using postgres connection "model.growth.fct_user_retention"
[0m09:59:10.931282 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_metrics"} */
drop table if exists "nca"."marts"."fct_user_metrics__dbt_backup" cascade
[0m09:59:10.931282 [debug] [Thread-1 (]: On model.growth.fct_user_retention: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.fct_user_retention"} */
drop table if exists "nca"."marts"."fct_user_retention__dbt_backup" cascade
[0m09:59:10.931282 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:59:10.931282 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:59:10.931282 [debug] [Thread-4 (]: On model.growth.fct_user_metrics: Close
[0m09:59:10.931282 [debug] [Thread-1 (]: On model.growth.fct_user_retention: Close
[0m09:59:10.946905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D6158070>]}
[0m09:59:10.946905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86afee1b-a1f7-40c0-8b9e-c5eaf78cd1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D80B4520>]}
[0m09:59:10.946905 [info ] [Thread-4 (]: 16 of 17 OK created sql table model marts.fct_user_metrics ..................... [[32mSELECT 200[0m in 0.28s]
[0m09:59:10.946905 [debug] [Thread-4 (]: Finished running node model.growth.fct_user_metrics
[0m09:59:10.946905 [info ] [Thread-1 (]: 17 of 17 OK created sql table model marts.fct_user_retention ................... [[32mSELECT 17[0m in 0.27s]
[0m09:59:10.946905 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_retention
[0m09:59:10.946905 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:10.946905 [debug] [MainThread]: On master: BEGIN
[0m09:59:10.946905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:11.025780 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m09:59:11.026775 [debug] [MainThread]: On master: COMMIT
[0m09:59:11.027775 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:11.028776 [debug] [MainThread]: On master: COMMIT
[0m09:59:11.030776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:59:11.031778 [debug] [MainThread]: On master: Close
[0m09:59:11.032777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:11.033776 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:59:11.034777 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:59:11.036780 [debug] [MainThread]: Connection 'model.growth.fct_user_retention' was properly closed.
[0m09:59:11.037776 [debug] [MainThread]: Connection 'model.growth.fct_user_engagement' was properly closed.
[0m09:59:11.038780 [debug] [MainThread]: Connection 'model.growth.fct_transaction_metrics' was properly closed.
[0m09:59:11.038780 [debug] [MainThread]: Connection 'model.growth.fct_user_metrics' was properly closed.
[0m09:59:11.039780 [info ] [MainThread]: 
[0m09:59:11.043633 [info ] [MainThread]: Finished running 7 table models, 10 view models in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m09:59:11.048625 [debug] [MainThread]: Command end result
[0m09:59:11.094888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:59:11.110283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:59:11.110283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:59:11.110283 [info ] [MainThread]: 
[0m09:59:11.127666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:11.129665 [info ] [MainThread]: 
[0m09:59:11.130664 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m09:59:11.133667 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:11.133667 after 4.38 seconds
[0m09:59:11.136446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D42CD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D56088B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D5549C60>]}
[0m09:59:11.138448 [debug] [MainThread]: Flushing usage events
[0m09:59:13.426648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:21.037258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812CA1D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812E8D17B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812E8D15A0>]}


============================== 09:59:21.037258 | 2dfb2fbf-8b3b-4ec0-be90-965c1db64978 ==============================
[0m09:59:21.037258 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:59:21.037258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\musta\\Documents\\GrowthMetrics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:59:21.370995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812B1EF6D0>]}
[0m09:59:21.463150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812E38B940>]}
[0m09:59:21.463150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:21.899750 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:59:22.214862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:22.214862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:22.230490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.growth_metrics.intermediate
- models.growth_metrics.marts
- models.growth_metrics.staging
[0m09:59:22.318914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812F175C90>]}
[0m09:59:22.537655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:59:22.537655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:59:22.584542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812EFE5E10>]}
[0m09:59:22.584542 [info ] [MainThread]: Found 17 models, 29 data tests, 4 sources, 548 macros
[0m09:59:22.601019 [info ] [MainThread]: 
[0m09:59:22.603881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:22.605881 [info ] [MainThread]: 
[0m09:59:22.609242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:22.615238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca'
[0m09:59:22.813394 [debug] [ThreadPool]: Using postgres connection "list_nca"
[0m09:59:22.813394 [debug] [ThreadPool]: On list_nca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca"} */

    select distinct nspname from pg_namespace
  
[0m09:59:22.813394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:22.860255 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m09:59:22.875881 [debug] [ThreadPool]: On list_nca: Close
[0m09:59:22.875881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nca_marts'
[0m09:59:22.891549 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:59:22.891549 [debug] [ThreadPool]: On list_nca_marts: BEGIN
[0m09:59:22.891549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:22.938416 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m09:59:22.938416 [debug] [ThreadPool]: Using postgres connection "list_nca_marts"
[0m09:59:22.938416 [debug] [ThreadPool]: On list_nca_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "list_nca_marts"} */
select
      'nca' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'nca' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m09:59:22.938416 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m09:59:22.938416 [debug] [ThreadPool]: On list_nca_marts: ROLLBACK
[0m09:59:22.938416 [debug] [ThreadPool]: On list_nca_marts: Close
[0m09:59:22.954012 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:22.954012 [debug] [MainThread]: On master: BEGIN
[0m09:59:22.954012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:23.000923 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m09:59:23.000923 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:23.000923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:23.016507 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m09:59:23.016507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812F186FE0>]}
[0m09:59:23.016507 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:23.016507 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:23.016507 [debug] [MainThread]: On master: BEGIN
[0m09:59:23.016507 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:59:23.016507 [debug] [MainThread]: On master: COMMIT
[0m09:59:23.032131 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:23.032131 [debug] [MainThread]: On master: COMMIT
[0m09:59:23.032131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:59:23.032131 [debug] [MainThread]: On master: Close
[0m09:59:23.032131 [debug] [Thread-1 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:59:23.032131 [debug] [Thread-2 (]: Began running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:59:23.032131 [debug] [Thread-3 (]: Began running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:59:23.032131 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:59:23.032131 [info ] [Thread-1 (]: 1 of 46 START test dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [RUN]
[0m09:59:23.032131 [info ] [Thread-2 (]: 2 of 46 START test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [RUN]
[0m09:59:23.032131 [info ] [Thread-3 (]: 3 of 46 START test source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [RUN]
[0m09:59:23.032131 [info ] [Thread-4 (]: 4 of 46 START test source_not_null_staging_market_daily_volume ................. [RUN]
[0m09:59:23.047757 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80'
[0m09:59:23.047757 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700'
[0m09:59:23.047757 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed'
[0m09:59:23.047757 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.growth.source_not_null_staging_market_daily_volume.4634ac9f20'
[0m09:59:23.047757 [debug] [Thread-1 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:59:23.047757 [debug] [Thread-2 (]: Began compiling node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:59:23.047757 [debug] [Thread-3 (]: Began compiling node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:59:23.047757 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:59:23.079183 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:59:23.092198 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:59:23.106506 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:59:23.106506 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:59:23.123059 [debug] [Thread-1 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:59:23.125061 [debug] [Thread-2 (]: Began executing node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:59:23.135056 [debug] [Thread-3 (]: Began executing node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:59:23.144061 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:59:23.145060 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:59:23.148058 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:59:23.151100 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:59:23.154144 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:59:23.154144 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:59:23.154144 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:59:23.154144 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:59:23.154144 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: BEGIN
[0m09:59:23.154144 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: BEGIN
[0m09:59:23.154144 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:59:23.154144 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: BEGIN
[0m09:59:23.154144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:23.154144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:59:23.154144 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: BEGIN
[0m09:59:23.154144 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:59:23.154144 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:59:23.251324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m09:59:23.251324 [debug] [Thread-2 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"
[0m09:59:23.251324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m09:59:23.251324 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        referred_user_id
    from "nca"."staging"."referrals"
    group by referred_user_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m09:59:23.251324 [debug] [Thread-1 (]: Using postgres connection "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"
[0m09:59:23.251324 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m09:59:23.251324 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m09:59:23.266944 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date, token
    from "nca"."staging"."market"
    group by date, token
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m09:59:23.266944 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.266944 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"
[0m09:59:23.266944 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"
[0m09:59:23.266944 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: ROLLBACK
[0m09:59:23.266944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m09:59:23.266944 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_daily_volume.4634ac9f20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_volume
from "nca"."staging"."market"
where daily_volume is null



      
    ) dbt_internal_test
[0m09:59:23.266944 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_type as value_field,
        count(*) as n_records

    from "nca"."staging"."transactions"
    group by transaction_type

)

select *
from all_values
where value_field not in (
    'buy','sell','stake','transfer'
)



      
    ) dbt_internal_test
[0m09:59:23.266944 [debug] [Thread-2 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700: Close
[0m09:59:23.266944 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: ROLLBACK
[0m09:59:23.282571 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.282571 [error] [Thread-2 (]: 2 of 46 FAIL 15 dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id  [[31mFAIL 15[0m in 0.23s]
[0m09:59:23.282571 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:23.282571 [debug] [Thread-1 (]: On test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80: Close
[0m09:59:23.282571 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: ROLLBACK
[0m09:59:23.282571 [debug] [Thread-2 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700
[0m09:59:23.282571 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: ROLLBACK
[0m09:59:23.282571 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_market_daily_volume.4634ac9f20: Close
[0m09:59:23.282571 [error] [Thread-1 (]: 1 of 46 FAIL 156 dbt_utils_source_unique_combination_of_columns_staging_market_date__token  [[31mFAIL 156[0m in 0.23s]
[0m09:59:23.297673 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:59:23.299673 [debug] [Thread-3 (]: On test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed: Close
[0m09:59:23.302711 [debug] [Thread-1 (]: Finished running node test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80
[0m09:59:23.305683 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:59:23.301713 [info ] [Thread-4 (]: 4 of 46 PASS source_not_null_staging_market_daily_volume ....................... [[32mPASS[0m in 0.25s]
[0m09:59:23.308893 [info ] [Thread-2 (]: 5 of 46 START test source_not_null_staging_market_date ......................... [RUN]
[0m09:59:23.310893 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:59:23.312892 [info ] [Thread-3 (]: 3 of 46 PASS source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer  [[32mPASS[0m in 0.26s]
[0m09:59:23.321047 [debug] [Thread-3 (]: Finished running node test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed
[0m09:59:23.314893 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_market_daily_volume.4634ac9f20
[0m09:59:23.314893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id.3fad104700, now test.growth.source_not_null_staging_market_date.57bd65e8f0)
[0m09:59:23.314893 [debug] [Thread-7 (]: Marking all children of 'test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80' to be skipped because of status 'fail'.  Reason: Got 156 results, configured to fail if != 0.
[0m09:59:23.314893 [info ] [Thread-1 (]: 6 of 46 START test source_not_null_staging_market_price ........................ [RUN]
[0m09:59:23.321047 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:59:23.321047 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:59:23.321047 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:59:23.321047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.dbt_utils_source_unique_combination_of_columns_staging_market_date__token.4921616e80, now test.growth.source_not_null_staging_market_price.7a0eea0e50)
[0m09:59:23.330037 [info ] [Thread-3 (]: 7 of 46 START test source_not_null_staging_market_token ........................ [RUN]
[0m09:59:23.331040 [info ] [Thread-4 (]: 8 of 46 START test source_not_null_staging_referrals_referral_date ............. [RUN]
[0m09:59:23.339003 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:59:23.339003 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:59:23.339003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_accepted_values_staging_transactions_transaction_type__buy__sell__stake__transfer.e9591bf7ed, now test.growth.source_not_null_staging_market_token.10cda4e403)
[0m09:59:23.339003 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_daily_volume.4634ac9f20, now test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1)
[0m09:59:23.349586 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:59:23.350584 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:59:23.350584 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:59:23.350584 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:59:23.355793 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:59:23.355793 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:59:23.355793 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:59:23.370827 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:59:23.370827 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:59:23.370827 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:59:23.370827 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:59:23.370827 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:59:23.370827 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:59:23.370827 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: BEGIN
[0m09:59:23.386453 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:59:23.388859 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:59:23.388859 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:59:23.388859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:23.388859 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: BEGIN
[0m09:59:23.388859 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: BEGIN
[0m09:59:23.407913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:23.406909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:23.388859 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:59:23.411910 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: BEGIN
[0m09:59:23.412913 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:23.499483 [debug] [Thread-2 (]: SQL status: BEGIN in 0.104 seconds
[0m09:59:23.499483 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_market_date.57bd65e8f0"
[0m09:59:23.499483 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_date.57bd65e8f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from "nca"."staging"."market"
where date is null



      
    ) dbt_internal_test
[0m09:59:23.499483 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:23.512793 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: ROLLBACK
[0m09:59:23.513323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m09:59:23.514748 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_market_date.57bd65e8f0: Close
[0m09:59:23.515258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.107 seconds
[0m09:59:23.515793 [debug] [Thread-4 (]: SQL status: BEGIN in 0.103 seconds
[0m09:59:23.516857 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_market_price.7a0eea0e50"
[0m09:59:23.519542 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_market_token.10cda4e403"
[0m09:59:23.518499 [info ] [Thread-2 (]: 5 of 46 PASS source_not_null_staging_market_date ............................... [[32mPASS[0m in 0.20s]
[0m09:59:23.522763 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"
[0m09:59:23.523278 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_price.7a0eea0e50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "nca"."staging"."market"
where price is null



      
    ) dbt_internal_test
[0m09:59:23.525120 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_market_token.10cda4e403"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."market"
where token is null



      
    ) dbt_internal_test
[0m09:59:23.526420 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_market_date.57bd65e8f0
[0m09:59:23.527456 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referral_date
from "nca"."staging"."referrals"
where referral_date is null



      
    ) dbt_internal_test
[0m09:59:23.529824 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:59:23.531467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.532481 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:23.535497 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.533763 [info ] [Thread-2 (]: 9 of 46 START test source_not_null_staging_referrals_referred_user_id .......... [RUN]
[0m09:59:23.540021 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: ROLLBACK
[0m09:59:23.543872 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: ROLLBACK
[0m09:59:23.547672 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: ROLLBACK
[0m09:59:23.548953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_date.57bd65e8f0, now test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8)
[0m09:59:23.553614 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:59:23.552039 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_market_token.10cda4e403: Close
[0m09:59:23.553083 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1: Close
[0m09:59:23.550748 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_market_price.7a0eea0e50: Close
[0m09:59:23.568719 [info ] [Thread-3 (]: 7 of 46 PASS source_not_null_staging_market_token .............................. [[32mPASS[0m in 0.23s]
[0m09:59:23.566865 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:59:23.575480 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_market_token.10cda4e403
[0m09:59:23.570477 [info ] [Thread-4 (]: 8 of 46 PASS source_not_null_staging_referrals_referral_date ................... [[32mPASS[0m in 0.23s]
[0m09:59:23.573481 [error] [Thread-1 (]: 6 of 46 FAIL 20 source_not_null_staging_market_price ........................... [[31mFAIL 20[0m in 0.25s]
[0m09:59:23.579061 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:59:23.579061 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1
[0m09:59:23.579061 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:59:23.579061 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_market_price.7a0eea0e50
[0m09:59:23.579061 [info ] [Thread-3 (]: 10 of 46 START test source_not_null_staging_referrals_referrer_user_id ......... [RUN]
[0m09:59:23.588438 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:59:23.596364 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:59:23.596364 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:59:23.596364 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_market_price.7a0eea0e50' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m09:59:23.596364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_token.10cda4e403, now test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964)
[0m09:59:23.596364 [info ] [Thread-4 (]: 11 of 46 START test source_not_null_staging_transactions_amount ................ [RUN]
[0m09:59:23.603011 [info ] [Thread-1 (]: 12 of 46 START test source_not_null_staging_transactions_timestamp ............. [RUN]
[0m09:59:23.608153 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:59:23.608153 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:59:23.608153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referral_date.ccd9f695c1, now test.growth.source_not_null_staging_transactions_amount.a378a55704)
[0m09:59:23.613374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_market_price.7a0eea0e50, now test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea)
[0m09:59:23.614836 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: BEGIN
[0m09:59:23.624724 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:59:23.624724 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:59:23.629942 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:59:23.630455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:23.640547 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:59:23.640547 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:59:23.660683 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:59:23.676000 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:59:23.663738 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:59:23.674162 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:59:23.683001 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:59:23.691490 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:59:23.693320 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:59:23.693320 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:59:23.693320 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: BEGIN
[0m09:59:23.693320 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:59:23.698767 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: BEGIN
[0m09:59:23.700057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:23.701097 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: BEGIN
[0m09:59:23.702835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:23.703350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:23.737273 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m09:59:23.737273 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"
[0m09:59:23.737273 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referred_user_id
from "nca"."staging"."referrals"
where referred_user_id is null



      
    ) dbt_internal_test
[0m09:59:23.737273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.737273 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: ROLLBACK
[0m09:59:23.737273 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8: Close
[0m09:59:23.752900 [info ] [Thread-2 (]: 9 of 46 PASS source_not_null_staging_referrals_referred_user_id ................ [[32mPASS[0m in 0.21s]
[0m09:59:23.752900 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8
[0m09:59:23.759508 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:59:23.759508 [info ] [Thread-2 (]: 13 of 46 START test source_not_null_staging_transactions_token ................. [RUN]
[0m09:59:23.759508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referred_user_id.161f8372a8, now test.growth.source_not_null_staging_transactions_token.df4b284941)
[0m09:59:23.759508 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:59:23.773395 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:59:23.773395 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:59:23.792326 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:59:23.793320 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:59:23.794327 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: BEGIN
[0m09:59:23.795322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:23.797321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m09:59:23.797321 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"
[0m09:59:23.797321 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "nca"."staging"."transactions"
where timestamp is null



      
    ) dbt_internal_test
[0m09:59:23.807996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.809968 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: ROLLBACK
[0m09:59:23.809968 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea: Close
[0m09:59:23.809968 [info ] [Thread-1 (]: 12 of 46 PASS source_not_null_staging_transactions_timestamp ................... [[32mPASS[0m in 0.20s]
[0m09:59:23.809968 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea
[0m09:59:23.809968 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:59:23.809968 [info ] [Thread-1 (]: 14 of 46 START test source_not_null_staging_transactions_transaction_id ........ [RUN]
[0m09:59:23.822723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_timestamp.aac59d9eea, now test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c)
[0m09:59:23.824726 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:59:23.827016 [debug] [Thread-3 (]: SQL status: BEGIN in 0.127 seconds
[0m09:59:23.841766 [debug] [Thread-4 (]: SQL status: BEGIN in 0.135 seconds
[0m09:59:23.841766 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"
[0m09:59:23.845635 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:59:23.846635 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_amount.a378a55704"
[0m09:59:23.848634 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select referrer_user_id
from "nca"."staging"."referrals"
where referrer_user_id is null



      
    ) dbt_internal_test
[0m09:59:23.849634 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_amount.a378a55704"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "nca"."staging"."transactions"
where amount is null



      
    ) dbt_internal_test
[0m09:59:23.850686 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:23.858028 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: ROLLBACK
[0m09:59:23.859029 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m09:59:23.860667 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964: Close
[0m09:59:23.860667 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: ROLLBACK
[0m09:59:23.860667 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:59:23.860667 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_amount.a378a55704: Close
[0m09:59:23.860667 [error] [Thread-3 (]: 10 of 46 FAIL 5 source_not_null_staging_referrals_referrer_user_id ............. [[31mFAIL 5[0m in 0.26s]
[0m09:59:23.873969 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:59:23.873969 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964
[0m09:59:23.873969 [error] [Thread-4 (]: 11 of 46 FAIL 15 source_not_null_staging_transactions_amount ................... [[31mFAIL 15[0m in 0.27s]
[0m09:59:23.885909 [debug] [Thread-3 (]: Began running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:59:23.889910 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_amount.a378a55704
[0m09:59:23.891475 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964' to be skipped because of status 'fail'.  Reason: Got 5 results, configured to fail if != 0.
[0m09:59:23.891475 [info ] [Thread-3 (]: 15 of 46 START test source_not_null_staging_transactions_transaction_type ...... [RUN]
[0m09:59:23.891475 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:59:23.891475 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:59:23.891475 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_not_null_staging_transactions_amount.a378a55704' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:59:23.891475 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_referrals_referrer_user_id.f257b6b964, now test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9)
[0m09:59:23.891475 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: BEGIN
[0m09:59:23.891475 [info ] [Thread-4 (]: 16 of 46 START test source_not_null_staging_transactions_user_id ............... [RUN]
[0m09:59:23.909562 [debug] [Thread-3 (]: Began compiling node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:59:23.911560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:23.912561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_amount.a378a55704, now test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05)
[0m09:59:23.923755 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:59:23.927014 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:59:23.928014 [debug] [Thread-2 (]: SQL status: BEGIN in 0.132 seconds
[0m09:59:23.941056 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:59:23.941056 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_token.df4b284941"
[0m09:59:23.941056 [debug] [Thread-3 (]: Began executing node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:59:23.941056 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_token.df4b284941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select token
from "nca"."staging"."transactions"
where token is null



      
    ) dbt_internal_test
[0m09:59:23.941056 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:59:23.956113 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:59:23.957435 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:59:23.957435 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m09:59:23.957435 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: ROLLBACK
[0m09:59:23.972779 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_transactions_token.df4b284941: Close
[0m09:59:23.976778 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:59:23.974779 [info ] [Thread-2 (]: 13 of 46 PASS source_not_null_staging_transactions_token ....................... [[32mPASS[0m in 0.22s]
[0m09:59:23.957435 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:59:23.977777 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: BEGIN
[0m09:59:23.979780 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_transactions_token.df4b284941
[0m09:59:23.981777 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: BEGIN
[0m09:59:23.982778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:23.983778 [debug] [Thread-2 (]: Began running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:59:23.984777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:23.986782 [info ] [Thread-2 (]: 17 of 46 START test source_not_null_staging_users_country ...................... [RUN]
[0m09:59:23.991071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_token.df4b284941, now test.growth.source_not_null_staging_users_country.249761b7a2)
[0m09:59:23.993237 [debug] [Thread-2 (]: Began compiling node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:59:24.005322 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:59:24.007438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m09:59:24.007438 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"
[0m09:59:24.007438 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "nca"."staging"."transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m09:59:24.007438 [debug] [Thread-2 (]: Began executing node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:59:24.007438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:24.024008 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:59:24.024008 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: ROLLBACK
[0m09:59:24.024008 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c: Close
[0m09:59:24.024008 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:59:24.024008 [info ] [Thread-1 (]: 14 of 46 PASS source_not_null_staging_transactions_transaction_id .............. [[32mPASS[0m in 0.20s]
[0m09:59:24.038492 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c
[0m09:59:24.024008 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: BEGIN
[0m09:59:24.040490 [debug] [Thread-1 (]: Began running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:59:24.042490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:24.043492 [info ] [Thread-1 (]: 18 of 46 START test source_not_null_staging_users_signup_date .................. [RUN]
[0m09:59:24.047348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_id.2ce8b0dc9c, now test.growth.source_not_null_staging_users_signup_date.99252fe0aa)
[0m09:59:24.047348 [debug] [Thread-1 (]: Began compiling node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:59:24.061707 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:59:24.063709 [debug] [Thread-1 (]: Began executing node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:59:24.074161 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:59:24.077986 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:59:24.078987 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: BEGIN
[0m09:59:24.079985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:24.092868 [debug] [Thread-4 (]: SQL status: BEGIN in 0.110 seconds
[0m09:59:24.092868 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"
[0m09:59:24.092868 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."transactions"
where user_id is null



      
    ) dbt_internal_test
[0m09:59:24.108604 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m09:59:24.108604 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: ROLLBACK
[0m09:59:24.108604 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05: Close
[0m09:59:24.108604 [info ] [Thread-4 (]: 16 of 46 PASS source_not_null_staging_transactions_user_id ..................... [[32mPASS[0m in 0.20s]
[0m09:59:24.123986 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05
[0m09:59:24.125987 [debug] [Thread-4 (]: Began running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:59:24.126987 [info ] [Thread-4 (]: 19 of 46 START test source_not_null_staging_users_user_id ...................... [RUN]
[0m09:59:24.140872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_user_id.6aa33b9d05, now test.growth.source_not_null_staging_users_user_id.8a5fff93d9)
[0m09:59:24.143216 [debug] [Thread-4 (]: Began compiling node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:59:24.153221 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:59:24.156401 [debug] [Thread-4 (]: Began executing node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:59:24.165153 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:59:24.165153 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:59:24.170984 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: BEGIN
[0m09:59:24.173984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:24.216394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.234 seconds
[0m09:59:24.218385 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"
[0m09:59:24.219389 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_type
from "nca"."staging"."transactions"
where transaction_type is null



      
    ) dbt_internal_test
[0m09:59:24.223584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:24.226586 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: ROLLBACK
[0m09:59:24.228584 [debug] [Thread-3 (]: On test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9: Close
[0m09:59:24.230590 [info ] [Thread-3 (]: 15 of 46 PASS source_not_null_staging_transactions_transaction_type ............ [[32mPASS[0m in 0.34s]
[0m09:59:24.233582 [debug] [Thread-3 (]: Finished running node test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9
[0m09:59:24.234594 [debug] [Thread-3 (]: Began running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:59:24.235585 [info ] [Thread-3 (]: 20 of 46 START test source_positive_value_staging_market_daily_volume .......... [RUN]
[0m09:59:24.237634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_transactions_transaction_type.defbd03fd9, now test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd)
[0m09:59:24.237634 [debug] [Thread-3 (]: Began compiling node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:59:24.246119 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:59:24.257481 [debug] [Thread-3 (]: Began executing node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:59:24.262858 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:59:24.262858 [debug] [Thread-2 (]: SQL status: BEGIN in 0.225 seconds
[0m09:59:24.262858 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_not_null_staging_users_country.249761b7a2"
[0m09:59:24.262858 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_country.249761b7a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "nca"."staging"."users"
where country is null



      
    ) dbt_internal_test
[0m09:59:24.275170 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:24.276284 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: ROLLBACK
[0m09:59:24.276284 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:59:24.276284 [debug] [Thread-2 (]: On test.growth.source_not_null_staging_users_country.249761b7a2: Close
[0m09:59:24.276284 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: BEGIN
[0m09:59:24.276284 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:24.276284 [info ] [Thread-2 (]: 17 of 46 PASS source_not_null_staging_users_country ............................ [[32mPASS[0m in 0.29s]
[0m09:59:24.288871 [debug] [Thread-2 (]: Finished running node test.growth.source_not_null_staging_users_country.249761b7a2
[0m09:59:24.290866 [debug] [Thread-2 (]: Began running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:59:24.291865 [info ] [Thread-2 (]: 21 of 46 START test source_positive_value_staging_market_price ................. [RUN]
[0m09:59:24.293865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_country.249761b7a2, now test.growth.source_positive_value_staging_market_price.1ee4a4b889)
[0m09:59:24.296103 [debug] [Thread-2 (]: Began compiling node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:59:24.309599 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:59:24.312603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.139 seconds
[0m09:59:24.313602 [debug] [Thread-2 (]: Began executing node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:59:24.314605 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"
[0m09:59:24.325783 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:59:24.325783 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_user_id.8a5fff93d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "nca"."staging"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:59:24.325783 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:59:24.325783 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:59:24.325783 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: BEGIN
[0m09:59:24.325783 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: ROLLBACK
[0m09:59:24.341091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:24.342089 [debug] [Thread-4 (]: On test.growth.source_not_null_staging_users_user_id.8a5fff93d9: Close
[0m09:59:24.342089 [info ] [Thread-4 (]: 19 of 46 PASS source_not_null_staging_users_user_id ............................ [[32mPASS[0m in 0.20s]
[0m09:59:24.342089 [debug] [Thread-4 (]: Finished running node test.growth.source_not_null_staging_users_user_id.8a5fff93d9
[0m09:59:24.342089 [debug] [Thread-4 (]: Began running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:59:24.342089 [info ] [Thread-4 (]: 22 of 46 START test source_positive_value_staging_transactions_amount .......... [RUN]
[0m09:59:24.342089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_user_id.8a5fff93d9, now test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8)
[0m09:59:24.358783 [debug] [Thread-4 (]: Began compiling node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:59:24.374736 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:59:24.376739 [debug] [Thread-4 (]: Began executing node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:59:24.379737 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:59:24.391856 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:59:24.392571 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: BEGIN
[0m09:59:24.392571 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:24.392571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m09:59:24.392571 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"
[0m09:59:24.392571 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        daily_volume as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:59:24.406660 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:24.409041 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: ROLLBACK
[0m09:59:24.409041 [debug] [Thread-3 (]: On test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd: Close
[0m09:59:24.409041 [info ] [Thread-3 (]: 20 of 46 PASS source_positive_value_staging_market_daily_volume ................ [[32mPASS[0m in 0.17s]
[0m09:59:24.409041 [debug] [Thread-3 (]: Finished running node test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd
[0m09:59:24.409041 [debug] [Thread-3 (]: Began running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:59:24.409041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.342 seconds
[0m09:59:24.409041 [info ] [Thread-3 (]: 23 of 46 START test source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [RUN]
[0m09:59:24.423346 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"
[0m09:59:24.425345 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_daily_volume.2c84faa8fd, now test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257)
[0m09:59:24.427348 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_not_null_staging_users_signup_date.99252fe0aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select signup_date
from "nca"."staging"."users"
where signup_date is null



      
    ) dbt_internal_test
[0m09:59:24.428425 [debug] [Thread-3 (]: Began compiling node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:59:24.440755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m09:59:24.459397 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: ROLLBACK
[0m09:59:24.459397 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:59:24.459397 [debug] [Thread-1 (]: On test.growth.source_not_null_staging_users_signup_date.99252fe0aa: Close
[0m09:59:24.459397 [debug] [Thread-2 (]: SQL status: BEGIN in 0.124 seconds
[0m09:59:24.459397 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_positive_value_staging_market_price.1ee4a4b889"
[0m09:59:24.459397 [info ] [Thread-1 (]: 18 of 46 PASS source_not_null_staging_users_signup_date ........................ [[32mPASS[0m in 0.41s]
[0m09:59:24.459397 [debug] [Thread-3 (]: Began executing node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:59:24.474653 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_market_price.1ee4a4b889"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        price as value_to_check
    from "nca"."staging"."market"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:59:24.477335 [debug] [Thread-1 (]: Finished running node test.growth.source_not_null_staging_users_signup_date.99252fe0aa
[0m09:59:24.482334 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:59:24.482334 [debug] [Thread-1 (]: Began running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:59:24.491945 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m09:59:24.492915 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: ROLLBACK
[0m09:59:24.490942 [info ] [Thread-1 (]: 24 of 46 START test source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [RUN]
[0m09:59:24.492915 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:59:24.492915 [debug] [Thread-2 (]: On test.growth.source_positive_value_staging_market_price.1ee4a4b889: Close
[0m09:59:24.492915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_not_null_staging_users_signup_date.99252fe0aa, now test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e)
[0m09:59:24.492915 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: BEGIN
[0m09:59:24.492915 [debug] [Thread-4 (]: SQL status: BEGIN in 0.107 seconds
[0m09:59:24.492915 [error] [Thread-2 (]: 21 of 46 FAIL 20 source_positive_value_staging_market_price .................... [[31mFAIL 20[0m in 0.20s]
[0m09:59:24.508601 [debug] [Thread-1 (]: Began compiling node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:59:24.509047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:24.509047 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"
[0m09:59:24.509047 [debug] [Thread-2 (]: Finished running node test.growth.source_positive_value_staging_market_price.1ee4a4b889
[0m09:59:24.509047 [debug] [Thread-2 (]: Began running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:59:24.509047 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (
    select
        amount as value_to_check
    from "nca"."staging"."transactions"
),

validation_errors as (
    select
        value_to_check
    from validation
    where value_to_check <= 0
        or value_to_check is null
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:59:24.509047 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:59:24.527662 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_market_price.1ee4a4b889' to be skipped because of status 'fail'.  Reason: Got 20 results, configured to fail if != 0.
[0m09:59:24.524440 [info ] [Thread-2 (]: 25 of 46 START test source_relationships_staging_transactions_token__token__source_staging_market_  [RUN]
[0m09:59:24.529658 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:59:24.531716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_market_price.1ee4a4b889, now test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be)
[0m09:59:24.538059 [debug] [Thread-2 (]: Began compiling node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:59:24.531716 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: ROLLBACK
[0m09:59:24.531716 [debug] [Thread-1 (]: Began executing node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:59:24.550600 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:59:24.550600 [debug] [Thread-4 (]: On test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8: Close
[0m09:59:24.558834 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:59:24.558834 [debug] [Thread-2 (]: Began executing node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:59:24.558834 [error] [Thread-4 (]: 22 of 46 FAIL 15 source_positive_value_staging_transactions_amount ............. [[31mFAIL 15[0m in 0.22s]
[0m09:59:24.576189 [debug] [Thread-4 (]: Finished running node test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8
[0m09:59:24.582183 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:59:24.582183 [debug] [Thread-4 (]: Began running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:59:24.582183 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8' to be skipped because of status 'fail'.  Reason: Got 15 results, configured to fail if != 0.
[0m09:59:24.582183 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:59:24.582183 [info ] [Thread-4 (]: 26 of 46 START test source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [RUN]
[0m09:59:24.590064 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:59:24.594343 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: BEGIN
[0m09:59:24.595342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_positive_value_staging_transactions_amount.5afaa41ab8, now test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4)
[0m09:59:24.596343 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: BEGIN
[0m09:59:24.597341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:24.598341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m09:59:24.599340 [debug] [Thread-4 (]: Began compiling node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:59:24.599340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:24.599340 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"
[0m09:59:24.608755 [debug] [Thread-4 (]: Writing injected SQL for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:59:24.608755 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referred_user_id as from_field
    from "nca"."staging"."referrals"
    where referred_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:59:24.623474 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:59:24.625430 [debug] [Thread-4 (]: Began executing node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:59:24.625430 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: ROLLBACK
[0m09:59:24.640402 [debug] [Thread-3 (]: On test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257: Close
[0m09:59:24.625430 [debug] [Thread-4 (]: Writing runtime sql for node "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:59:24.642401 [info ] [Thread-3 (]: 23 of 46 PASS source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.22s]
[0m09:59:24.646403 [debug] [Thread-3 (]: Finished running node test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257
[0m09:59:24.647400 [debug] [Thread-3 (]: Began running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:59:24.648401 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:59:24.651400 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: BEGIN
[0m09:59:24.650401 [info ] [Thread-3 (]: 27 of 46 START test source_unique_staging_transactions_transaction_id .......... [RUN]
[0m09:59:24.655406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referred_user_id__user_id__source_staging_users_.9c51622257, now test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1)
[0m09:59:24.653400 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:24.656406 [debug] [Thread-3 (]: Began compiling node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:59:24.677790 [debug] [Thread-3 (]: Writing injected SQL for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:59:24.679788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m09:59:24.680791 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"
[0m09:59:24.680791 [debug] [Thread-3 (]: Began executing node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:59:24.680791 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select referrer_user_id as from_field
    from "nca"."staging"."referrals"
    where referrer_user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:59:24.692469 [debug] [Thread-3 (]: Writing runtime sql for node "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:59:24.692469 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m09:59:24.692469 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: ROLLBACK
[0m09:59:24.692469 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:59:24.692469 [debug] [Thread-1 (]: On test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e: Close
[0m09:59:24.692469 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: BEGIN
[0m09:59:24.709063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:59:24.705926 [info ] [Thread-1 (]: 24 of 46 PASS source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.21s]
[0m09:59:24.709063 [debug] [Thread-1 (]: Finished running node test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e
[0m09:59:24.709063 [debug] [Thread-1 (]: Began running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:59:24.709063 [info ] [Thread-1 (]: 28 of 46 START test source_unique_staging_users_referral_code .................. [RUN]
[0m09:59:24.725684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.125 seconds
[0m09:59:24.726683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_referrals_referrer_user_id__user_id__source_staging_users_.4486d99a7e, now test.growth.source_unique_staging_users_referral_code.184becf50f)
[0m09:59:24.727683 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"
[0m09:59:24.729634 [debug] [Thread-1 (]: Began compiling node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:59:24.731683 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select token as from_field
    from "nca"."staging"."transactions"
    where token is not null
),

parent as (
    select token as to_field
    from "nca"."staging"."market"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:59:24.749455 [debug] [Thread-1 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:59:24.749455 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m09:59:24.756948 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m09:59:24.759514 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: ROLLBACK
[0m09:59:24.759514 [debug] [Thread-4 (]: Using postgres connection "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"
[0m09:59:24.759514 [debug] [Thread-1 (]: Began executing node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:59:24.759514 [debug] [Thread-2 (]: On test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be: Close
[0m09:59:24.759514 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "nca"."staging"."transactions"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "nca"."staging"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:59:24.774341 [debug] [Thread-1 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:59:24.774341 [info ] [Thread-2 (]: 25 of 46 PASS source_relationships_staging_transactions_token__token__source_staging_market_  [[32mPASS[0m in 0.24s]
[0m09:59:24.774341 [debug] [Thread-2 (]: Finished running node test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be
[0m09:59:24.774341 [debug] [Thread-2 (]: Began running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:59:24.774341 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:59:24.774341 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:59:24.774341 [info ] [Thread-2 (]: 29 of 46 START test source_unique_staging_users_user_id ........................ [RUN]
[0m09:59:24.790183 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: ROLLBACK
[0m09:59:24.792182 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: BEGIN
[0m09:59:24.793686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_token__token__source_staging_market_.62b5f762be, now test.growth.source_unique_staging_users_user_id.a057d0d5ff)
[0m09:59:24.793686 [debug] [Thread-4 (]: On test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4: Close
[0m09:59:24.793686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:24.793686 [debug] [Thread-2 (]: Began compiling node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:59:24.793686 [info ] [Thread-4 (]: 26 of 46 PASS source_relationships_staging_transactions_user_id__user_id__source_staging_users_  [[32mPASS[0m in 0.20s]
[0m09:59:24.809679 [debug] [Thread-4 (]: Finished running node test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4
[0m09:59:24.809679 [debug] [Thread-2 (]: Writing injected SQL for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:59:24.809679 [debug] [Thread-4 (]: Began running node model.growth.stg_referrals
[0m09:59:24.821631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m09:59:24.827988 [debug] [Thread-3 (]: Using postgres connection "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"
[0m09:59:24.825686 [info ] [Thread-4 (]: 30 of 46 SKIP relation marts.stg_referrals ..................................... [[33mSKIP[0m]
[0m09:59:24.829990 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "nca"."staging"."transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:59:24.830983 [debug] [Thread-2 (]: Began executing node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:59:24.831984 [debug] [Thread-4 (]: Finished running node model.growth.stg_referrals
[0m09:59:24.843675 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m09:59:24.845678 [debug] [Thread-2 (]: Writing runtime sql for node "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:59:24.847676 [debug] [Thread-4 (]: Began running node model.growth.stg_market
[0m09:59:24.848688 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: ROLLBACK
[0m09:59:24.848688 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_referrals' to be skipped because of status 'skipped'. 
[0m09:59:24.848688 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:59:24.856986 [debug] [Thread-3 (]: On test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1: Close
[0m09:59:24.848688 [info ] [Thread-4 (]: 31 of 46 SKIP relation marts.stg_market ........................................ [[33mSKIP[0m]
[0m09:59:24.860536 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: BEGIN
[0m09:59:24.863526 [debug] [Thread-4 (]: Finished running node model.growth.stg_market
[0m09:59:24.862525 [error] [Thread-3 (]: 27 of 46 FAIL 10 source_unique_staging_transactions_transaction_id ............. [[31mFAIL 10[0m in 0.21s]
[0m09:59:24.865523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:24.866525 [debug] [Thread-4 (]: Began running node model.growth.dim_referrals
[0m09:59:24.866525 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_market' to be skipped because of status 'skipped'. 
[0m09:59:24.866525 [debug] [Thread-3 (]: Finished running node test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1
[0m09:59:24.875669 [info ] [Thread-4 (]: 32 of 46 SKIP relation marts.dim_referrals ..................................... [[33mSKIP[0m]
[0m09:59:24.879447 [debug] [Thread-3 (]: Began running node model.growth.dim_market
[0m09:59:24.881445 [debug] [Thread-7 (]: Marking all children of 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' to be skipped because of status 'fail'.  Reason: Got 10 results, configured to fail if != 0.
[0m09:59:24.881445 [debug] [Thread-4 (]: Finished running node model.growth.dim_referrals
[0m09:59:24.881445 [info ] [Thread-3 (]: 33 of 46 SKIP relation marts.dim_market ........................................ [[33mSKIP[0m]
[0m09:59:24.886785 [debug] [Thread-4 (]: Began running node model.growth.stg_transactions
[0m09:59:24.889786 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_referrals' to be skipped because of status 'skipped'. 
[0m09:59:24.891784 [debug] [Thread-3 (]: Finished running node model.growth.dim_market
[0m09:59:24.892785 [info ] [Thread-4 (]: 34 of 46 SKIP relation marts.stg_transactions .................................. [[33mSKIP[0m]
[0m09:59:24.892785 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_market' to be skipped because of status 'skipped'. 
[0m09:59:24.892785 [debug] [Thread-4 (]: Finished running node model.growth.stg_transactions
[0m09:59:24.892785 [debug] [Thread-7 (]: Marking all children of 'model.growth.stg_transactions' to be skipped because of status 'skipped'. 
[0m09:59:24.892785 [debug] [Thread-3 (]: Began running node model.growth.dim_transactions
[0m09:59:24.892785 [info ] [Thread-3 (]: 35 of 46 SKIP relation marts.dim_transactions .................................. [[33mSKIP[0m]
[0m09:59:24.908107 [debug] [Thread-3 (]: Finished running node model.growth.dim_transactions
[0m09:59:24.910218 [debug] [Thread-7 (]: Marking all children of 'model.growth.dim_transactions' to be skipped because of status 'skipped'. 
[0m09:59:24.912739 [debug] [Thread-4 (]: Began running node model.growth.int_enriched_transactions
[0m09:59:24.912739 [info ] [Thread-4 (]: 36 of 46 SKIP relation marts.int_enriched_transactions ......................... [[33mSKIP[0m]
[0m09:59:24.916530 [debug] [Thread-4 (]: Finished running node model.growth.int_enriched_transactions
[0m09:59:24.917530 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_transactions' to be skipped because of status 'skipped'. 
[0m09:59:24.919526 [debug] [Thread-3 (]: Began running node model.growth.fct_referrals_performance
[0m09:59:24.925528 [debug] [Thread-4 (]: Began running node model.growth.fct_token_metrics
[0m09:59:24.920528 [info ] [Thread-3 (]: 37 of 46 SKIP relation marts.fct_referrals_performance ......................... [[33mSKIP[0m]
[0m09:59:24.927227 [info ] [Thread-4 (]: 38 of 46 SKIP relation marts.fct_token_metrics ................................. [[33mSKIP[0m]
[0m09:59:24.927227 [debug] [Thread-3 (]: Finished running node model.growth.fct_referrals_performance
[0m09:59:24.927227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.135 seconds
[0m09:59:24.927227 [debug] [Thread-4 (]: Finished running node model.growth.fct_token_metrics
[0m09:59:24.927227 [debug] [Thread-3 (]: Began running node model.growth.fct_transaction_metrics
[0m09:59:24.927227 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_referrals_performance' to be skipped because of status 'skipped'. 
[0m09:59:24.927227 [debug] [Thread-1 (]: Using postgres connection "test.growth.source_unique_staging_users_referral_code.184becf50f"
[0m09:59:24.941512 [info ] [Thread-3 (]: 39 of 46 SKIP relation marts.fct_transaction_metrics ........................... [[33mSKIP[0m]
[0m09:59:24.944119 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_token_metrics' to be skipped because of status 'skipped'. 
[0m09:59:24.945115 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_referral_code.184becf50f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    referral_code as unique_field,
    count(*) as n_records

from (select * from "nca"."staging"."users" where referral_code is not null) dbt_subquery
where referral_code is not null
group by referral_code
having count(*) > 1



      
    ) dbt_internal_test
[0m09:59:24.946119 [debug] [Thread-3 (]: Finished running node model.growth.fct_transaction_metrics
[0m09:59:24.949118 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_transaction_metrics' to be skipped because of status 'skipped'. 
[0m09:59:24.949118 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:24.955152 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: ROLLBACK
[0m09:59:24.957154 [debug] [Thread-1 (]: On test.growth.source_unique_staging_users_referral_code.184becf50f: Close
[0m09:59:24.960281 [info ] [Thread-1 (]: 28 of 46 PASS source_unique_staging_users_referral_code ........................ [[32mPASS[0m in 0.23s]
[0m09:59:24.963284 [debug] [Thread-1 (]: Finished running node test.growth.source_unique_staging_users_referral_code.184becf50f
[0m09:59:24.982586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m09:59:24.982586 [debug] [Thread-2 (]: Using postgres connection "test.growth.source_unique_staging_users_user_id.a057d0d5ff"
[0m09:59:24.982586 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "test.growth.source_unique_staging_users_user_id.a057d0d5ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "nca"."staging"."users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:59:24.991492 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:59:24.992479 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: ROLLBACK
[0m09:59:24.992479 [debug] [Thread-2 (]: On test.growth.source_unique_staging_users_user_id.a057d0d5ff: Close
[0m09:59:24.992479 [info ] [Thread-2 (]: 29 of 46 PASS source_unique_staging_users_user_id .............................. [[32mPASS[0m in 0.20s]
[0m09:59:24.992479 [debug] [Thread-2 (]: Finished running node test.growth.source_unique_staging_users_user_id.a057d0d5ff
[0m09:59:24.992479 [debug] [Thread-4 (]: Began running node model.growth.stg_users
[0m09:59:25.007131 [info ] [Thread-4 (]: 40 of 46 START sql view model marts.stg_users .................................. [RUN]
[0m09:59:25.009918 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.growth.source_relationships_staging_transactions_user_id__user_id__source_staging_users_.17c70586e4, now model.growth.stg_users)
[0m09:59:25.011916 [debug] [Thread-4 (]: Began compiling node model.growth.stg_users
[0m09:59:25.014969 [debug] [Thread-4 (]: Writing injected SQL for node "model.growth.stg_users"
[0m09:59:25.014969 [debug] [Thread-4 (]: Began executing node model.growth.stg_users
[0m09:59:25.074505 [debug] [Thread-4 (]: Writing runtime sql for node "model.growth.stg_users"
[0m09:59:25.090868 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.091868 [debug] [Thread-4 (]: On model.growth.stg_users: BEGIN
[0m09:59:25.092867 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:59:25.139240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m09:59:25.139240 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.139240 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */

  create view "nca"."marts"."stg_users__dbt_tmp"
    
    
  as (
    

WITH source AS (
    SELECT * FROM "nca"."staging"."users"
)
SELECT
    user_id,
    signup_date,
    country,
    referral_code
FROM source
  );
[0m09:59:25.139240 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:59:25.217361 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.232989 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users" rename to "stg_users__dbt_backup"
[0m09:59:25.232989 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:25.232989 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.232989 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
alter table "nca"."marts"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:59:25.232989 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:25.264234 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:59:25.264234 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.279859 [debug] [Thread-4 (]: On model.growth.stg_users: COMMIT
[0m09:59:25.279859 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:25.279859 [debug] [Thread-4 (]: Applying DROP to: "nca"."marts"."stg_users__dbt_backup"
[0m09:59:25.295492 [debug] [Thread-4 (]: Using postgres connection "model.growth.stg_users"
[0m09:59:25.295492 [debug] [Thread-4 (]: On model.growth.stg_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.stg_users"} */
drop view if exists "nca"."marts"."stg_users__dbt_backup" cascade
[0m09:59:25.295492 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:59:25.312004 [debug] [Thread-4 (]: On model.growth.stg_users: Close
[0m09:59:25.312004 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812FA65360>]}
[0m09:59:25.312004 [info ] [Thread-4 (]: 40 of 46 OK created sql view model marts.stg_users ............................. [[32mCREATE VIEW[0m in 0.30s]
[0m09:59:25.312004 [debug] [Thread-4 (]: Finished running node model.growth.stg_users
[0m09:59:25.323295 [debug] [Thread-1 (]: Began running node model.growth.dim_users
[0m09:59:25.324294 [debug] [Thread-2 (]: Began running node model.growth.fct_users_acquisition
[0m09:59:25.325292 [info ] [Thread-1 (]: 41 of 46 START sql view model marts.dim_users .................................. [RUN]
[0m09:59:25.326294 [info ] [Thread-2 (]: 42 of 46 SKIP relation marts.fct_users_acquisition ............................. [[33mSKIP[0m]
[0m09:59:25.328134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.growth.source_unique_staging_users_referral_code.184becf50f, now model.growth.dim_users)
[0m09:59:25.329947 [debug] [Thread-2 (]: Finished running node model.growth.fct_users_acquisition
[0m09:59:25.331950 [debug] [Thread-1 (]: Began compiling node model.growth.dim_users
[0m09:59:25.332947 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_users_acquisition' to be skipped because of status 'skipped'. 
[0m09:59:25.344221 [debug] [Thread-1 (]: Writing injected SQL for node "model.growth.dim_users"
[0m09:59:25.346200 [debug] [Thread-1 (]: Began executing node model.growth.dim_users
[0m09:59:25.356529 [debug] [Thread-1 (]: Writing runtime sql for node "model.growth.dim_users"
[0m09:59:25.358817 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:25.358817 [debug] [Thread-1 (]: On model.growth.dim_users: BEGIN
[0m09:59:25.358817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:25.423980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m09:59:25.423980 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:25.423980 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */

  create view "nca"."marts"."dim_users__dbt_tmp"
    
    
  as (
    

WITH cleaned_users AS (
    SELECT
        user_id,
        signup_date,
        TRIM(LOWER(country)) as country,
        COALESCE(referral_code, 'no_referral') as referral_code
    FROM "nca"."marts"."stg_users"
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_users
  );
[0m09:59:25.423980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:59:25.439602 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:25.439602 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
alter table "nca"."marts"."dim_users__dbt_tmp" rename to "dim_users"
[0m09:59:25.439602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:25.439602 [debug] [Thread-1 (]: On model.growth.dim_users: COMMIT
[0m09:59:25.439602 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:25.439602 [debug] [Thread-1 (]: On model.growth.dim_users: COMMIT
[0m09:59:25.439602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:25.455227 [debug] [Thread-1 (]: Applying DROP to: "nca"."marts"."dim_users__dbt_backup"
[0m09:59:25.455227 [debug] [Thread-1 (]: Using postgres connection "model.growth.dim_users"
[0m09:59:25.455227 [debug] [Thread-1 (]: On model.growth.dim_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "growth", "target_name": "dev", "node_id": "model.growth.dim_users"} */
drop view if exists "nca"."marts"."dim_users__dbt_backup" cascade
[0m09:59:25.455227 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:59:25.455227 [debug] [Thread-1 (]: On model.growth.dim_users: Close
[0m09:59:25.455227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfb2fbf-8b3b-4ec0-be90-965c1db64978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812FA8BC40>]}
[0m09:59:25.455227 [info ] [Thread-1 (]: 41 of 46 OK created sql view model marts.dim_users ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m09:59:25.470849 [debug] [Thread-1 (]: Finished running node model.growth.dim_users
[0m09:59:25.470849 [debug] [Thread-4 (]: Began running node model.growth.int_enriched_users
[0m09:59:25.470849 [info ] [Thread-4 (]: 43 of 46 SKIP relation marts.int_enriched_users ................................ [[33mSKIP[0m]
[0m09:59:25.476747 [debug] [Thread-4 (]: Finished running node model.growth.int_enriched_users
[0m09:59:25.478154 [debug] [Thread-7 (]: Marking all children of 'model.growth.int_enriched_users' to be skipped because of status 'skipped'. 
[0m09:59:25.480125 [debug] [Thread-2 (]: Began running node model.growth.fct_user_engagement
[0m09:59:25.481127 [debug] [Thread-1 (]: Began running node model.growth.fct_user_metrics
[0m09:59:25.481127 [debug] [Thread-3 (]: Began running node model.growth.fct_user_retention
[0m09:59:25.482127 [info ] [Thread-2 (]: 44 of 46 SKIP relation marts.fct_user_engagement ............................... [[33mSKIP[0m]
[0m09:59:25.482127 [info ] [Thread-1 (]: 45 of 46 SKIP relation marts.fct_user_metrics .................................. [[33mSKIP[0m]
[0m09:59:25.486833 [debug] [Thread-2 (]: Finished running node model.growth.fct_user_engagement
[0m09:59:25.485832 [info ] [Thread-3 (]: 46 of 46 SKIP relation marts.fct_user_retention ................................ [[33mSKIP[0m]
[0m09:59:25.487832 [debug] [Thread-1 (]: Finished running node model.growth.fct_user_metrics
[0m09:59:25.487832 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_engagement' to be skipped because of status 'skipped'. 
[0m09:59:25.491836 [debug] [Thread-3 (]: Finished running node model.growth.fct_user_retention
[0m09:59:25.493834 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_metrics' to be skipped because of status 'skipped'. 
[0m09:59:25.496886 [debug] [Thread-7 (]: Marking all children of 'model.growth.fct_user_retention' to be skipped because of status 'skipped'. 
[0m09:59:25.498878 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:25.499879 [debug] [MainThread]: On master: BEGIN
[0m09:59:25.500883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:25.559972 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m09:59:25.560973 [debug] [MainThread]: On master: COMMIT
[0m09:59:25.561971 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:25.562970 [debug] [MainThread]: On master: COMMIT
[0m09:59:25.562970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:59:25.563970 [debug] [MainThread]: On master: Close
[0m09:59:25.564970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:25.565970 [debug] [MainThread]: Connection 'list_nca' was properly closed.
[0m09:59:25.566970 [debug] [MainThread]: Connection 'list_nca_marts' was properly closed.
[0m09:59:25.568973 [debug] [MainThread]: Connection 'model.growth.dim_users' was properly closed.
[0m09:59:25.569971 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_users_user_id.a057d0d5ff' was properly closed.
[0m09:59:25.570970 [debug] [MainThread]: Connection 'test.growth.source_unique_staging_transactions_transaction_id.05e23fc0d1' was properly closed.
[0m09:59:25.570970 [debug] [MainThread]: Connection 'model.growth.stg_users' was properly closed.
[0m09:59:25.573640 [info ] [MainThread]: 
[0m09:59:25.574634 [info ] [MainThread]: Finished running 7 table models, 29 data tests, 10 view models in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m09:59:25.582631 [debug] [MainThread]: Command end result
[0m09:59:25.644735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\Documents\GrowthMetrics\target\manifest.json
[0m09:59:25.647737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\Documents\GrowthMetrics\target\semantic_manifest.json
[0m09:59:25.656738 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\Documents\GrowthMetrics\target\run_results.json
[0m09:59:25.656738 [info ] [MainThread]: 
[0m09:59:25.656738 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m09:59:25.656738 [info ] [MainThread]: 
[0m09:59:25.656738 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_referrals_referred_user_id (models\staging\schema.yml)[0m
[0m09:59:25.656738 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:59:25.656738 [info ] [MainThread]: 
[0m09:59:25.666929 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_ce21451ab51663af294524ce4a7e56fa.sql
[0m09:59:25.667928 [info ] [MainThread]: 
[0m09:59:25.669964 [error] [MainThread]: [31mFailure in test dbt_utils_source_unique_combination_of_columns_staging_market_date__token (models\staging\schema.yml)[0m
[0m09:59:25.672014 [error] [MainThread]:   Got 156 results, configured to fail if != 0
[0m09:59:25.677017 [info ] [MainThread]: 
[0m09:59:25.678016 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\dbt_utils_source_unique_combin_3a255a5db84d348db66273d767faeca9.sql
[0m09:59:25.679017 [info ] [MainThread]: 
[0m09:59:25.680015 [error] [MainThread]: [31mFailure in test source_not_null_staging_market_price (models\staging\schema.yml)[0m
[0m09:59:25.681015 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m09:59:25.682026 [info ] [MainThread]: 
[0m09:59:25.683222 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_market_price.sql
[0m09:59:25.684225 [info ] [MainThread]: 
[0m09:59:25.685224 [error] [MainThread]: [31mFailure in test source_not_null_staging_referrals_referrer_user_id (models\staging\schema.yml)[0m
[0m09:59:25.686224 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m09:59:25.687224 [info ] [MainThread]: 
[0m09:59:25.691255 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_referrals_referrer_user_id.sql
[0m09:59:25.693403 [info ] [MainThread]: 
[0m09:59:25.695405 [error] [MainThread]: [31mFailure in test source_not_null_staging_transactions_amount (models\staging\schema.yml)[0m
[0m09:59:25.695405 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:59:25.695405 [info ] [MainThread]: 
[0m09:59:25.695405 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_not_null_staging_transactions_amount.sql
[0m09:59:25.699109 [info ] [MainThread]: 
[0m09:59:25.701107 [error] [MainThread]: [31mFailure in test source_positive_value_staging_market_price (models\staging\schema.yml)[0m
[0m09:59:25.702108 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m09:59:25.702108 [info ] [MainThread]: 
[0m09:59:25.703107 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_market_price.sql
[0m09:59:25.704813 [info ] [MainThread]: 
[0m09:59:25.708900 [error] [MainThread]: [31mFailure in test source_positive_value_staging_transactions_amount (models\staging\schema.yml)[0m
[0m09:59:25.711888 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m09:59:25.712883 [info ] [MainThread]: 
[0m09:59:25.713883 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_positive_value_staging_transactions_amount.sql
[0m09:59:25.714882 [info ] [MainThread]: 
[0m09:59:25.715882 [error] [MainThread]: [31mFailure in test source_unique_staging_transactions_transaction_id (models\staging\schema.yml)[0m
[0m09:59:25.716884 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m09:59:25.717888 [info ] [MainThread]: 
[0m09:59:25.719936 [info ] [MainThread]:   compiled code at target\compiled\growth\models\staging\schema.yml\source_unique_staging_transactions_transaction_id.sql
[0m09:59:25.720935 [info ] [MainThread]: 
[0m09:59:25.721934 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=8 SKIP=15 TOTAL=46
[0m09:59:25.728551 [debug] [MainThread]: Command `dbt build` failed at 09:59:25.727553 after 4.81 seconds
[0m09:59:25.728551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812CA1D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812CCCA080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812F8E5720>]}
[0m09:59:25.729548 [debug] [MainThread]: Flushing usage events
[0m09:59:26.751562 [debug] [MainThread]: An error was encountered while trying to flush usage events
